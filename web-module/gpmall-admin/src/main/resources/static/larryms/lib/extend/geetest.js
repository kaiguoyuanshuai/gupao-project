(function(t,n){"use strict";if(window.layui&&layui.define){layui.define(function(e){e("geetest",n(t))})}else if(typeof module==="object"&&typeof module.exports==="object"){module.exports=t.document?n(t,true):function(e){if(!e.document){throw new Error("Geetest requires a window with a document")}return n(e)}}else{n(t)}})(typeof window!=="undefined"?window:this,function(f,e){"use strict";if(typeof f==="undefined"){throw new Error("Geetest requires browser environment")}if(!f.larrymsExtend){return false}var o=f.document;var t=f.Math;var i=o.getElementsByTagName("head")[0];function r(e){this._obj=e}r.prototype={_each:function(e){var t=this._obj;for(var n in t){if(t.hasOwnProperty(n)){e(n,t[n])}}return this}};function n(e){var n=this;new r(e)._each(function(e,t){n[e]=t})}n.prototype={api_server:"api.geetest.com",protocol:"http://",type_path:"/gettype.php",fallback_config:{slide:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"slide",slide:"/static/js/geetest.0.0.0.js"},fullpage:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"fullpage",fullpage:"/static/js/fullpage.0.0.0.js"}},_get_fallback_config:function(){var e=this;if(c(e.type)){return e.fallback_config[e.type]}else if(e.new_captcha){return e.fallback_config.fullpage}else{return e.fallback_config.slide}},_extend:function(e){var n=this;new r(e)._each(function(e,t){n[e]=t})}};var a=function(e){return typeof e==="number"};var c=function(e){return typeof e==="string"};var u=function(e){return typeof e==="boolean"};var s=function(e){return typeof e==="object"&&e!==null};var l=function(e){return typeof e==="function"};var p={};var d={};var v=function(){return parseInt(t.random()*1e4)+(new Date).valueOf()};var g=function(e,t){var n=o.createElement("script");n.charset="UTF-8";n.async=true;n.onerror=function(){t(true)};var r=false;n.onload=n.onreadystatechange=function(){if(!r&&(!n.readyState||"loaded"===n.readyState||"complete"===n.readyState)){r=true;setTimeout(function(){t(false)},0)}};n.src=e;i.appendChild(n)};var h=function(e){return e.replace(/^https?:\/\/|\/$/g,"")};var _=function(e){e=e.replace(/\/+/g,"/");if(e.indexOf("/")!==0){e="/"+e}return e};var y=function(e){if(!e){return""}var n="?";new r(e)._each(function(e,t){if(c(t)||a(t)||u(t)){n=n+encodeURIComponent(e)+"="+encodeURIComponent(t)+"&"}});if(n==="?"){n=""}return n.replace(/&$/,"")};var w=function(e,t,n,r){t=h(t);var o=_(n)+y(r);if(t){o=e+t+o}return o};var m=function(n,r,o,i,a){var f=function(t){var e=w(n,r[t],o,i);g(e,function(e){if(e){if(t>=r.length-1){a(true)}else{f(t+1)}}else{a(false)}})};f(0)};var b=function(e,t,n,r){if(s(n.getLib)){n._extend(n.getLib);r(n);return}if(n.offline){r(n._get_fallback_config());return}var o="geetest_"+v();f[o]=function(e){if(e.status==="success"){r(e.data)}else if(!e.status){r(e)}else{r(n._get_fallback_config())}f[o]=undefined;try{delete f[o]}catch(e){}};m(n.protocol,e,t,{gt:n.gt,callback:o},function(e){if(e){r(n._get_fallback_config())}})};var k=function(e,t){var n={networkError:"网络错误"};if(typeof t.onError==="function"){t.onError(n[e])}else{throw new Error(n[e])}};var E=function(){return!!f.Geetest};if(E()){d.slide="loaded"}var j=function(e,r){var a=new n(e);if(e.https){a.protocol="https://"}else if(!e.protocol){a.protocol=f.location.protocol+"//"}b([a.api_server||a.apiserver],a.type_path,a,function(e){var i=e.type;var t=function(){a._extend(e);r(new f.Geetest(a))};p[i]=p[i]||[];var n=d[i]||"init";if(n==="init"){d[i]="loading";p[i].push(t);m(a.protocol,e.static_servers||e.domains,e[i]||e.path,null,function(e){if(e){d[i]="fail";k("networkError",a)}else{d[i]="loaded";var t=p[i];for(var n=0,r=t.length;n<r;n=n+1){var o=t[n];if(l(o)){o()}}p[i]=[]}})}else if(n==="loaded"){t()}else if(n==="fail"){k("networkError",a)}else if(n==="loading"){p[i].push(t)}})};f.initGeetest=j;return j});