var wordImage={};var g=baidu.g,flashObj,flashContainer;wordImage.init=function(e,t){showLocalPath("localPath");createFlashUploader(e,t);addUploadListener();addOkListener()};function hideFlash(){flashObj=null;flashContainer.innerHTML=""}function addOkListener(){dialog.onok=function(){if(!imageUrls.length)return;var e=editor.getOpt("imageUrlPrefix"),t=domUtils.getElementsByTagName(editor.document,"img");editor.fireEvent("saveScene");for(var a=0,n;n=t[a++];){var r=n.getAttribute("word_img");if(!r)continue;for(var i=0,o;o=imageUrls[i++];){if(r.indexOf(o.original.replace(" ",""))!=-1){n.src=e+o.url;n.setAttribute("_src",e+o.url);n.setAttribute("title",o.title);domUtils.removeAttributes(n,["word_img","style","width","height"]);editor.fireEvent("selectionchange");break}}}editor.fireEvent("saveScene");hideFlash()};dialog.oncancel=function(){hideFlash()}}function addUploadListener(){g("upload").onclick=function(){flashObj.upload();this.style.display="none"}}function showLocalPath(e){var t=editor.selection.getRange().getClosedNode();var a=editor.execCommand("wordimage");if(a.length==1||t&&t.tagName=="IMG"){g(e).value=a[0];return}var n=a[0];var r=n.lastIndexOf("/")||0,i=n.lastIndexOf("\\")||0,o=r>i?"/":"\\";n=n.substring(0,n.lastIndexOf(o)+1);g(e).value=n}function createFlashUploader(e,t){var a=utils.extend({},lang.flashI18n);for(var n in a){if(!(n in{lang:1,uploadingTF:1,imageTF:1,textEncoding:1})&&a[n]){a[n]=encodeURIComponent(editor.options.langPath+editor.options.lang+"/images/"+a[n])}}e=utils.extend(e,a,false);var r={createOptions:{id:"flash",url:e.flashUrl,width:e.width,height:e.height,errorMessage:lang.flashError,wmode:browser.safari?"transparent":"window",ver:"10.0.0",vars:e,container:e.container}};r=extendProperty(t,r);flashObj=new baidu.flash.imageUploader(r);flashContainer=$G(e.container)}function extendProperty(e,t){for(var a in e){if(!t[a]){t[a]=e[a]}}return t}function getPasteData(e){baidu.g("msg").innerHTML=lang.copySuccess+"</br>";setTimeout(function(){baidu.g("msg").innerHTML=""},5e3);return baidu.g(e).value}function createCopyButton(e,t){baidu.swf.create({id:"copyFlash",url:"fClipboard_ueditor.swf",width:"58",height:"25",errorMessage:"",bgColor:"#CBCBCB",wmode:"transparent",ver:"10.0.0",vars:{tid:t}},e);var a=baidu.swf.getMovie("copyFlash");var n=setInterval(function(){if(a&&a.flashInit){clearInterval(n);a.setHandCursor(true);a.setContentFuncName("getPasteData")}},500)}createCopyButton("clipboard","localPath");