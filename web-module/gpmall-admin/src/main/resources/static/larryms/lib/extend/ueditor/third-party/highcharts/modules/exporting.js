(function(m){var t=m.Chart,f=m.addEvent,o=m.removeEvent,b=m.createElement,s=m.discardElement,v=m.css,g=m.merge,w=m.each,S=m.extend,k=Math.max,l=document,a=window,e=m.isTouchDevice,n=m.Renderer.prototype.symbols,i=m.getOptions(),x;S(i.lang,{printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"});i.navigation={menuStyle:{border:"1px solid #A0A0A0",background:"#FFFFFF",padding:"5px 0"},menuItemStyle:{padding:"0 10px",background:"none",color:"#303030",fontSize:e?"14px":"11px"},menuItemHoverStyle:{background:"#4572A5",color:"#FFFFFF"},buttonOptions:{symbolFill:"#E0E0E0",symbolSize:14,symbolStroke:"#666",symbolStrokeWidth:3,symbolX:12.5,symbolY:10.5,align:"right",buttonSpacing:3,height:22,theme:{fill:"white",stroke:"none"},verticalAlign:"top",width:24}};i.exporting={type:"image/png",url:"http://export.highcharts.com/",buttons:{contextButton:{menuClassName:"highcharts-contextmenu",symbol:"menu",_titleKey:"contextButtonTitle",menuItems:[{textKey:"printChart",onclick:function(){this.print()}},{separator:!0},{textKey:"downloadPNG",onclick:function(){this.exportChart()}},{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}]}}};m.post=function(t,e){var n,o;o=b("form",{method:"post",action:t,enctype:"multipart/form-data"},{display:"none"},l.body);for(n in e)b("input",{type:"hidden",name:n,value:e[n]},null,o);o.submit();s(o)};S(t.prototype,{getSVG:function(t){var e=this,a,n,o,i,r=g(e.options,t);if(!l.createElementNS)l.createElementNS=function(t,e){return l.createElement(e)};t=b("div",null,{position:"absolute",top:"-9999em",width:e.chartWidth+"px",height:e.chartHeight+"px"},l.body);n=e.renderTo.style.width;i=e.renderTo.style.height;n=r.exporting.sourceWidth||r.chart.width||/px$/.test(n)&&parseInt(n,10)||600;i=r.exporting.sourceHeight||r.chart.height||/px$/.test(i)&&parseInt(i,10)||400;S(r.chart,{animation:!1,renderTo:t,forExport:!0,width:n,height:i});r.exporting.enabled=!1;r.series=[];w(e.series,function(t){o=g(t.options,{animation:!1,showCheckbox:!1,visible:t.visible});o.isInternal||r.series.push(o)});a=new m.Chart(r,e.callback);w(["xAxis","yAxis"],function(r){w(e[r],function(t,e){var n=a[r][e],o=t.getExtremes(),i=o.userMin,o=o.userMax;n&&(i!==void 0||o!==void 0)&&n.setExtremes(i,o,!0,!1)})});n=a.container.innerHTML;r=null;a.destroy();s(t);n=n.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/&nbsp;/g," ").replace(/&shy;/g,"­").replace(/<IMG /g,"<image ").replace(/height=([^" ]+)/g,'height="$1"').replace(/width=([^" ]+)/g,'width="$1"').replace(/hc-svg-href="([^"]+)">/g,'xlink:href="$1"/>').replace(/id=([^" >]+)/g,'id="$1"').replace(/class=([^" >]+)/g,'class="$1"').replace(/ transform /g," ").replace(/:(path|rect)/g,"$1").replace(/style="([^"]+)"/g,function(t){return t.toLowerCase()});return n=n.replace(/(url\(#highcharts-[0-9]+)&quot;/g,"$1").replace(/&quot;/g,"'")},exportChart:function(t,e){var t=t||{},n=this.options.exporting,n=this.getSVG(g({chart:{borderRadius:0}},n.chartOptions,e,{exporting:{sourceWidth:t.sourceWidth||n.sourceWidth,sourceHeight:t.sourceHeight||n.sourceHeight}})),t=g(this.options.exporting,t);m.post(t.url,{filename:t.filename||"chart",type:t.type,width:t.width||0,scale:t.scale||2,svg:n})},print:function(){var t=this,e=t.container,n=[],o=e.parentNode,i=l.body,r=i.childNodes;if(!t.isPrinting)t.isPrinting=!0,w(r,function(t,e){if(t.nodeType===1)n[e]=t.style.display,t.style.display="none"}),i.appendChild(e),a.focus(),a.print(),setTimeout(function(){o.appendChild(e);w(r,function(t,e){if(t.nodeType===1)t.style.display=n[e]});t.isPrinting=!1},1e3)},contextMenu:function(e,t,n,o,i,r,a){var s=this,l=s.options.navigation,p=l.menuItemStyle,c=s.chartWidth,h=s.chartHeight,u="cache-"+e,d=s[u],m=k(i,r),g,x,y;if(!d)s[u]=d=b("div",{className:e},{position:"absolute",zIndex:1e3,padding:m+"px"},s.container),g=b("div",null,S({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},l.menuStyle),d),x=function(){v(d,{display:"none"});a&&a.setState(0);s.openMenu=!1},f(d,"mouseleave",function(){y=setTimeout(x,500)}),f(d,"mouseenter",function(){clearTimeout(y)}),f(document,"mousedown",function(t){s.pointer.inClass(t.target,e)||x()}),w(t,function(t){if(t){var e=t.separator?b("hr",null,null,g):b("div",{onmouseover:function(){v(this,l.menuItemHoverStyle)},onmouseout:function(){v(this,p)},onclick:function(){x();t.onclick.apply(s,arguments)},innerHTML:t.text||s.options.lang[t.textKey]},S({cursor:"pointer"},p),g);s.exportDivElements.push(e)}}),s.exportDivElements.push(g,d),s.exportMenuWidth=d.offsetWidth,s.exportMenuHeight=d.offsetHeight;t={display:"block"};n+s.exportMenuWidth>c?t.right=c-n-i-m+"px":t.left=n-m+"px";o+r+s.exportMenuHeight>h&&a.alignOptions.verticalAlign!=="top"?t.bottom=h-o-m+"px":t.top=o+r-m+"px";v(d,t);s.openMenu=!0},addButton:function(t){var e=this,n=e.renderer,o=g(e.options.navigation.buttonOptions,t),i=o.onclick,r=o.menuItems,a,s,l={stroke:o.symbolStroke,fill:o.symbolFill},p=o.symbolSize||12;if(!e.btnCount)e.btnCount=0;if(!e.exportDivElements)e.exportDivElements=[],e.exportSVGElements=[];if(o.enabled!==!1){var c=o.theme,h=c.states,u=h&&h.hover,h=h&&h.select,d;delete c.states;i?d=function(){i.apply(e,arguments)}:r&&(d=function(){e.contextMenu(s.menuClassName,r,s.translateX,s.translateY,s.width,s.height,s);s.setState(2)});o.text&&o.symbol?c.paddingLeft=m.pick(c.paddingLeft,25):o.text||S(c,{width:o.width,height:o.height,padding:0});s=n.button(o.text,0,0,d,c,u,h).attr({title:e.options.lang[o._titleKey],"stroke-linecap":"round"});s.menuClassName=t.menuClassName||"highcharts-menu-"+e.btnCount++;o.symbol&&(a=n.symbol(o.symbol,o.symbolX-p/2,o.symbolY-p/2,p,p).attr(S(l,{"stroke-width":o.symbolStrokeWidth||1,zIndex:1})).add(s));s.add().align(S(o,{width:s.width,x:m.pick(o.x,x)}),!0,"spacingBox");x+=(s.width+o.buttonSpacing)*(o.align==="right"?-1:1);e.exportSVGElements.push(s,a)}},destroyExport:function(t){var t=t.target,e,n;for(e=0;e<t.exportSVGElements.length;e++)if(n=t.exportSVGElements[e])n.onclick=n.ontouchstart=null,t.exportSVGElements[e]=n.destroy();for(e=0;e<t.exportDivElements.length;e++)n=t.exportDivElements[e],o(n,"mouseleave"),t.exportDivElements[e]=n.onmouseout=n.onmouseover=n.ontouchstart=n.onclick=null,s(n)}});n.menu=function(t,e,n,o){return["M",t,e+2.5,"L",t+n,e+2.5,"M",t,e+o/2+.5,"L",t+n,e+o/2+.5,"M",t,e+o-1.5,"L",t+n,e+o-1.5]};t.prototype.callbacks.push(function(t){var e,n=t.options.exporting,o=n.buttons;x=0;if(n.enabled!==!1){for(e in o)t.addButton(o[e]);f(t,"destroy",t.destroyExport)}})})(Highcharts);