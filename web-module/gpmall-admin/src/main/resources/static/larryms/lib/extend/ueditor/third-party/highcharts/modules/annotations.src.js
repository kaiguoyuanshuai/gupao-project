(function(v,t){var i,w,p,e=v.Chart,k=v.extend,a=v.each;p=["path","rect","circle"];w={top:0,left:0,center:.5,middle:.5,bottom:1,right:1};var P=t.inArray,n=v.merge;function s(t){var i,e;e={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}};i={circle:{params:{x:0,y:0}}};if(i[t]){e.shape=n(e.shape,i[t])}return e}function r(t){return Object.prototype.toString.call(t)==="[object Array]"}function O(t){return typeof t==="number"}function j(t){return t!==i&&t!==null}function A(t,i,e,n,a){var s=t.length,r=0;while(r<s){if(typeof t[r]==="number"&&typeof t[r+1]==="number"){t[r]=i.toPixels(t[r])-n;t[r+1]=e.toPixels(t[r+1])-a;r+=2}else{r+=1}}return t}var o=function(){this.init.apply(this,arguments)};o.prototype={init:function(t,i){var e=i.shape&&i.shape.type;this.chart=t;this.options=n({},s(e),i)},render:function(t){var i=this,e=this.chart,n=i.chart.renderer,a=i.group,s=i.title,r=i.shape,o=i.options,l=o.title,h=o.shape;if(!a){a=i.group=n.g()}if(!r&&h&&P(h.type,p)!==-1){r=i.shape=n[o.shape.type](h.params);r.add(a)}if(!s&&l){s=i.title=n.label(l);s.add(a)}a.add(e.annotations.group);i.linkObjects();if(t!==false){i.redraw()}},redraw:function(){var t=this.options,i=this.chart,e=this.group,n=this.title,a=this.shape,s=this.linkedObject,r=i.xAxis[t.xAxis],o=i.yAxis[t.yAxis],l=t.width,h=t.height,p=w[t.anchorY],f=w[t.anchorX],c=false,u,d,y,x,g,b,m;if(s){d=s instanceof v.Point?"point":s instanceof v.Series?"series":null;if(d==="point"){t.xValue=s.x;t.yValue=s.y;y=s.series}else if(d==="series"){y=s}if(e.visibility!==y.group.visibility){e.attr({visibility:y.group.visibility})}}b=j(t.xValue)?r.toPixels(t.xValue+r.minPointOffset)-r.minPixelPadding:t.x;m=j(t.yValue)?o.toPixels(t.yValue):t.y;if(isNaN(b)||isNaN(m)||!O(b)||!O(m)){return}if(n){n.attr(t.title);n.css(t.title.style);c=true}if(a){u=k({},t.shape.params);if(t.units==="values"){for(x in u){if(P(x,["width","x"])>-1){u[x]=r.translate(u[x])}else if(P(x,["height","y"])>-1){u[x]=o.translate(u[x])}}if(u.width){u.width-=r.toPixels(0)-r.left}if(u.x){u.x+=r.minPixelPadding}if(t.shape.type==="path"){A(u.d,r,o,b,m)}}if(t.shape.type==="circle"){u.x+=u.r;u.y+=u.r}c=true;a.attr(u)}e.bBox=null;if(!O(l)){g=e.getBBox();l=g.width}if(!O(h)){if(!g){g=e.getBBox()}h=g.height}if(!O(f)){f=w.center}if(!O(p)){p=w.center}b=b-l*f;m=m-h*p;if(i.animation&&j(e.translateX)&&j(e.translateY)){e.animate({translateX:b,translateY:m})}else{e.translate(b,m)}},destroy:function(){var i=this,t=this.chart,e=t.annotations.allItems,n=e.indexOf(i);if(n>-1){e.splice(n,1)}a(["title","shape","group"],function(t){if(i[t]){i[t].destroy();i[t]=null}});i.group=i.title=i.shape=i.chart=i.options=null},update:function(t,i){k(this.options,t);this.linkObjects();this.render(i)},linkObjects:function(){var t=this,i=t.chart,e=t.linkedObject,n=e&&(e.id||e.options.id),a=t.options,s=a.linkedTo;if(!j(s)){t.linkedObject=null}else if(!j(e)||s!==n){t.linkedObject=i.get(s)}}};k(e.prototype,{annotations:{add:function(t,i){var e=this.allItems,n=this.chart,a,s;if(!r(t)){t=[t]}s=t.length;while(s--){a=new o(n,t[s]);e.push(a);a.render(i)}},redraw:function(){a(this.allItems,function(t){t.redraw()})}}});e.prototype.callbacks.push(function(t){var i=t.options.annotations,e;e=t.renderer.g("annotations");e.attr({zIndex:7});e.add();t.annotations.allItems=[];t.annotations.chart=t;t.annotations.group=e;if(r(i)&&i.length>0){t.annotations.add(t.options.annotations)}v.addEvent(t,"redraw",function(){t.annotations.redraw()})})})(Highcharts,HighchartsAdapter);