(function(h){var c=h.each,i=function(t,e){this.init(t,e)};h.extend(i.prototype,{init:function(t,e){this.options=t;this.chartOptions=e;this.columns=t.columns||this.rowsToColumns(t.rows)||[];this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var t=this.chartOptions,e=t&&t.chart&&t.chart.type,i=[];c(t&&t.series||[],function(t){i.push((h.seriesTypes[t.type||e||"line"].prototype.pointArrayMap||[0]).length)});this.valueCount={global:(h.seriesTypes[e||"line"].prototype.pointArrayMap||[0]).length,individual:i}},dataFound:function(){this.parseTypes();this.findHeaderRow();this.parsed();this.complete()},parseCSV:function(){var n=this,o=this.options,t=o.csv,r=this.columns,a=o.startRow||0,l=o.endRow||Number.MAX_VALUE,u=o.startColumn||0,h=o.endColumn||Number.MAX_VALUE,p=0;t&&(t=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(o.lineDelimiter||"\n"),c(t,function(t,e){var i=n.trim(t),s=i.indexOf("#")===0;e>=a&&e<=l&&!s&&i!==""&&(i=t.split(o.itemDelimiter||","),c(i,function(t,e){e>=u&&e<=h&&(r[e-u]||(r[e-u]=[]),r[e-u][p]=t)}),p+=1)}),this.dataFound())},parseTable:function(){var t=this.options,e=t.table,i=this.columns,s=t.startRow||0,n=t.endRow||Number.MAX_VALUE,o=t.startColumn||0,r=t.endColumn||Number.MAX_VALUE,a;e&&(typeof e==="string"&&(e=document.getElementById(e)),c(e.getElementsByTagName("tr"),function(t,e){a=0;e>=s&&e<=n&&c(t.childNodes,function(t){if((t.tagName==="TD"||t.tagName==="TH")&&a>=o&&a<=r)i[a]||(i[a]=[]),i[a][e-s]=t.innerHTML,a+=1})}),this.dataFound())},parseGoogleSpreadsheet:function(){var r=this,t=this.options,e=t.googleSpreadsheetKey,a=this.columns,l=t.startRow||0,u=t.endRow||Number.MAX_VALUE,h=t.startColumn||0,p=t.endColumn||Number.MAX_VALUE,c,m;e&&jQuery.getJSON("https://spreadsheets.google.com/feeds/cells/"+e+"/"+(t.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",function(t){var t=t.feed.entry,e,i=t.length,s=0,n=0,o;for(o=0;o<i;o++)e=t[o],s=Math.max(s,e.gs$cell.col),n=Math.max(n,e.gs$cell.row);for(o=0;o<s;o++)if(o>=h&&o<=p)a[o-h]=[],a[o-h].length=Math.min(n,u-l);for(o=0;o<i;o++)if(e=t[o],c=e.gs$cell.row-1,m=e.gs$cell.col-1,m>=h&&m<=p&&c>=l&&c<=u)a[m-h][c-l]=e.content.$t;r.dataFound()})},findHeaderRow:function(){c(this.columns,function(){});this.headerRow=0},trim:function(t){return typeof t==="string"?t.replace(/^\s+|\s+$/g,""):t},parseTypes:function(){for(var t=this.columns,e=t.length,i,s,n,o;e--;)for(i=t[e].length;i--;)s=t[e][i],n=parseFloat(s),o=this.trim(s),o==n?(t[e][i]=n,n>31536e6?t[e].isDatetime=!0:t[e].isNumeric=!0):(s=this.parseDate(s),e===0&&typeof s==="number"&&!isNaN(s)?(t[e][i]=s,t[e].isDatetime=!0):t[e][i]=o===""?null:o)},dateFormats:{"YYYY-mm-dd":{regex:"^([0-9]{4})-([0-9]{2})-([0-9]{2})$",parser:function(t){return Date.UTC(+t[1],t[2]-1,+t[3])}}},parseDate:function(t){var e=this.options.parseDate,i,s,n;e&&(i=e(t));if(typeof t==="string")for(s in this.dateFormats)e=this.dateFormats[s],(n=t.match(e.regex))&&(i=e.parser(n));return i},rowsToColumns:function(t){var e,i,s,n,o;if(t){o=[];i=t.length;for(e=0;e<i;e++){n=t[e].length;for(s=0;s<n;s++)o[s]||(o[s]=[]),o[s][e]=t[e][s]}}return o},parsed:function(){this.options.parsed&&this.options.parsed.call(this,this.columns)},complete:function(){var t=this.columns,e,i,s=this.options,n,o,r,a,l,u;if(s.complete){this.getColumnDistribution();t.length>1&&(e=t.shift(),this.headerRow===0&&e.shift(),e.isDatetime?i="datetime":e.isNumeric||(i="category"));for(a=0;a<t.length;a++)if(this.headerRow===0)t[a].name=t[a].shift();o=[];for(a=0,u=0;a<t.length;u++){n=h.pick(this.valueCount.individual[u],this.valueCount.global);r=[];for(l=0;l<t[a].length;l++)r[l]=[e[l],t[a][l]!==void 0?t[a][l]:null],n>1&&r[l].push(t[a+1][l]!==void 0?t[a+1][l]:null),n>2&&r[l].push(t[a+2][l]!==void 0?t[a+2][l]:null),n>3&&r[l].push(t[a+3][l]!==void 0?t[a+3][l]:null),n>4&&r[l].push(t[a+4][l]!==void 0?t[a+4][l]:null);o[u]={name:t[a].name,data:r};a+=n}s.complete({xAxis:{type:i},series:o})}}});h.Data=i;h.data=function(t,e){return new i(t,e)};h.wrap(h.Chart.prototype,"init",function(t,s,e){var n=this;s&&s.data?h.data(h.extend(s.data,{complete:function(i){s.series&&c(s.series,function(t,e){s.series[e]=h.merge(t,i.series[e])});s=h.merge(i,s);t.call(n,s,e)}}),s):t.call(n,s,e)})})(Highcharts);