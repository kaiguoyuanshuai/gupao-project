(function(t){var e=t.getOptions().plotOptions,h=t.seriesTypes,i=t.merge,P=function(){},X=t.each;e.funnel=i(e.pie,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:!0,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}}});h.funnel=t.extendClass(h.pie,{type:"funnel",animate:P,translate:function(){var t=function(t,e){return/%$/.test(t)?e*parseInt(t,10)/100:parseInt(t,10)},e=0,i=this.chart,n=i.plotWidth,i=i.plotHeight,a=0,o=this.options,s=o.center,r=t(s[0],n),h=t(s[0],i),l=t(o.width,n),c,p,d=t(o.height,i),u=t(o.neckWidth,n),f=t(o.neckHeight,i),g=d-f,t=this.data,b,w,y=o.dataLabels.position==="left"?1:0,C,L,k,W,v,A,H;this.getWidthAt=p=function(t){return t>d-f||d===f?u:u+(l-u)*((d-f-t)/(d-f))};this.getX=function(t,e){return r+(e?-1:1)*(p(t)/2+o.dataLabels.distance)};this.center=[r,h,d];this.centerX=r;X(t,function(t){e+=t.y});X(t,function(t){H=null;w=e?t.y/e:0;L=h-d/2+a*d;v=L+w*d;c=p(L);C=r-c/2;k=C+c;c=p(v);W=r-c/2;A=W+c;L>g?(C=W=r-u/2,k=A=r+u/2):v>g&&(H=v,c=p(g),W=r-c/2,A=W+c,v=g);b=["M",C,L,"L",k,L,A,v];H&&b.push(A,H,W,H);b.push(W,v,"Z");t.shapeType="path";t.shapeArgs={d:b};t.percentage=w*100;t.plotX=r;t.plotY=(L+(H||v))/2;t.tooltipPos=[r,t.plotY];t.slice=P;t.half=y;a+=w});this.setTooltipPoints()},drawPoints:function(){var n=this,a=n.options,o=n.chart.renderer;X(n.data,function(t){var e=t.graphic,i=t.shapeArgs;e?e.animate(i):t.graphic=o.path(i).attr({fill:t.color,stroke:a.borderColor,"stroke-width":a.borderWidth}).add(n.group)})},sortByAngle:P,drawDataLabels:function(){var t=this.data,e=this.options.dataLabels.distance,i,n,a,o=t.length,s,r;for(this.center[2]-=2*e;o--;)a=t[o],n=(i=a.half)?1:-1,r=a.plotY,s=this.getX(r,i),a.labelPos=[0,r,s+(e-5)*n,r,s+e*n,r,i?"right":"left",0];h.pie.prototype.drawDataLabels.call(this)}})})(Highcharts);