(function(e,i){if(window.layui&&layui.define){layui.define("neconfig",function(e){var t=layui.neconfig;e("neditor",i())})}else{e.neditor=i()}})(window,function(){UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu;window.UE=baidu.editor={plugins:{},commands:{},instants:{},I18N:{},_customizeUI:{},version:"1.5.0"};var dom=UE.dom={};var browser=UE.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,i={ie:/(msie\s|trident.*rv:)([\w.]+)/i.test(e),opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"};i.gecko=navigator.product=="Gecko"&&!i.webkit&&!i.opera&&!i.ie;var n=0;if(i.ie){var o=e.match(/(?:msie\s([\w.]+))/);var r=e.match(/(?:trident.*rv:([\w.]+))/);if(o&&r&&o[1]&&r[1]){n=Math.max(o[1]*1,r[1]*1)}else if(o&&o[1]){n=o[1]*1}else if(r&&r[1]){n=r[1]*1}else{n=0}i.ie11Compat=document.documentMode==11;i.ie9Compat=document.documentMode==9;i.ie8=!!document.documentMode;i.ie8Compat=document.documentMode==8;i.ie7Compat=n==7&&!document.documentMode||document.documentMode==7;i.ie6Compat=n<7||i.quirks;i.ie9above=n>8;i.ie9below=n<9;i.ie11above=n>10;i.ie11below=n<11}if(i.gecko){var a=e.match(/rv:([\d\.]+)/);if(a){a=a[1].split(".");n=a[0]*1e4+(a[1]||0)*100+(a[2]||0)*1}}if(/chrome\/(\d+\.\d)/i.test(e)){i.chrome=+RegExp["$1"]}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)){i.safari=+(RegExp["$1"]||RegExp["$2"])}if(i.opera)n=parseFloat(t.version());if(i.webkit)n=parseFloat(e.match(/ applewebkit\/(\d+)/)[1]);i.version=n;i.isCompatible=!i.mobile&&(i.ie&&n>=6||i.gecko&&n>=10801||i.opera&&n>=9.5||i.air&&n>=1||i.webkit&&n>=522||false);return i}();var ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera;var utils=UE.utils={each:function(e,t,i){if(e==null)return;if(e.length===+e.length){for(var n=0,o=e.length;n<o;n++){if(t.call(i,e[n],n,e)===false)return false}}else{for(var r in e){if(e.hasOwnProperty(r)){if(t.call(i,e[r],r,e)===false)return false}}}},makeInstance:function(e){var t=new Function;t.prototype=e;e=new t;t.prototype=null;return e},extend:function(e,t,i){if(t){for(var n in t){if(!i||!e.hasOwnProperty(n)){e[n]=t[n]}}}return e},extend2:function(e){var t=arguments;for(var i=1;i<t.length;i++){var n=t[i];for(var o in n){if(!e.hasOwnProperty(o)){e[o]=n[o]}}}return e},inherits:function(e,t){var i=e.prototype,n=utils.makeInstance(t.prototype);utils.extend(n,i,true);e.prototype=n;return n.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,i){var n;return function(){if(i){clearTimeout(n)}n=setTimeout(e,t)}},indexOf:function(e,i,n){var o=-1;n=this.isNumber(n)?n:0;this.each(e,function(e,t){if(t>=n&&e===i){o=t;return false}});return o},removeItem:function(e,t){for(var i=0,n=e.length;i<n;i++){if(e[i]===t){e.splice(i,1);i--}}},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=utils.isArray(e)?e:e.split(",");for(var t=0,i,n={};i=e[t++];){n[i.toUpperCase()]=n[i]=1}return n},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|ldquo|rdquo|quot|gt|#39|nbsp|#\d+);)?/g,function(e,t){if(t){return e}else{return{"<":"&lt;","&":"&amp;",'"':"&quot;","“":"&ldquo;","”":"&rdquo;",">":"&gt;","'":"&#39;"}[e]}}):""},html:function(e){return e?e.replace(/&((g|l|quo|ldquo|rdquo)t|amp|#39|nbsp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&ldquo;":"“","&rdquo;":"”","&gt;":">","&#39;":"'","&nbsp;":" "}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={float:e.cssFloat!=undefined?"cssFloat":e.styleFloat!=undefined?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){var s=[];function l(e,t){try{for(var i=0,n;n=s[i++];){if(n.doc===e&&n.url==(t.src||t.href)){return n}}}catch(e){return null}}return function(t,i,e){var n=l(t,i);if(n){if(n.ready){e&&e()}else{n.funs.push(e)}return}s.push({doc:t,url:i.src||i.href,funs:[e]});if(!t.body){var o=[];for(var r in i){if(r=="tag")continue;o.push(r+'="'+i[r]+'"')}t.write("<"+i.tag+" "+o.join(" ")+" ></"+i.tag+">");return}if(i.id&&t.getElementById(i.id)){return}var a=t.createElement(i.tag);delete i.tag;for(var r in i){a.setAttribute(r,i[r])}a.onload=a.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){n=l(t,i);if(n.funs.length>0){n.ready=1;for(var e;e=n.funs.pop();){e()}}a.onload=a.onreadystatechange=null}};a.onerror=function(){throw Error("The load "+(i.href||i.src)+" fails,check the url settings of file neditor.config.js ")};t.getElementsByTagName("head")[0].appendChild(a)}}(),isEmptyObject:function(e){if(e==null)return true;if(this.isArray(e)||this.isString(e))return e.length===0;for(var t in e)if(e.hasOwnProperty(t))return false;return true},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var i=t.split(",");if(i.length>3)return"";t="#";for(var n=0,o;o=i[n++];){o=parseInt(o.replace(/[^\d]/gi,""),10).toString(16);t+=o.length==1?"0"+o:o}t=t.toUpperCase()}return t},optCss:function(e){var o,r,t;e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,t,i,n){if(n.split(" ").length==1){switch(t){case"padding":!o&&(o={});o[i]=n;return"";case"margin":!r&&(r={});r[i]=n;return"";case"border":return n=="initial"?"":e}}return e});function i(e,t){if(!e){return""}var i=e.top,n=e.bottom,o=e.left,r=e.right,a="";if(!i||!o||!n||!r){for(var s in e){a+=";"+t+"-"+s+":"+e[s]+";"}}else{a+=";"+t+":"+(i==n&&n==o&&o==r?i:i==n&&o==r?i+" "+o:o==r?i+" "+o+" "+n:i+" "+r+" "+n+" "+o)+";"}return a}e+=i(o,"padding")+i(r,"margin");return e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var i;t=t||{};for(var n in e){if(e.hasOwnProperty(n)){i=e[n];if(typeof i=="object"){t[n]=utils.isArray(i)?[]:{};utils.clone(e[n],t[n])}else{t[n]=i}}}return t},transUnitToPx:function(n){if(!/(pt|cm)/.test(n)){return n}var o;n.replace(/([\d.]+)(\w+)/,function(e,t,i){n=t;o=i});switch(o){case"cm":n=parseFloat(n)*25;break;case"pt":n=Math.round(parseFloat(n)*96/72)}return n+(n?"px":"")},domReady:function(){var n=[];function o(e){e.isReady=true;for(var t;t=n.pop();t()){}}return function(e,t){t=t||window;var i=t.document;e&&n.push(e);if(i.readyState==="complete"){o(i)}else{i.isReady&&o(i);if(browser.ie&&browser.version!=11){(function(){if(i.isReady)return;try{i.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}o(i)})();t.attachEvent("onload",function(){o(i)})}else{i.addEventListener("DOMContentLoaded",function(){i.removeEventListener("DOMContentLoaded",arguments.callee,false);o(i)},false);t.addEventListener("load",function(){o(i)},false)}}}}(),cssRule:browser.ie&&browser.version!=11?function(e,t,i){var n,o;if(t===undefined||t&&t.nodeType&&t.nodeType==9){i=t&&t.nodeType&&t.nodeType==9?t:i||document;n=i.indexList||(i.indexList={});o=n[e];if(o!==undefined){return i.styleSheets[o].cssText}return undefined}i=i||document;n=i.indexList||(i.indexList={});o=n[e];if(t===""){if(o!==undefined){i.styleSheets[o].cssText="";delete n[e];return true}return false}if(o!==undefined){sheetStyle=i.styleSheets[o]}else{sheetStyle=i.createStyleSheet("",o=i.styleSheets.length);n[e]=o}sheetStyle.cssText=t}:function(e,t,i){var n,o;if(t===undefined||t&&t.nodeType&&t.nodeType==9){i=t&&t.nodeType&&t.nodeType==9?t:i||document;o=i.getElementById(e);return o?o.innerHTML:undefined}i=i||document;o=i.getElementById(e);if(t===""){if(o){o.parentNode.removeChild(o);return true}return false}if(o){o.innerHTML=t}else{o=i.createElement("style");o.id=e;o.innerHTML=t;i.getElementsByTagName("head")[0].appendChild(o)}},sort:function(e,t){t=t||function(e,t){return e.localeCompare(t)};for(var i=0,n=e.length;i<n;i++){for(var o=i,r=e.length;o<r;o++){if(t(e[i],e[o])>0){var a=e[i];e[i]=e[o];e[o]=a}}}return e},serializeParam:function(e){var t=[];for(var i in e){if(i=="method"||i=="timeout"||i=="async")continue;if(!((typeof e[i]).toLowerCase()=="function"||(typeof e[i]).toLowerCase()=="object")){t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]))}else if(utils.isArray(e[i])){for(var n=0;n<e[i].length;n++){t.push(encodeURIComponent(i)+"[]="+encodeURIComponent(e[i][n]))}}}return t.join("&")},formatUrl:function(e){var t=e.replace(/&&/g,"&");t=t.replace(/\?&/g,"?");t=t.replace(/&$/g,"");t=t.replace(/&#/g,"#");t=t.replace(/&+/g,"&");return t},isCrossDomainUrl:function(e){var t=document.createElement("a");t.href=e;if(browser.ie){t.href=t.href}return!(t.protocol==location.protocol&&t.hostname==location.hostname&&(t.port==location.port||t.port=="80"&&location.port==""||t.port==""&&location.port=="80"))},clearEmptyAttrs:function(e){for(var t in e){if(e[t]===""){delete e[t]}}return e},str2json:function(e){if(!utils.isString(e))return null;if(window.JSON){return JSON.parse(e)}else{return new Function("return "+utils.trim(e||""))()}},json2str:function(){if(window.JSON){return JSON.stringify}else{var i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(e){if(/["\\\x00-\x1f]/.test(e)){e=e.replace(/["\\\x00-\x1f]/g,function(e){var t=i[e];if(t){return t}t=e.charCodeAt();return"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)})}return'"'+e+'"'}function s(e){var t=["["],i=e.length,n,o,r;for(o=0;o<i;o++){r=e[o];switch(typeof r){case"undefined":case"function":case"unknown":break;default:if(n){t.push(",")}t.push(utils.json2str(r));n=1}}t.push("]");return t.join("")}function t(e){return e<10?"0"+e:e}function l(e){return'"'+e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+'"'}return function(e){switch(typeof e){case"undefined":return"undefined";case"number":return isFinite(e)?String(e):"null";case"string":return a(e);case"boolean":return String(e);default:if(e===null){return"null"}else if(utils.isArray(e)){return s(e)}else if(utils.isDate(e)){return l(e)}else{var t=["{"],i=utils.json2str,n,o;for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r)){o=e[r];switch(typeof o){case"undefined":case"unknown":case"function":break;default:if(n){t.push(",")}n=1;t.push(i(r)+":"+i(o))}}}t.push("}");return t.join("")}}}}}()};utils.each(["String","Function","Array","Number","RegExp","Object","Date"],function(t){UE.utils["is"+t]=function(e){return Object.prototype.toString.apply(e)=="[object "+t+"]"}});var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(e,t){e=utils.trim(e).split(/\s+/);for(var i=0,n;n=e[i++];){getListener(this,n,true).push(t)}},on:function(e,t){return this.addListener(e,t)},off:function(e,t){return this.removeListener(e,t)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(e,t){e=utils.trim(e).split(/\s+/);for(var i=0,n;n=e[i++];){utils.removeItem(getListener(this,n)||[],t)}},fireEvent:function(){var e=arguments[0];e=utils.trim(e).split(" ");for(var t=0,i;i=e[t++];){var n=getListener(this,i),o,r,a;if(n){a=n.length;while(a--){if(!n[a])continue;r=n[a].apply(this,arguments);if(r===true){return r}if(r!==undefined){o=r}}}if(r=this["on"+i.toLowerCase()]){o=r.apply(this,arguments)}}return o}};function getListener(e,t,i){var n;t=t.toLowerCase();return(n=e.__allListeners||i&&(e.__allListeners={}))&&(n[t]||i&&(n[t]=[]))}var dtd=dom.dtd=function(){function e(e){for(var t in e){e[t.toUpperCase()]=e[t]}return e}var t=utils.extend2;var i=e({isindex:1,fieldset:1}),n=e({input:1,button:1,select:1,textarea:1,label:1}),o=t(e({a:1}),n),r=t({iframe:1},o),a=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),s=e({ins:1,del:1,script:1,style:1}),l=t(e({mark:1,b:1,acronym:1,bdo:1,var:1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),s),d=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),l),c=t(e({p:1}),d),u=t(e({iframe:1}),d,n),f=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,var:1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),m=t(e({a:0}),u),h=e({tr:1}),p=e({"#":1}),g=t(e({param:1}),f),v=t(e({form:1}),i,r,a,c),b=e({li:1,ol:1,ul:1}),y=e({style:1,script:1}),C=e({base:1,link:1,meta:1,title:1}),w=t(C,y),x=e({head:1,body:1}),N=e({html:1});var U=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),E=e({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return e({$nonBodyContent:t(N,x,C),$block:U,$inline:m,$inlineWithA:t(e({a:1}),m),$body:t(e({script:1,style:1}),U),$cdata:e({script:1,style:1}),$empty:E,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,textarea:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),html:x,head:w,style:p,script:p,body:v,base:{},link:{},meta:{},title:p,col:{},tr:e({td:1,th:1}),img:{},embed:{},colgroup:e({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:v,td:v,br:{},th:v,center:v,kbd:m,button:t(c,a),basefont:{},h5:m,h4:m,samp:m,h6:m,ol:b,h1:m,h3:m,option:p,h2:m,form:t(i,r,a,c),select:e({optgroup:1,option:1}),font:m,ins:m,menu:b,abbr:m,label:m,table:e({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:m,tfoot:h,cite:m,li:v,input:{},iframe:v,strong:m,textarea:p,noframes:v,big:m,small:m,span:e({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:m,dt:m,sub:m,optgroup:e({option:1}),param:{},bdo:m,var:m,div:v,object:g,sup:m,dd:v,strike:m,area:{},dir:b,map:t(e({area:1,form:1,p:1}),i,s,a),applet:g,dl:e({dt:1,dd:1}),del:m,isindex:{},fieldset:t(e({legend:1}),f),thead:h,ul:b,acronym:m,b:m,a:t(e({a:1}),u),blockquote:t(e({td:1,tr:1,tbody:1,li:1}),v),caption:m,i:m,u:m,tbody:h,s:m,address:t(r,c),tt:m,legend:m,q:m,pre:t(l,o),p:t(e({a:1}),m),em:m,dfn:m,mark:m})}();function getDomNode(e,t,i,n,o,r){var a=n&&e[t],s;!a&&(a=e[i]);while(!a&&(s=(s||e).parentNode)){if(s.tagName=="BODY"||r&&!r(s)){return null}a=s[i]}if(a&&o&&!o(a)){return getDomNode(a,t,i,false,o)}return a}var attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]);var domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&browser.version=="6"?"\ufeff":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){if(e===t){return 0}var i,n=[e],o=[t];i=e;while(i=i.parentNode){if(i===t){return 10}n.push(i)}i=t;while(i=i.parentNode){if(i===e){return 20}o.push(i)}n.reverse();o.reverse();if(n[0]!==o[0]){return 1}var r=-1;while(r++,n[r]===o[r]){}e=n[r];t=o[r];while(e=e.nextSibling){if(e===t){return 4}}return 2},getNodeIndex:function(e,t){var i=e,n=0;while(i=i.previousSibling){if(t&&i.nodeType==3){if(i.nodeType!=i.nextSibling.nodeType){n++}continue}n++}return n},inDoc:function(e,t){return domUtils.getPosition(e,t)==10},findParent:function(e,t,i){if(e&&!domUtils.isBody(e)){e=i?e:e.parentNode;while(e){if(!t||t(e)||domUtils.isBody(e)){return t&&!t(e)&&domUtils.isBody(e)?null:e}e=e.parentNode}}return null},findParentByTagName:function(e,t,i,n){t=utils.listToMap(utils.isArray(t)?t:[t]);return domUtils.findParent(e,function(e){return t[e.tagName]&&!(n&&n(e))},i)},findParents:function(e,t,i,n){var o=t&&(i&&i(e)||!i)?[e]:[];while(e=domUtils.findParent(e,i)){o.push(e)}return n?o:o.reverse()},insertAfter:function(e,t){return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},remove:function(e,t){var i=e.parentNode,n;if(i){if(t&&e.hasChildNodes()){while(n=e.firstChild){i.insertBefore(n,e)}}i.removeChild(e)}return e},getNextDomNode:function(e,t,i,n){return getDomNode(e,"firstChild","nextSibling",t,i,n)},getPreDomNode:function(e,t,i,n){return getDomNode(e,"lastChild","previousSibling",t,i,n)},isBookmarkNode:function(e){return e.nodeType==1&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;var i=[e],n=[t],o=e,r=-1;while(o=o.parentNode){if(o===t){return o}i.push(o)}o=t;while(o=o.parentNode){if(o===e)return o;n.push(o)}i.reverse();n.reverse();while(r++,i[r]===n[r]){}return r==0?null:i[r-1]},clearEmptySibling:function(e,t,i){function n(e,t){var i;while(e&&!domUtils.isBookmarkNode(e)&&(domUtils.isEmptyInlineElement(e)||!new RegExp("[^\t\n\r"+domUtils.fillChar+"]").test(e.nodeValue))){i=e[t];domUtils.remove(e);e=i}}!t&&n(e.nextSibling,"nextSibling");!i&&n(e.previousSibling,"previousSibling")},split:function(e,t){var i=e.ownerDocument;if(browser.ie&&t==e.nodeValue.length){var n=i.createTextNode("");return domUtils.insertAfter(e,n)}var o=e.splitText(t);if(browser.ie8){var r=i.createTextNode("");domUtils.insertAfter(o,r);domUtils.remove(r)}return o},isWhitespace:function(e){return!new RegExp("[^ \t\n\r"+domUtils.fillChar+"]").test(e.nodeValue)},getXY:function(e){var t=0,i=0;while(e.offsetParent){i+=e.offsetTop;t+=e.offsetLeft;e=e.offsetParent}return{x:t,y:i}},on:function(e,t,i){var n=utils.isArray(t)?t:utils.trim(t).split(/\s+/),o=n.length;if(o)while(o--){t=n[o];if(e.addEventListener){e.addEventListener(t,i,false)}else{if(!i._d){i._d={els:[]}}var r=t+i.toString(),a=utils.indexOf(i._d.els,e);if(!i._d[r]||a==-1){if(a==-1){i._d.els.push(e)}if(!i._d[r]){i._d[r]=function(e){return i.call(e.srcElement,e||window.event)}}e.attachEvent("on"+t,i._d[r])}}}e=null},un:function(e,t,i){var n=utils.isArray(t)?t:utils.trim(t).split(/\s+/),o=n.length;if(o)while(o--){t=n[o];if(e.removeEventListener){e.removeEventListener(t,i,false)}else{var r=t+i.toString();try{e.detachEvent("on"+t,i._d?i._d[r]:i)}catch(e){}if(i._d&&i._d[r]){var a=utils.indexOf(i._d.els,e);if(a!=-1){i._d.els.splice(a,1)}i._d.els.length==0&&delete i._d[r]}}}},isSameElement:function(e,t){if(e.tagName!=t.tagName){return false}var i=e.attributes,n=t.attributes;if(!ie&&i.length!=n.length){return false}var o,r,a=0,s=0;for(var l=0;o=i[l++];){if(o.nodeName=="style"){if(o.specified){a++}if(domUtils.isSameStyle(e,t)){continue}else{return false}}if(ie){if(o.specified){a++;r=n.getNamedItem(o.nodeName)}else{continue}}else{r=t.attributes[o.nodeName]}if(!r.specified||o.nodeValue!=r.nodeValue){return false}}if(ie){for(l=0;r=n[l++];){if(r.specified){s++}}if(a!=s){return false}}return true},isSameStyle:function(e,t){var i=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),n=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){i=e.style;n=t.style;if(i.length!=n.length)return false;for(var o in i){if(/^(\d+|csstext)$/i.test(o)){continue}if(i[o]!=n[o]){return false}}return true}if(!i||!n){return i==n}i=i.split(";");n=n.split(";");if(i.length!=n.length){return false}for(var r=0,a;a=i[r++];){if(utils.indexOf(n,a)==-1){return false}}return true},isBlockElm:function(e){return e.nodeType==1&&(dtd.$block[e.tagName]||styleBlock[domUtils.getComputedStyle(e,"display")])&&!dtd.$nonChild[e.tagName]},isBody:function(e){return e&&e.nodeType==1&&e.tagName.toLowerCase()=="body"},breakParent:function(e,t){var i,n=e,o=e,r,a;do{n=n.parentNode;if(r){i=n.cloneNode(false);i.appendChild(r);r=i;i=n.cloneNode(false);i.appendChild(a);a=i}else{r=n.cloneNode(false);a=r.cloneNode(false)}while(i=o.previousSibling){r.insertBefore(i,r.firstChild)}while(i=o.nextSibling){a.appendChild(i)}o=n}while(t!==n);i=t.parentNode;i.insertBefore(r,t);i.insertBefore(a,t);i.insertBefore(e,a);domUtils.remove(t);return e},isEmptyInlineElement:function(e){if(e.nodeType!=1||!dtd.$removeEmpty[e.tagName]){return 0}e=e.firstChild;while(e){if(domUtils.isBookmarkNode(e)){return 0}if(e.nodeType==1&&!domUtils.isEmptyInlineElement(e)||e.nodeType==3&&!domUtils.isWhitespace(e)){return 0}e=e.nextSibling}return 1},trimWhiteTextNode:function(i){function e(e){var t;while((t=i[e])&&t.nodeType==3&&domUtils.isWhitespace(t)){i.removeChild(t)}}e("firstChild");e("lastChild")},mergeChild:function(e,t,i){var n=domUtils.getElementsByTagName(e,e.tagName.toLowerCase());for(var o=0,r;r=n[o++];){if(!r.parentNode||domUtils.isBookmarkNode(r)){continue}if(r.tagName.toLowerCase()=="span"){if(e===r.parentNode){domUtils.trimWhiteTextNode(e);if(e.childNodes.length==1){e.style.cssText=r.style.cssText+";"+e.style.cssText;domUtils.remove(r,true);continue}}r.style.cssText=e.style.cssText+";"+r.style.cssText;if(i){var a=i.style;if(a){a=a.split(";");for(var s=0,l;l=a[s++];){r.style[utils.cssStyleToDomStyle(l.split(":")[0])]=l.split(":")[1]}}}if(domUtils.isSameStyle(r,e)){domUtils.remove(r,true)}continue}if(domUtils.isSameElement(e,r)){domUtils.remove(r,true)}}},getElementsByTagName:function(e,t,i){if(i&&utils.isString(i)){var n=i;i=function(e){return domUtils.hasClass(e,n)}}t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");var o=[];for(var r=0,a;a=t[r++];){var s=e.getElementsByTagName(a);for(var l=0,d;d=s[l++];){if(!i||i(d))o.push(d)}}return o},mergeToParent:function(e){var t=e.parentNode;while(t&&dtd.$removeEmpty[t.tagName]){if(t.tagName==e.tagName||t.tagName=="A"){domUtils.trimWhiteTextNode(t);if(t.tagName=="SPAN"&&!domUtils.isSameStyle(t,e)||t.tagName=="A"&&e.tagName=="SPAN"){if(t.childNodes.length>1||t!==e.parentNode){e.style.cssText=t.style.cssText+";"+e.style.cssText;t=t.parentNode;continue}else{t.style.cssText+=";"+e.style.cssText;if(t.tagName=="A"){t.style.textDecoration="underline"}}}if(t.tagName!="A"){t===e.parentNode&&domUtils.remove(e,true);break}}t=t.parentNode}},mergeSibling:function(e,t,i){function n(e,t,i){var n;if((n=i[e])&&!domUtils.isBookmarkNode(n)&&n.nodeType==1&&domUtils.isSameElement(i,n)){while(n.firstChild){if(t=="firstChild"){i.insertBefore(n.lastChild,i.firstChild)}else{i.appendChild(n.firstChild)}}domUtils.remove(n)}}!t&&n("previousSibling","firstChild",e);!i&&n("nextSibling","lastChild",e)},unSelectable:ie&&browser.ie9below||browser.opera?function(e){e.onselectstart=function(){return false};e.onclick=e.onkeyup=e.onkeydown=function(){return false};e.unselectable="on";e.setAttribute("unselectable","on");for(var t=0,i;i=e.all[t++];){switch(i.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:i.unselectable="on";e.setAttribute("unselectable","on")}}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.msUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var i=0,n;n=t[i++];){n=attrFix[n]||n;switch(n){case"className":e[n]="";break;case"style":e.style.cssText="";var o=e.getAttributeNode("style");!browser.ie&&o&&e.removeAttributeNode(o)}e.removeAttribute(n)}},createElement:function(e,t,i){return domUtils.setAttributes(e.createElement(t),i)},setAttributes:function(e,t){for(var i in t){if(t.hasOwnProperty(i)){var n=t[i];switch(i){case"class":e.className=n;break;case"style":e.style.cssText=e.style.cssText+";"+n;break;case"innerHTML":e[i]=n;break;case"value":e.value=n;break;default:e.setAttribute(attrFix[i]||i,n)}}}return e},getComputedStyle:function(e,t){var i="width height top left";if(i.indexOf(t)>-1){return e["offset"+t.replace(/^\w/,function(e){return e.toUpperCase()})]+"px"}if(e.nodeType==3){e=e.parentNode}if(browser.ie&&browser.version<9&&t=="font-size"&&!e.style.fontSize&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]){var n=e.ownerDocument.createElement("span");n.style.cssText="padding:0;border:0;font-family:simsun;";n.innerHTML=".";e.appendChild(n);var o=n.offsetHeight;e.removeChild(n);n=null;return o+"px"}try{var r=domUtils.getStyle(e,t)||(window.getComputedStyle?domUtils.getWindow(e).getComputedStyle(e,"").getPropertyValue(t):(e.currentStyle||e.style)[utils.cssStyleToDomStyle(t)])}catch(e){return""}return utils.transUnitToPx(utils.fixColor(t,r))},removeClasses:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var i=0,n,o=e.className;n=t[i++];){o=o.replace(new RegExp("\\b"+n+"\\b"),"")}o=utils.trim(o).replace(/[ ]{2,}/g," ");if(o){e.className=o}else{domUtils.removeAttributes(e,["class"])}},addClass:function(e,t){if(!e)return;t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var i=0,n,o=e.className;n=t[i++];){if(!new RegExp("\\b"+n+"\\b").test(o)){o+=" "+n}}e.className=utils.trim(o)},hasClass:function(e,t){if(utils.isRegExp(t)){return t.test(e.className)}t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var i=0,n,o=e.className;n=t[i++];){if(!new RegExp("\\b"+n+"\\b","i").test(o)){return false}}return i-1==t.length},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=false},removeStyle:function(e,t){if(browser.ie){if(t=="color"){t="(^|;)"+t}e.style.cssText=e.style.cssText.replace(new RegExp(t+"[^:]*:[^;]+;?","ig"),"")}else{if(e.style.removeProperty){e.style.removeProperty(t)}else{e.style.removeAttribute(utils.cssStyleToDomStyle(t))}}if(!e.style.cssText){domUtils.removeAttributes(e,["style"])}},getStyle:function(e,t){var i=e.style[utils.cssStyleToDomStyle(t)];return utils.fixColor(t,i)},setStyle:function(e,t,i){e.style[utils.cssStyleToDomStyle(t)]=i;if(!utils.trim(e.style.cssText)){this.removeAttributes(e,"style")}},setStyles:function(e,t){for(var i in t){if(t.hasOwnProperty(i)){domUtils.setStyle(e,i,t[i])}}},removeDirtyAttr:function(e){for(var t=0,i,n=e.getElementsByTagName("*");i=n[t++];){i.removeAttribute("_moz_dirty")}e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var i=0,n=e.firstChild;t=t||function(){return 1};while(n){if(t(n)){i++}n=n.nextSibling}return i},isEmptyNode:function(e){return!e.firstChild||domUtils.getChildCount(e,function(e){return!domUtils.isBr(e)&&!domUtils.isBookmarkNode(e)&&!domUtils.isWhitespace(e)})==0},clearSelectedArr:function(e){var t;while(t=e.pop()){domUtils.removeAttributes(t,["class"])}},scrollToView:function(e,i,t){var n=function(){var e=i.document,t=e.compatMode=="CSS1Compat";return{width:(t?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(t?e.documentElement.clientHeight:e.body.clientHeight)||0}},o=function(e){if("pageXOffset"in e){return{x:e.pageXOffset||0,y:e.pageYOffset||0}}else{var t=e.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}}};var r=n().height,a=r*-1+t;a+=e.offsetHeight||0;var s=domUtils.getXY(e);a+=s.y;var l=o(i).y;if(a>l||a<l-r){i.scrollTo(0,a+(a<0?-20:20))}},isBr:function(e){return e.nodeType==1&&e.tagName=="BR"},isFillChar:function(e,t){if(e.nodeType!=3)return false;var i=e.nodeValue;if(t){return new RegExp("^"+domUtils.fillChar).test(i)}return!i.replace(new RegExp(domUtils.fillChar,"g"),"").length},isStartInblock:function(e){var t=e.cloneRange(),i=0,n=t.startContainer,o;if(n.nodeType==1&&n.childNodes[t.startOffset]){n=n.childNodes[t.startOffset];var r=n.previousSibling;while(r&&domUtils.isFillChar(r)){n=r;r=r.previousSibling}}if(this.isFillChar(n,true)&&t.startOffset==1){t.setStartBefore(n);n=t.startContainer}while(n&&domUtils.isFillChar(n)){o=n;n=n.previousSibling}if(o){t.setStartBefore(o);n=t.startContainer}if(n.nodeType==1&&domUtils.isEmptyNode(n)&&t.startOffset==1){t.setStart(n,0).collapse(true)}while(!t.startOffset){n=t.startContainer;if(domUtils.isBlockElm(n)||domUtils.isBody(n)){i=1;break}var r=t.startContainer.previousSibling,a;if(!r){t.setStartBefore(t.startContainer)}else{while(r&&domUtils.isFillChar(r)){a=r;r=r.previousSibling}if(a){t.setStartBefore(a)}else{t.setStartBefore(t.startContainer)}}}return i&&!domUtils.isBody(t.startContainer)?1:0},isEmptyBlock:function(e,t){if(e.nodeType!=1)return 0;t=t||new RegExp("[  \t\r\n"+domUtils.fillChar+"]","g");if(e[browser.ie?"innerText":"textContent"].replace(t,"").length>0){return 0}for(var i in dtd.$isNotEmpty){if(e.getElementsByTagName(i).length){return 0}}return 1},setViewportOffset:function(e,t){var i=parseInt(e.style.left)|0;var n=parseInt(e.style.top)|0;var o=e.getBoundingClientRect();var r=t.left-o.left;var a=t.top-o.top;if(r){e.style.left=i+r+"px"}if(a){e.style.top=n+a+"px"}},fillNode:function(e,t){var i=browser.ie?e.createTextNode(domUtils.fillChar):e.createElement("br");t.innerHTML="";t.appendChild(i)},moveChild:function(e,t,i){while(e.firstChild){if(i&&t.firstChild){t.insertBefore(e.lastChild,t.firstChild)}else{t.appendChild(e.firstChild)}}},hasNoAttributes:function(e){return browser.ie?/^<\w+\s*?>/.test(e.outerHTML):e.attributes.length==0},isCustomeNode:function(e){return e.nodeType==1&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return e.nodeType==1&&new RegExp("\\b"+e.tagName+"\\b","i").test(t)},filterNodeList:function(e,t,i){var n=[];if(!utils.isFunction(t)){var o=t;t=function(e){return utils.indexOf(utils.isArray(o)?o:o.split(" "),e.tagName.toLowerCase())!=-1}}utils.each(e,function(e){t(e)&&n.push(e)});return n.length==0?null:n.length==1||!i?n[0]:n},isInNodeEndBoundary:function(e,t){var i=e.startContainer;if(i.nodeType==3&&e.startOffset!=i.nodeValue.length){return 0}if(i.nodeType==1&&e.startOffset!=i.childNodes.length){return 0}while(i!==t){if(i.nextSibling){return 0}i=i.parentNode}return 1},isBoundaryNode:function(e,t){var i;while(!domUtils.isBody(e)){i=e;e=e.parentNode;if(i!==e[t]){return false}}return true},fillHtml:browser.ie11below?"&nbsp;":"<br/>"};var fillCharReg=new RegExp(domUtils.fillChar,"g");(function(){var o=0,c=domUtils.fillChar,u;function r(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function a(e){return!e.collapsed&&e.startContainer.nodeType==1&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function i(e,t,i,n){if(t.nodeType==1&&(dtd.$empty[t.tagName]||dtd.$nonChild[t.tagName])){i=domUtils.getNodeIndex(t)+(e?0:1);t=t.parentNode}if(e){n.startContainer=t;n.startOffset=i;if(!n.endContainer){n.collapse(true)}}else{n.endContainer=t;n.endOffset=i;if(!n.startContainer){n.collapse(false)}}r(n);return n}function t(e,t){var i=e.startContainer,n=e.endContainer,o=e.startOffset,r=e.endOffset,a=e.document,s=a.createDocumentFragment(),l,d;if(i.nodeType==1){i=i.childNodes[o]||(l=i.appendChild(a.createTextNode("")))}if(n.nodeType==1){n=n.childNodes[r]||(d=n.appendChild(a.createTextNode("")))}if(i===n&&i.nodeType==3){s.appendChild(a.createTextNode(i.substringData(o,r-o)));if(t){i.deleteData(o,r-o);e.collapse(true)}return s}var c,u,f=s,m=domUtils.findParents(i,true),h=domUtils.findParents(n,true);for(var p=0;m[p]==h[p];){p++}for(var g=p,v;v=m[g];g++){c=v.nextSibling;if(v==i){if(!l){if(e.startContainer.nodeType==3){f.appendChild(a.createTextNode(i.nodeValue.slice(o)));if(t){i.deleteData(o,i.nodeValue.length-o)}}else{f.appendChild(!t?i.cloneNode(true):i)}}}else{u=v.cloneNode(false);f.appendChild(u)}while(c){if(c===n||c===h[g]){break}v=c.nextSibling;f.appendChild(!t?c.cloneNode(true):c);c=v}f=u}f=s;if(!m[p]){f.appendChild(m[p-1].cloneNode(false));f=f.firstChild}for(var g=p,b;b=h[g];g++){c=b.previousSibling;if(b==n){if(!d&&e.endContainer.nodeType==3){f.appendChild(a.createTextNode(n.substringData(0,r)));if(t){n.deleteData(0,r)}}}else{u=b.cloneNode(false);f.appendChild(u)}if(g!=p||!m[p]){while(c){if(c===i){break}b=c.previousSibling;f.insertBefore(!t?c.cloneNode(true):c,f.firstChild);c=b}}f=u}if(t){e.setStartBefore(!h[p]?h[p-1]:!m[p]?m[p-1]:h[p]).collapse(true)}l&&domUtils.remove(l);d&&domUtils.remove(d);return s}var n=dom.Range=function(e){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null;t.document=e;t.collapsed=true};function f(e,t){try{if(u&&domUtils.inDoc(u,e)){if(!u.nodeValue.replace(fillCharReg,"").length){var i=u.parentNode;domUtils.remove(u);while(i&&domUtils.isEmptyInlineElement(i)&&(browser.safari?!(domUtils.getPosition(i,t)&domUtils.POSITION_CONTAINS):!i.contains(t))){u=i.parentNode;domUtils.remove(i);i=u}}else{u.nodeValue=u.nodeValue.replace(fillCharReg,"")}}}catch(e){}}function m(e,t){var i;e=e[t];while(e&&domUtils.isFillChar(e)){i=e[t];domUtils.remove(e);e=i}}n.prototype={cloneContents:function(){return this.collapsed?null:t(this,0)},deleteContents:function(){var e;if(!this.collapsed){t(this,1)}if(browser.webkit){e=this.startContainer;if(e.nodeType==3&&!e.nodeValue.length){this.setStartBefore(e).collapse(true);domUtils.remove(e)}}return this},extractContents:function(){return this.collapsed?null:t(this,2)},setStart:function(e,t){return i(true,e,t,this)},setEnd:function(e,t){return i(false,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return new n(e.document).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;if(e){t.endContainer=t.startContainer;t.endOffset=t.startOffset}else{t.startContainer=t.endContainer;t.startOffset=t.endOffset}t.collapsed=true;return t},shrinkBoundary:function(e){var t=this,i,n=t.collapsed;function o(e){return e.nodeType==1&&!domUtils.isBookmarkNode(e)&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]}while(t.startContainer.nodeType==1&&(i=t.startContainer.childNodes[t.startOffset])&&o(i)){t.setStart(i,0)}if(n){return t.collapse(true)}if(!e){while(t.endContainer.nodeType==1&&t.endOffset>0&&(i=t.endContainer.childNodes[t.endOffset-1])&&o(i)){t.setEnd(i,i.childNodes.length)}}return t},getCommonAncestor:function(e,t){var i=this,n=i.startContainer,o=i.endContainer;if(n===o){if(e&&a(this)){n=n.childNodes[i.startOffset];if(n.nodeType==1)return n}return t&&n.nodeType==3?n.parentNode:n}return domUtils.getCommonAncestor(n,o)},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,i=this.startOffset,n=this.collapsed,o=this.endContainer;if(t.nodeType==3){if(i==0){this.setStartBefore(t)}else{if(i>=t.nodeValue.length){this.setStartAfter(t)}else{var r=domUtils.split(t,i);if(t===o){this.setEnd(r,this.endOffset-i)}else if(t.parentNode===o){this.endOffset+=1}this.setStartBefore(r)}}if(n){return this.collapse(true)}}if(!e){i=this.endOffset;o=this.endContainer;if(o.nodeType==3){if(i==0){this.setEndBefore(o)}else{i<o.nodeValue.length&&domUtils.split(o,i);this.setEndAfter(o)}}}return this},txtToElmBoundary:function(e){function t(e,t){var i=e[t+"Container"],n=e[t+"Offset"];if(i.nodeType==3){if(!n){e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](i)}else if(n>=i.nodeValue.length){e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](i)}}}if(e||!this.collapsed){t(this,"start");t(this,"end")}return this},insertNode:function(e){var t=e,i=1;if(e.nodeType==11){t=e.firstChild;i=e.childNodes.length}this.trimBoundary(true);var n=this.startContainer,o=this.startOffset;var r=n.childNodes[o];if(r){n.insertBefore(e,r)}else{n.appendChild(e)}if(t.parentNode===this.endContainer){this.endOffset=this.endOffset+i}return this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var i,n=this.document.createElement("span");n.style.cssText="display:none;line-height:0px;";n.appendChild(this.document.createTextNode("‍"));n.id="_baidu_bookmark_start_"+(t?"":o++);if(!this.collapsed){i=n.cloneNode(true);i.id="_baidu_bookmark_end_"+(t?"":o++)}this.insertNode(n);if(i){this.collapse().insertNode(i).setEndBefore(i)}this.setStartAfter(n);return{start:e?n.id:n,end:i?e?i.id:i:null,id:e}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,i=e.end&&e.id?this.document.getElementById(e.end):e.end;this.setStartBefore(t);domUtils.remove(t);if(i){this.setEndBefore(i);domUtils.remove(i)}else{this.collapse(true)}return this},enlarge:function(e,t){var i=domUtils.isBody,n,o,r=this.document.createTextNode("");if(e){o=this.startContainer;if(o.nodeType==1){if(o.childNodes[this.startOffset]){n=o=o.childNodes[this.startOffset]}else{o.appendChild(r);n=o=r}}else{n=o}while(1){if(domUtils.isBlockElm(o)){o=n;while((n=o.previousSibling)&&!domUtils.isBlockElm(n)){o=n}this.setStartBefore(o);break}n=o;o=o.parentNode}o=this.endContainer;if(o.nodeType==1){if(n=o.childNodes[this.endOffset]){o.insertBefore(r,n)}else{o.appendChild(r)}n=o=r}else{n=o}while(1){if(domUtils.isBlockElm(o)){o=n;while((n=o.nextSibling)&&!domUtils.isBlockElm(n)){o=n}this.setEndAfter(o);break}n=o;o=o.parentNode}if(r.parentNode===this.endContainer){this.endOffset--}domUtils.remove(r)}if(!this.collapsed){while(this.startOffset==0){if(t&&t(this.startContainer)){break}if(i(this.startContainer)){break}this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(t&&t(this.endContainer)){break}if(i(this.endContainer)){break}this.setEndAfter(this.endContainer)}}return this},enlargeToBlockElm:function(e){while(!domUtils.isBlockElm(this.startContainer)){this.setStartBefore(this.startContainer)}if(!e){while(!domUtils.isBlockElm(this.endContainer)){this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer)}while(!domUtils.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setEndBefore(this.endContainer)}}return this},applyInlineStyle:function(t,i,e){if(this.collapsed)return this;this.trimBoundary().enlarge(false,function(e){return e.nodeType==1&&domUtils.isBlockElm(e)}).adjustmentBoundary();var n=this.createBookmark(),o=n.end,r=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br":!domUtils.isWhitespace(e)},a=domUtils.getNextDomNode(n.start,false,r),s,l,d=this.cloneRange();while(a&&domUtils.getPosition(a,o)&domUtils.POSITION_PRECEDING){if(a.nodeType==3||dtd[t][a.tagName]){d.setStartBefore(a);s=a;while(s&&(s.nodeType==3||dtd[t][s.tagName])&&s!==o){l=s;s=domUtils.getNextDomNode(s,s.nodeType==1,null,function(e){return dtd[t][e.tagName]})}var c=d.setEndAfter(l).extractContents(),u;if(e&&e.length>0){var f,m;m=f=e[0].cloneNode(false);for(var h=1,p;p=e[h++];){f.appendChild(p.cloneNode(false));f=f.firstChild}u=f}else{u=d.document.createElement(t)}if(i){domUtils.setAttributes(u,i)}u.appendChild(c);if(u.tagName=="SPAN"&&i&&i.style){utils.each(u.getElementsByTagName("span"),function(e){e.style.cssText=e.style.cssText+";"+i.style})}d.insertNode(e?m:u);var g;if(t=="span"&&i.style&&/text\-decoration/.test(i.style)&&(g=domUtils.findParentByTagName(u,"a",true))){domUtils.setAttributes(g,i);domUtils.remove(u,true);u=g}else{domUtils.mergeSibling(u);domUtils.clearEmptySibling(u)}domUtils.mergeChild(u,i);a=domUtils.getNextDomNode(u,false,r);domUtils.mergeToParent(u);if(s===o){break}}else{a=domUtils.getNextDomNode(a,true,r)}}return this.moveToBookmark(n)},removeInlineStyle:function(e){if(this.collapsed)return this;e=utils.isArray(e)?e:[e];this.shrinkBoundary().adjustmentBoundary();var t=this.startContainer,i=this.endContainer;while(1){if(t.nodeType==1){if(utils.indexOf(e,t.tagName.toLowerCase())>-1){break}if(t.tagName.toLowerCase()=="body"){t=null;break}}t=t.parentNode}while(1){if(i.nodeType==1){if(utils.indexOf(e,i.tagName.toLowerCase())>-1){break}if(i.tagName.toLowerCase()=="body"){i=null;break}}i=i.parentNode}var n=this.createBookmark(),o,r;if(t){r=this.cloneRange().setEndBefore(n.start).setStartBefore(t);o=r.extractContents();r.insertNode(o);domUtils.clearEmptySibling(t,true);t.parentNode.insertBefore(n.start,t)}if(i){r=this.cloneRange().setStartAfter(n.end).setEndAfter(i);o=r.extractContents();r.insertNode(o);domUtils.clearEmptySibling(i,false,true);i.parentNode.insertBefore(n.end,i.nextSibling)}var a=domUtils.getNextDomNode(n.start,false,function(e){return e.nodeType==1}),s;while(a&&a!==n.end){s=domUtils.getNextDomNode(a,true,function(e){return e.nodeType==1});if(utils.indexOf(e,a.tagName.toLowerCase())>-1){domUtils.remove(a,true)}a=s}return this.moveToBookmark(n)},getClosedNode:function(){var e;if(!this.collapsed){var t=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(a(t)){var i=t.startContainer.childNodes[t.startOffset];if(i&&i.nodeType==1&&(dtd.$empty[i.tagName]||dtd.$nonChild[i.tagName])){e=i}}}return e},select:browser.ie?function(e,t){var i;if(!this.collapsed)this.shrinkBoundary();var n=this.getClosedNode();if(n&&!t){try{i=this.document.body.createControlRange();i.addElement(n);i.select()}catch(e){}return this}var o=this.createBookmark(),r=o.start,a;i=this.document.body.createTextRange();i.moveToElementText(r);i.moveStart("character",1);if(!this.collapsed){var s=this.document.body.createTextRange();a=o.end;s.moveToElementText(a);i.setEndPoint("EndToEnd",s)}else{if(!e&&this.startContainer.nodeType!=3){var l=this.document.createTextNode(c),d=this.document.createElement("span");d.appendChild(this.document.createTextNode(c));r.parentNode.insertBefore(d,r);r.parentNode.insertBefore(l,r);f(this.document,l);u=l;m(d,"previousSibling");m(r,"nextSibling");i.moveStart("character",-1);i.collapse(true)}}this.moveToBookmark(o);d&&domUtils.remove(d);try{i.select()}catch(e){}return this}:function(e){function t(n){function e(e,t,i){if(e.nodeType==3&&e.nodeValue.length<t){n[i+"Offset"]=e.nodeValue.length}}e(n.startContainer,n.startOffset,"start");e(n.endContainer,n.endOffset,"end")}var i=domUtils.getWindow(this.document),n=i.getSelection(),o;browser.gecko?this.document.body.focus():i.focus();if(n){n.removeAllRanges();if(this.collapsed&&!e){var r=this.startContainer,a=r;if(r.nodeType==1){a=r.childNodes[this.startOffset]}if(!(r.nodeType==3&&this.startOffset)&&(a?!a.previousSibling||a.previousSibling.nodeType!=3:!r.lastChild||r.lastChild.nodeType!=3)){o=this.document.createTextNode(c);this.insertNode(o);f(this.document,o);m(o,"previousSibling");m(o,"nextSibling");u=o;this.setStart(o,browser.webkit?1:0).collapse(true)}}var s=this.document.createRange();if(this.collapsed&&browser.opera&&this.startContainer.nodeType==1){var a=this.startContainer.childNodes[this.startOffset];if(!a){a=this.startContainer.lastChild;if(a&&domUtils.isBr(a)){this.setStartBefore(a).collapse(true)}}else{while(a&&domUtils.isBlockElm(a)){if(a.nodeType==1&&a.childNodes[0]){a=a.childNodes[0]}else{break}}a&&this.setStartBefore(a).collapse(true)}}t(this);s.setStart(this.startContainer,this.startOffset);s.setEnd(this.endContainer,this.endOffset);n.addRange(s)}return this},scrollToView:function(e,t){e=e?window:domUtils.getWindow(this.document);var i=this,n=i.document.createElement("span");n.innerHTML="&nbsp;";i.cloneRange().insertNode(n);domUtils.scrollToView(n,e,t);domUtils.remove(n);return i},inFillChar:function(){var e=this.startContainer;if(this.collapsed&&e.nodeType==3&&e.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1==e.nodeValue.length){return true}return false},createAddress:function(e,d){var t={},c=this;function i(e){var t=e?c.startContainer:c.endContainer;var i=domUtils.findParents(t,true,function(e){return!domUtils.isBody(e)}),n=[];for(var o=0,r;r=i[o++];){n.push(domUtils.getNodeIndex(r,d))}var a=0;if(d){if(t.nodeType==3){var s=t.previousSibling;while(s&&s.nodeType==3){a+=s.nodeValue.replace(fillCharReg,"").length;s=s.previousSibling}a+=e?c.startOffset:c.endOffset}else{t=t.childNodes[e?c.startOffset:c.endOffset];if(t){a=domUtils.getNodeIndex(t,d)}else{t=e?c.startContainer:c.endContainer;var l=t.firstChild;while(l){if(domUtils.isFillChar(l)){l=l.nextSibling;continue}a++;if(l.nodeType==3){while(l&&l.nodeType==3){l=l.nextSibling}}else{l=l.nextSibling}}}}}else{a=e?domUtils.isFillChar(t)?0:c.startOffset:c.endOffset}if(a<0){a=0}n.push(a);return n}t.startAddress=i(true);if(!e){t.endAddress=c.collapsed?[].concat(t.startAddress):i()}return t},moveToAddress:function(e,t){var l=this;function i(e,t){var i=l.document.body,n,o;for(var r=0,a,s=e.length;r<s;r++){a=e[r];n=i;i=i.childNodes[a];if(!i){o=a;break}}if(t){if(i){l.setStartBefore(i)}else{l.setStart(n,o)}}else{if(i){l.setEndBefore(i)}else{l.setEnd(n,o)}}}i(e.startAddress,true);!t&&e.endAddress&&i(e.endAddress);return l},equals:function(e){for(var t in this){if(this.hasOwnProperty(t)){if(this[t]!==e[t])return false}}return true},traversal:function(e,t){if(this.collapsed)return this;var i=this.createBookmark(),n=i.end,o=domUtils.getNextDomNode(i.start,false,t);while(o&&o!==n&&domUtils.getPosition(o,n)&domUtils.POSITION_PRECEDING){var r=domUtils.getNextDomNode(o,false,t);e(o);o=r}return this.moveToBookmark(i)}}})();(function(){function n(e,t){var i=domUtils.getNodeIndex;e=e.duplicate();e.collapse(t);var n=e.parentElement();if(!n.hasChildNodes()){return{container:n,offset:0}}var o=n.children,r,a=e.duplicate(),s=0,l=o.length-1,d=-1,c;while(s<=l){d=Math.floor((s+l)/2);r=o[d];a.moveToElementText(r);var u=a.compareEndPoints("StartToStart",e);if(u>0){l=d-1}else if(u<0){s=d+1}else{return{container:n,offset:i(r)}}}if(d==-1){a.moveToElementText(n);a.setEndPoint("StartToStart",e);c=a.text.replace(/(\r\n|\r)/g,"\n").length;o=n.childNodes;if(!c){r=o[o.length-1];return{container:r,offset:r.nodeValue.length}}var f=o.length;while(c>0){c-=o[--f].nodeValue.length}return{container:o[f],offset:-c}}a.collapse(u>0);a.setEndPoint(u>0?"StartToStart":"EndToStart",e);c=a.text.replace(/(\r\n|\r)/g,"\n").length;if(!c){return dtd.$empty[r.tagName]||dtd.$nonChild[r.tagName]?{container:n,offset:i(r)+(u>0?0:1)}:{container:r,offset:u>0?0:r.childNodes.length}}while(c>0){try{var m=r;r=r[u>0?"previousSibling":"nextSibling"];c-=r.nodeValue.length}catch(e){return{container:n,offset:i(m)}}}return{container:r,offset:u>0?-c:r.nodeValue.length+c}}function s(e,t){if(e.item){t.selectNode(e.item(0))}else{var i=n(e,true);t.setStart(i.container,i.offset);if(e.compareEndPoints("StartToEnd",e)!=0){i=n(e,false);t.setEnd(i.container,i.offset)}}return t}function o(e){var t;try{t=e.getNative().createRange()}catch(e){return null}var i=t.item?t.item(0):t.parentElement();if((i.ownerDocument||i)===e.document){return t}return null}var e=dom.Selection=function(e){var t=this,i;t.document=e;if(browser.ie9below){i=domUtils.getWindow(e).frameElement;domUtils.on(i,"beforedeactivate",function(){t._bakIERange=t.getIERange()});domUtils.on(i,"activate",function(){try{if(!o(t)&&t._bakIERange){t._bakIERange.select()}}catch(e){}t._bakIERange=null})}i=e=null};e.prototype={rangeInBody:function(e,t){var i=browser.ie9below||t?e.item?e.item():e.parentElement():e.startContainer;return i===this.document.body||domUtils.inDoc(i,this.document)},getNative:function(){var e=this.document;try{return!e?null:browser.ie9below?e.selection:domUtils.getWindow(e).getSelection()}catch(e){return null}},getIERange:function(){var e=o(this);if(!e){if(this._bakIERange){return this._bakIERange}}return e},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath){return this._cachedStartElementPath}var e=this.getStart();if(e){return domUtils.findParents(e,true,null,true)}return[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(browser.ie9below){var e=o(this);return!!(e&&this.rangeInBody(e))}else{return!!this.getNative().rangeCount}}catch(e){return false}},getRange:function(){var n=this;function t(e){var t=n.document.body.firstChild,i=e.collapsed;while(t&&t.firstChild){e.setStart(t,0);t=t.firstChild}if(!e.startContainer){e.setStart(n.document.body,0)}if(i){e.collapse(true)}}if(n._cachedRange!=null){return this._cachedRange}var i=new baidu.editor.dom.Range(n.document);if(browser.ie9below){var e=n.getIERange();if(e){try{s(e,i)}catch(e){t(i)}}else{t(i)}}else{var o=n.getNative();if(o&&o.rangeCount){var r=o.getRangeAt(0);var a=o.getRangeAt(o.rangeCount-1);i.setStart(r.startContainer,r.startOffset).setEnd(a.endContainer,a.endOffset);if(i.collapsed&&domUtils.isBody(i.startContainer)&&!i.startOffset){t(i)}}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document)){return this._bakRange}t(i)}}return this._bakRange=i},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement}var e=browser.ie9below?this.getIERange():this.getRange(),t,i,n,o;if(browser.ie9below){if(!e){return this.document.body.firstChild}if(e.item){return e.item(0)}t=e.duplicate();t.text.length>0&&t.moveStart("character",1);t.collapse(1);i=t.parentElement();o=n=e.parentElement();while(n=n.parentNode){if(n==i){i=o;break}}}else{e.shrinkBoundary();i=e.startContainer;if(i.nodeType==1&&i.hasChildNodes()){i=i.childNodes[Math.min(i.childNodes.length-1,e.startOffset)]}if(i.nodeType==3){return i.parentNode}}return i},getText:function(){var e,t;if(this.isFocus()&&(e=this.getNative())){t=browser.ie9below?e.createRange():e.getRangeAt(0);return browser.ie9below?t.text:t.toString()}return""},clearRange:function(){this.getNative()[browser.ie9below?"empty":"removeAllRanges"]()}}})();(function(){var i=0,s;function c(e,t){var i;if(t.options.textarea){if(utils.isString(t.options.textarea)){for(var n=0,o,r=domUtils.getElementsByTagName(e,"textarea");o=r[n++];){if(o.id=="ueditor_textarea_"+t.options.textarea){i=o;break}}}else{i=t.textarea}}if(!i){e.appendChild(i=domUtils.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"}));t.textarea=i}!i.getAttribute("name")&&i.setAttribute("name",t.options.textarea);i.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,true):""}function e(e){for(var t in UE.plugins){UE.plugins[t].call(e)}}function n(e){for(var t in e){return t}}function o(e){e.langIsReady=true;e.fireEvent("langReady")}var r=UE.Editor=function(e){var t=this;t.uid=i++;EventBase.call(t);t.commands={};t.options=utils.extend(utils.clone(e||{}),UEDITOR_CONFIG,true);t.shortcutkeys={};t.inputRules=[];t.outputRules=[];t.setOpt(r.defaultOptions(t));t.loadServerConfig();if(!utils.isEmptyObject(UE.I18N)){t.options.lang=n(UE.I18N);UE.plugin.load(t);o(t)}else{utils.loadFile(document,{src:t.options.langPath+t.options.lang+"/"+t.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(t);o(t)})}UE.instants["ueditorInstant"+t.uid]=t};r.prototype={registerCommand:function(e,t){this.commands[e]=t},ready:function(e){var t=this;if(e){t.isReady?e.apply(t):t.addListener("ready",e)}},setPlaceholder:function(){function i(){var e=this.getPlainTxt();if(!e.trim()){UE.dom.domUtils.addClass(this.body,"empty")}else{UE.dom.domUtils.removeClasses(this.body,"empty")}}return function(e){var t=this;t.ready(function(){i.call(t);t.body.setAttribute("placeholder",e)});t.removeListener("keyup contentchange",i);t.addListener("keyup contentchange",i)}}(),setOpt:function(e,t){var i={};if(utils.isString(e)){i[e]=t}else{i=e}utils.extend(this.options,i,true)},getOpt:function(e){return this.options[e]},destroy:function(){var e=this;e.fireEvent("destroy");var t=e.container.parentNode;var i=e.textarea;if(!i){i=document.createElement("textarea");t.parentNode.insertBefore(i,t)}else{i.style.display=""}i.style.width=e.iframe.offsetWidth+"px";i.style.height=e.iframe.offsetHeight+"px";i.value=e.getContent();i.id=e.key;t.innerHTML="";domUtils.remove(t);var n=e.key;for(var o in e){if(e.hasOwnProperty(o)){delete this[o]}}UE.delEditor(n)},render:function(t){var e=this,i=e.options,n=function(e){return parseInt(domUtils.getComputedStyle(t,e))};if(utils.isString(t)){t=document.getElementById(t)}if(t){if(i.initialFrameWidth){i.minFrameWidth=i.initialFrameWidth}else{i.minFrameWidth=i.initialFrameWidth=t.offsetWidth}if(i.initialFrameHeight){i.minFrameHeight=i.initialFrameHeight}else{i.initialFrameHeight=i.minFrameHeight=t.offsetHeight}t.style.width=/%$/.test(i.initialFrameWidth)?"100%":i.initialFrameWidth-n("padding-left")-n("padding-right")+"px";t.style.height=/%$/.test(i.initialFrameHeight)?"100%":i.initialFrameHeight-n("padding-top")-n("padding-bottom")+"px";t.style.zIndex=i.zIndex;var o=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' >"+"<head>"+"<style type='text/css'>"+".view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\n"+"body{margin:8px;font-family:sans-serif;font-size:16px;}"+"body.empty:before{content:attr(placeholder);position:absolute;color:#999;}"+"p{margin:5px 0;}</style>"+(i.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(i.iframeCssUrl)+"'/>":"")+(i.initialStyle?"<style>"+i.initialStyle+"</style>":"")+"</head>"+"<body class='view' ></body>"+"<script type='text/javascript' "+(ie?"defer='defer'":"")+" id='_initialScript'>"+"setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+e.uid+"'];editor._setup(document);},0);"+"var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);"+"<\/script>"+(i.iframeJsUrl?"<script type='text/javascript' src='"+utils.unhtml(i.iframeJsUrl)+"'><\/script>":"")+"</html>";t.appendChild(domUtils.createElement(document,"iframe",{id:"ueditor_"+e.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(i.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+o+'");document.close();}())'}));t.style.overflow="hidden";setTimeout(function(){if(/%$/.test(i.initialFrameWidth)){i.minFrameWidth=i.initialFrameWidth=t.offsetWidth}if(/%$/.test(i.initialFrameHeight)){i.minFrameHeight=i.initialFrameHeight=t.offsetHeight;t.style.height=i.initialFrameHeight+"px"}})}},_setup:function(e){var t=this,i=t.options;if(ie){e.body.disabled=true;e.body.contentEditable=true;e.body.disabled=false}else{e.body.contentEditable=true}e.body.spellcheck=false;t.document=e;t.window=e.defaultView||e.parentWindow;t.iframe=t.window.frameElement;t.body=e.body;t.selection=new dom.Selection(e);var n;if(browser.gecko&&(n=this.selection.getNative())){n.removeAllRanges()}this._initEvents();for(var o=this.iframe.parentNode;!domUtils.isBody(o);o=o.parentNode){if(o.tagName=="FORM"){t.form=o;if(t.options.autoSyncData){domUtils.on(t.window,"blur",function(){c(o,t)})}else{domUtils.on(o,"submit",function(){c(this,t)})}break}}if(i.initialContent){if(i.autoClearinitialContent){var r=t.execCommand;t.execCommand=function(){t.fireEvent("firstBeforeExecCommand");return r.apply(t,arguments)};this._setDefaultContent(i.initialContent)}else this.setContent(i.initialContent,false,true)}if(domUtils.isEmptyNode(t.body)){t.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"}if(i.focus){setTimeout(function(){t.focus(t.options.focusInEnd);!t.options.autoClearinitialContent&&t._selectionChange()},0)}if(!t.container){t.container=this.iframe.parentNode}if(i.fullscreen&&t.ui){t.ui.setFullScreen(true)}try{t.document.execCommand("2D-position",false,false)}catch(e){}try{t.document.execCommand("enableInlineTableEditing",false,false)}catch(e){}try{t.document.execCommand("enableObjectResizing",false,false)}catch(e){}t._bindshortcutKeys();t.isReady=1;t.fireEvent("ready");i.onready&&i.onready.call(t);if(!browser.ie9below){domUtils.on(t.window,["blur","focus"],function(e){if(e.type=="blur"){t._bakRange=t.selection.getRange();try{t._bakNativeRange=t.selection.getNative().getRangeAt(0);t.selection.getNative().removeAllRanges()}catch(e){t._bakNativeRange=null}}else{try{t._bakRange&&t._bakRange.select()}catch(e){}}})}if(browser.gecko&&browser.version<=10902){t.body.contentEditable=false;setTimeout(function(){t.body.contentEditable=true},100);setInterval(function(){t.body.style.height=t.iframe.offsetHeight-20+"px"},100)}!i.isShow&&t.setHide();i.readonly&&t.setDisabled()},sync:function(e){var t=this,i=e?document.getElementById(e):domUtils.findParent(t.iframe.parentNode,function(e){return e.tagName=="FORM"},true);i&&c(i,t)},setHeight:function(e,t){if(e!==parseInt(this.iframe.parentNode.style.height)){this.iframe.parentNode.style.height=e+"px"}!t&&(this.options.minFrameHeight=this.options.initialFrameHeight=e);this.body.style.height=e+"px";!t&&this.trigger("setHeight")},addshortcutkey:function(e,t){var i={};if(t){i[e]=t}else{i=e}utils.extend(this.shortcutkeys,i)},_bindshortcutKeys:function(){var d=this,c=this.shortcutkeys;d.addListener("keydown",function(e,t){var i=t.keyCode||t.which;for(var n in c){var o=c[n].split(",");for(var r=0,a;a=o[r++];){a=a.split(":");var s=a[0],l=a[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(s.toLowerCase())||/^(\d+)$/.test(s)){if((RegExp.$1=="ctrl"?t.ctrlKey||t.metaKey:0)&&(RegExp.$2!=""?t[RegExp.$2.slice(1)+"Key"]:1)&&i==RegExp.$3||i==RegExp.$1){if(d.queryCommandState(n,l)!=-1)d.execCommand(n,l);domUtils.preventDefault(t)}}}}})},getContent:function(e,t,i,n,o){var r=this;if(e&&utils.isFunction(e)){t=e;e=""}if(t?!t():!this.hasContents()){return""}r.fireEvent("beforegetcontent");var a=UE.htmlparser(r.body.innerHTML,n);r.filterOutputRule(a);r.fireEvent("aftergetcontent",e,a);return a.toHtml(o)},getAllHtml:function(){var e=this,t=[],i="";e.fireEvent("getAllHtml",t);if(browser.ie&&browser.version>8){var n="";utils.each(e.document.styleSheets,function(e){n+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"});utils.each(e.document.getElementsByTagName("script"),function(e){n+=e.outerHTML})}return"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+(n||e.document.getElementsByTagName("head")[0].innerHTML)+t.join("\n")+"</head>"+"<body "+(ie&&browser.version<9?'class="view"':"")+">"+e.getContent(null,null,true)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(domUtils.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,i){return dtd.$block[i]?"\n":t?t:""});return t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(e,t,i){var n=this;n.fireEvent("beforesetcontent",e);var o=UE.htmlparser(e);n.filterInputRule(o);e=o.toHtml();n.body.innerHTML=(t?n.body.innerHTML:"")+e;function r(e){return e.tagName=="DIV"&&e.getAttribute("cdata_tag")}if(n.options.enterTag=="p"){var a=this.body.firstChild,s;if(!a||a.nodeType==1&&(dtd.$cdata[a.tagName]||r(a)||domUtils.isCustomeNode(a))&&a===this.body.lastChild){this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML}else{var l=n.document.createElement("p");while(a){while(a&&(a.nodeType==3||a.nodeType==1&&dtd.p[a.tagName]&&!dtd.$cdata[a.tagName])){s=a.nextSibling;l.appendChild(a);a=s}if(l.firstChild){if(!a){n.body.appendChild(l);break}else{a.parentNode.insertBefore(l,a);l=n.document.createElement("p")}}a=a.nextSibling}}}n.fireEvent("aftersetcontent");n.fireEvent("contentchange");!i&&n._selectionChange();n._bakRange=n._bakIERange=n._bakNativeRange=null;var d;if(browser.gecko&&(d=this.selection.getNative())){d.removeAllRanges()}if(n.options.autoSyncData){n.form&&c(n.form,n)}},focus:function(e){try{var t=this,i=t.selection.getRange();if(e){var n=t.body.lastChild;if(n&&n.nodeType==1&&!dtd.$empty[n.tagName]){if(domUtils.isEmptyBlock(n)){i.setStartAtFirst(n)}else{i.setStartAtLast(n)}i.collapse(true)}i.setCursor(true)}else{if(!i.collapsed&&domUtils.isBody(i.startContainer)&&i.startOffset==0){var n=t.body.firstChild;if(n&&n.nodeType==1&&!dtd.$empty[n.tagName]){i.setStartAtFirst(n).collapse(true)}}i.select(true)}this.fireEvent("focus selectionchange")}catch(e){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var e=this.selection.getNative();if(e.empty&&browser.ie){var t=document.body.createTextRange();t.moveToElementText(document.body);t.collapse(true);t.select();e.empty()}else{e.removeAllRanges()}},_initEvents:function(){var t=this,e=t.document,i=t.window;t._proxyDomEvent=utils.bind(t._proxyDomEvent,t);domUtils.on(e,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],t._proxyDomEvent);domUtils.on(i,["focus","blur"],t._proxyDomEvent);domUtils.on(t.body,"drop",function(e){if(browser.gecko&&e.stopPropagation){e.stopPropagation()}t.fireEvent("contentchange")});domUtils.on(e,["mouseup","keydown"],function(e){if(e.type=="keydown"&&(e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)){return}if(e.button==2)return;t._selectionChange(250,e)})},_proxyDomEvent:function(e){if(this.fireEvent("before"+e.type.replace(/^on/,"").toLowerCase())===false){return false}if(this.fireEvent(e.type.replace(/^on/,""),e)===false){return false}return this.fireEvent("after"+e.type.replace(/^on/,"").toLowerCase())},_selectionChange:function(e,i){var n=this;var o=false;var r,a;if(browser.ie&&browser.version<9&&i&&i.type=="mouseup"){var t=this.selection.getRange();if(!t.collapsed){o=true;r=i.clientX;a=i.clientY}}clearTimeout(s);s=setTimeout(function(){if(!n.selection||!n.selection.getNative()){return}var t;if(o&&n.selection.getNative().type=="None"){t=n.document.body.createTextRange();try{t.moveToPoint(r,a)}catch(e){t=null}}var e;if(t){e=n.selection.getIERange;n.selection.getIERange=function(){return t}}n.selection.cache();if(e){n.selection.getIERange=e}if(n.selection._cachedRange&&n.selection._cachedStartElement){n.fireEvent("beforeselectionchange");n.fireEvent("selectionchange",!!i);n.fireEvent("afterselectionchange");n.selection.clear()}},e||50)},_callCmdFn:function(e,t){var i=t[0].toLowerCase(),n,o;n=this.commands[i]||UE.commands[i];o=n&&n[e];if((!n||!o)&&e=="queryCommandState"){return 0}else if(o){return o.apply(this,t)}},execCommand:function(e){e=e.toLowerCase();var t=this;var i;var n=t.commands[e]||UE.commands[e];if(!n||!n.execCommand){return null}if(!n.notNeedUndo&&!t.__hasEnterExecCommand){t.__hasEnterExecCommand=true;if(t.queryCommandState.apply(t,arguments)!=-1){t.fireEvent("saveScene");t.fireEvent.apply(t,["beforeexeccommand",e].concat(arguments));i=this._callCmdFn("execCommand",arguments);t.fireEvent.apply(t,["afterexeccommand",e].concat(arguments));t.fireEvent("saveScene")}t.__hasEnterExecCommand=false}else{i=this._callCmdFn("execCommand",arguments);!t.__hasEnterExecCommand&&!n.ignoreContentChange&&!t._ignoreContentChange&&t.fireEvent("contentchange")}!t.__hasEnterExecCommand&&!n.ignoreContentChange&&!t._ignoreContentChange&&t._selectionChange();return i},queryCommandState:function(e){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(e){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e){for(var t=0,i;i=e[t++];){if(this.document.getElementsByTagName(i).length>0){return true}}}if(!domUtils.isEmptyBlock(this.body)){return true}e=["div"];for(t=0;i=e[t++];){var n=domUtils.getElementsByTagName(this.document,i);for(var o=0,r;r=n[o++];){if(domUtils.isCustomeNode(r)){return true}}}return false},reset:function(){this.fireEvent("reset")},setEnabled:function(){var t=this,i;if(t.body.contentEditable=="false"){t.body.contentEditable=true;i=t.selection.getRange();try{i.moveToBookmark(t.lastBk);delete t.lastBk}catch(e){i.setStartAtFirst(t.body).collapse(true)}i.select(true);if(t.bkqueryCommandState){t.queryCommandState=t.bkqueryCommandState;delete t.bkqueryCommandState}if(t.bkqueryCommandValue){t.queryCommandValue=t.bkqueryCommandValue;delete t.bkqueryCommandValue}t.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(t){var i=this;t=t?utils.isArray(t)?t:[t]:[];if(i.body.contentEditable=="true"){if(!i.lastBk){i.lastBk=i.selection.getRange().createBookmark(true)}i.body.contentEditable=false;i.bkqueryCommandState=i.queryCommandState;i.bkqueryCommandValue=i.queryCommandValue;i.queryCommandState=function(e){if(utils.indexOf(t,e)!=-1){return i.bkqueryCommandState.apply(i,arguments)}return-1};i.queryCommandValue=function(e){if(utils.indexOf(t,e)!=-1){return i.bkqueryCommandValue.apply(i,arguments)}return null};i.fireEvent("selectionchange")}},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function i(){var e=this;if(e.document.getElementById("initContent")){e.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";e.removeListener("firstBeforeExecCommand focus",i);setTimeout(function(){e.focus();e._selectionChange()},0)}}return function(e){var t=this;t.body.innerHTML='<p id="initContent">'+e+"</p>";t.addListener("firstBeforeExecCommand focus",i)}}(),setShow:function(){var t=this,i=t.selection.getRange();if(t.container.style.display=="none"){try{i.moveToBookmark(t.lastBk);delete t.lastBk}catch(e){i.setStartAtFirst(t.body).collapse(true)}setTimeout(function(){i.select(true)},100);t.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;if(!e.lastBk){e.lastBk=e.selection.getRange().createBookmark(true)}e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UE.I18N[this.options.lang];if(!t){throw Error("not import language file")}e=(e||"").split(".");for(var i=0,n;n=e[i++];){t=t[n];if(!t)break}return t},getContentLength:function(e,t){var i=this.getContent(false,false,true).length;if(e){t=(t||[]).concat(["hr","img","iframe"]);i=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var n=0,o;o=t[n++];){i+=this.document.getElementsByTagName(o).length}}return i},addInputRule:function(e){this.inputRules.push(e)},filterInputRule:function(e){for(var t=0,i;i=this.inputRules[t++];){i.call(this,e)}},addOutputRule:function(e){this.outputRules.push(e)},filterOutputRule:function(e){for(var t=0,i;i=this.outputRules[t++];){i.call(this,e)}},getActionUrl:function(e){var t=this.getOpt(e)||e,i=this.getOpt("imageUrl"),n=this.getOpt("serverUrl");if(!n&&i){n=i.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2")}if(n){n=n+(n.indexOf("?")==-1?"?":"&")+"action="+(t||"");return utils.formatUrl(n)}else{return""}}};utils.inherits(r,EventBase)})();UE.Editor.defaultOptions=function(e){var t=e.options.UEDITOR_HOME_URL;return{isShow:true,initialContent:"",initialStyle:"",autoClearinitialContent:false,iframeCssUrl:t+"themes/iframe.css",textarea:"editorValue",focus:false,focusInEnd:true,autoClearEmptyNode:true,fullscreen:false,readonly:false,zIndex:999,imagePopup:true,enterTag:"p",customDomain:false,lang:"zh-cn",langPath:t+"i18n/",theme:"default",themePath:t+"themes/",allHtmlEnabled:false,scaleEnabled:false,tableNativeEditInFF:false,autoSyncData:true,fileNameFormat:"{time}{rand:6}"}};(function(){UE.Editor.prototype.loadServerConfig=function(){var me=this;setTimeout(function(){try{me.options.imageUrl&&me.setOpt("serverUrl",me.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var configUrl=me.getActionUrl("config"),isJsonp=utils.isCrossDomainUrl(configUrl);me._serverConfigLoaded=false;configUrl&&UE.ajax.request(configUrl,{method:"GET",dataType:isJsonp?"jsonp":"",onsuccess:function(r){try{var config=isJsonp?r:eval("("+r.responseText+")");utils.extend(me.options,config);me.fireEvent("serverConfigLoaded");me._serverConfigLoaded=true}catch(e){showErrorMsg(me.getLang("loadconfigFormatError"))}},onerror:function(){showErrorMsg(me.getLang("loadconfigHttpError"))}})}catch(e){showErrorMsg(me.getLang("loadconfigError"))}});function showErrorMsg(e){console&&console.error(e)}};UE.Editor.prototype.isServerConfigLoaded=function(){var e=this;return e._serverConfigLoaded||false};UE.Editor.prototype.afterConfigReady=function(e){if(!e||!utils.isFunction(e))return;var t=this;var i=function(){e.apply(t,arguments);t.removeListener("serverConfigLoaded",i)};if(t.isServerConfigLoaded()){e.call(t,"serverConfigLoaded")}else{t.addListener("serverConfigLoaded",i)}}})();UE.ajax=function(){var t="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP");t="ActiveXObject('Msxml2.XMLHTTP')"}catch(e){try{new ActiveXObject("Microsoft.XMLHTTP");t="ActiveXObject('Microsoft.XMLHTTP')"}catch(e){}}var c=new Function("return new "+t);function p(e){var t=[];for(var i in e){if(i=="method"||i=="timeout"||i=="async"||i=="dataType"||i=="callback")continue;if(e[i]==undefined||e[i]==null)continue;if(!((typeof e[i]).toLowerCase()=="function"||(typeof e[i]).toLowerCase()=="object")){t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]))}else if(utils.isArray(e[i])){for(var n=0;n<e[i].length;n++){t.push(encodeURIComponent(i)+"[]="+encodeURIComponent(e[i][n]))}}}return t.join("&")}function i(e,t){var i=c(),n=false,o={method:"POST",timeout:5e3,async:true,data:{},onsuccess:function(){},onerror:function(){}};if(typeof e==="object"){t=e;e=t.url}if(!i||!e)return;var r=t?utils.extend(o,t):o;var a=p(r);if(!utils.isEmptyObject(r.data)){a+=(a?"&":"")+p(r.data)}var s=setTimeout(function(){if(i.readyState!=4){n=true;i.abort();clearTimeout(s)}},r.timeout);var l=r.method.toUpperCase();var d=e+(e.indexOf("?")==-1?"?":"&")+(l=="POST"?"":a+"&noCache="+ +new Date);i.open(l,d,r.async);i.onreadystatechange=function(){if(i.readyState==4){if(!n&&i.status==200){r.onsuccess(i)}else{r.onerror(i)}}};if(l=="POST"){i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");i.send(a)}else{i.send(null)}}function o(e,t){var i=t.onsuccess||function(){},n=document.createElement("SCRIPT"),o=t||{},r=o["charset"],a=o["jsonp"]||"callback",s,l=o["timeOut"]||0,d,c=new RegExp("(\\?|&)"+a+"=([^&]*)"),u;if(utils.isFunction(i)){s="bd__editor__"+Math.floor(Math.random()*2147483648).toString(36);window[s]=h(0)}else if(utils.isString(i)){s=i}else{if(u=c.exec(e)){s=u[2]}}e=e.replace(c,"$1"+a+"="+s);if(e.search(c)<0){e+=(e.indexOf("?")<0?"?":"&")+a+"="+s}var f=p(t);if(!utils.isEmptyObject(t.data)){f+=(f?"&":"")+p(t.data)}if(f){e=e.replace(/\?/,"?"+f+"&")}n.onerror=h(1);if(l){d=setTimeout(h(1),l)}m(n,e,r);function m(e,t,i){e.setAttribute("type","text/javascript");e.setAttribute("defer","defer");i&&e.setAttribute("charset",i);e.setAttribute("src",t);document.getElementsByTagName("head")[0].appendChild(e)}function h(e){return function(){try{if(e){o.onerror&&o.onerror()}else{try{clearTimeout(d);i.apply(window,arguments)}catch(e){}}}catch(e){o.onerror&&o.onerror.call(window,e)}finally{o.oncomplete&&o.oncomplete.apply(window,arguments);n.parentNode&&n.parentNode.removeChild(n);window[s]=null;try{delete window[s]}catch(e){}}}}}return{request:function(e,t){if(t&&t.dataType=="jsonp"){o(e,t)}else{i(e,t)}},getJSONP:function(e,t,i){var n={data:t,oncomplete:i};o(e,n)}}}();var filterWord=UE.filterWord=function(){function t(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/gi.test(e)}function u(e){e=e.replace(/[\d.]+\w+/g,function(e){return utils.transUnitToPx(e)});return e}function i(e){return e.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(browser.opera){return""}try{if(/Bitmap/i.test(e)){return""}var t=e.match(/width:([ \d.]*p[tx])/i)[1],i=e.match(/height:([ \d.]*p[tx])/i)[1],n=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+u(t)+'" height="'+u(i)+'" src="'+n+'" />'}catch(e){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,function(e,t,i,n){return t=="class"&&n=="MsoListParagraph"?e:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(e,t,i){return i.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,t,i,n){var o=[],r=n.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(e){return utils.transUnitToPx(e)}).split(/;\s*/g);for(var a=0,s;s=r[a];a++){var l,d,c=s.split(":");if(c.length==2){l=c[0].toLowerCase();d=c[1].toLowerCase();if(/^(background)\w*/.test(l)&&d.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(l)&&/^0\w+$/.test(d)){continue}switch(l){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":if(!/<table/.test(t))o[a]=l.replace(/^mso-|-alt$/g,"")+":"+u(d);continue;case"horiz-align":o[a]="text-align:"+d;continue;case"vert-align":o[a]="vertical-align:"+d;continue;case"font-color":case"mso-foreground":o[a]="color:"+d;continue;case"mso-background":case"mso-highlight":o[a]="background:"+d;continue;case"mso-default-height":o[a]="min-height:"+u(d);continue;case"mso-default-width":o[a]="min-width:"+u(d);continue;case"mso-padding-between-alt":o[a]="border-collapse:separate;border-spacing:"+u(d);continue;case"text-line-through":if(d=="single"||d=="double"){o[a]="text-decoration:line-through"}continue;case"mso-zero-height":if(d=="yes"){o[a]="display:none"}continue;case"margin":if(!/[1-9]/.test(d)){continue}}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(l)||/text\-indent|padding|margin/.test(l)&&/\-[\d.]+/.test(d)){continue}o[a]=l+":"+c[1]}}return t+(o.length?' style="'+o.join(";").replace(/;{2,}/g,";")+'"':"")})}return function(e){return t(e)?i(e):e}}();(function(){var o=UE.uNode=function(e){this.type=e.type;this.data=e.data;this.tagName=e.tagName;this.parentNode=e.parentNode;this.attrs=e.attrs||{};this.children=e.children};var d={href:1,src:1,_src:1,_href:1,cdata_data:1};var i={style:1,script:1};var n="    ",r="\n";function c(e,t,i){e.push(r);return t+(i?1:-1)}function u(e,t){for(var i=0;i<t;i++){e.push(n)}}o.createElement=function(e){if(/[<>]/.test(e)){return UE.htmlparser(e).children[0]}else{return new o({type:"element",children:[],tagName:e})}};o.createText=function(e,t){return new UE.uNode({type:"text",data:t?e:utils.unhtml(e||"")})};function f(e,t,i,n){switch(e.type){case"root":for(var o=0,r;r=e.children[o++];){if(i&&r.type=="element"&&!dtd.$inlineWithA[r.tagName]&&o>1){c(t,n,true);u(t,n)}f(r,t,i,n)}break;case"text":a(e,t);break;case"element":s(e,t,i,n);break;case"comment":l(e,t,i)}return t}function a(e,t){if(e.parentNode.tagName=="pre"){t.push(e.data)}else{t.push(i[e.parentNode.tagName]?utils.html(e.data):e.data.replace(/[ ]{2}/g," &nbsp;"))}}function s(e,t,i,n){var o="";if(e.attrs){o=[];var r=e.attrs;for(var a in r){o.push(a+(r[a]!==undefined?'="'+(d[a]?utils.html(r[a]).replace(/["]/g,function(e){return"&quot;"}):utils.unhtml(r[a]))+'"':""))}o=o.join(" ")}t.push("<"+e.tagName+(o?" "+o:"")+(dtd.$empty[e.tagName]?"/":"")+">");if(i&&!dtd.$inlineWithA[e.tagName]&&e.tagName!="pre"){if(e.children&&e.children.length){n=c(t,n,true);u(t,n)}}if(e.children&&e.children.length){for(var s=0,l;l=e.children[s++];){if(i&&l.type=="element"&&!dtd.$inlineWithA[l.tagName]&&s>1){c(t,n);u(t,n)}f(l,t,i,n)}}if(!dtd.$empty[e.tagName]){if(i&&!dtd.$inlineWithA[e.tagName]&&e.tagName!="pre"){if(e.children&&e.children.length){n=c(t,n);u(t,n)}}t.push("</"+e.tagName+">")}}function l(e,t){t.push("\x3c!--"+e.data+"--\x3e")}function m(e,t){var i;if(e.type=="element"&&e.getAttr("id")==t){return e}if(e.children&&e.children.length){for(var n=0,o;o=e.children[n++];){if(i=m(o,t)){return i}}}}function h(e,t,i){if(e.type=="element"&&e.tagName==t){i.push(e)}if(e.children&&e.children.length){for(var n=0,o;o=e.children[n++];){h(o,t,i)}}}function p(e,t){if(e.children&&e.children.length){for(var i=0,n;n=e.children[i];){p(n,t);if(n.parentNode){if(n.children&&n.children.length){t(n)}if(n.parentNode)i++}}}else{t(e)}}o.prototype={toHtml:function(e){var t=[];f(this,t,e,0);return t.join("")},innerHTML:function(e){if(this.type!="element"||dtd.$empty[this.tagName]){return this}if(utils.isString(e)){if(this.children){for(var t=0,i;i=this.children[t++];){i.parentNode=null}}this.children=[];var n=UE.htmlparser(e);for(var t=0,i;i=n.children[t++];){this.children.push(i);i.parentNode=this}return this}else{var n=new UE.uNode({type:"root",children:this.children});return n.toHtml()}},innerText:function(e,t){if(this.type!="element"||dtd.$empty[this.tagName]){return this}if(e){if(this.children){for(var i=0,n;n=this.children[i++];){n.parentNode=null}}this.children=[];this.appendChild(o.createText(e,t));return this}else{return this.toHtml().replace(/<[^>]+>/g,"")}},getData:function(){if(this.type=="element")return"";return this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){var e=this.parentNode;for(var t=0,i;i=e.children[t];t++){if(i===this){return t==0?null:e.children[t-1]}}},nextSibling:function(){var e=this.parentNode;for(var t=0,i;i=e.children[t++];){if(i===this){return e.children[t]}}},replaceChild:function(e,t){if(this.children){if(e.parentNode){e.parentNode.removeChild(e)}for(var i=0,n;n=this.children[i];i++){if(n===t){this.children.splice(i,1,e);t.parentNode=null;e.parentNode=this;return e}}}},appendChild:function(e){if(this.type=="root"||this.type=="element"&&!dtd.$empty[this.tagName]){if(!this.children){this.children=[]}if(e.parentNode){e.parentNode.removeChild(e)}for(var t=0,i;i=this.children[t];t++){if(i===e){this.children.splice(t,1);break}}this.children.push(e);e.parentNode=this;return e}},insertBefore:function(e,t){if(this.children){if(e.parentNode){e.parentNode.removeChild(e)}for(var i=0,n;n=this.children[i];i++){if(n===t){this.children.splice(i,0,e);e.parentNode=this;return e}}}},insertAfter:function(e,t){if(this.children){if(e.parentNode){e.parentNode.removeChild(e)}for(var i=0,n;n=this.children[i];i++){if(n===t){this.children.splice(i+1,0,e);e.parentNode=this;return e}}}},removeChild:function(e,t){if(this.children){for(var i=0,n;n=this.children[i];i++){if(n===e){this.children.splice(i,1);n.parentNode=null;if(t&&n.children&&n.children.length){for(var o=0,r;r=n.children[o];o++){this.children.splice(i+o,0,r);r.parentNode=this}}return n}}}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(!e){delete this.attrs;return}if(!this.attrs){this.attrs={}}if(utils.isObject(e)){for(var i in e){if(!e[i]){delete this.attrs[i]}else{this.attrs[i.toLowerCase()]=e[i]}}}else{if(!t){delete this.attrs[e]}else{this.attrs[e.toLowerCase()]=t}}},getIndex:function(){var e=this.parentNode;for(var t=0,i;i=e.children[t];t++){if(i===this){return t}}return-1},getNodeById:function(e){var t;if(this.children&&this.children.length){for(var i=0,n;n=this.children[i++];){if(t=m(n,e)){return t}}}},getNodesByTagName:function(e){e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");var n=[],o=this;utils.each(e,function(e){if(o.children&&o.children.length){for(var t=0,i;i=o.children[t++];){h(i,e,n)}}});return n},getStyle:function(e){var t=this.getAttr("style");if(!t){return""}var i=new RegExp("(^|;)\\s*"+e+":([^;]+)","i");var n=t.match(i);if(n&&n[0]){return n[2]}return""},setStyle:function(e,t){function i(e,t){var i=new RegExp("(^|;)\\s*"+e+":([^;]+;?)","gi");n=n.replace(i,"$1");if(t){n=e+":"+utils.unhtml(t)+";"+n}}var n=this.getAttr("style");if(!n){n=""}if(utils.isObject(e)){for(var o in e){i(o,e[o])}}else{i(e,t)}this.setAttr("style",utils.trim(n))},traversal:function(e){if(this.children&&this.children.length){p(this,e)}return this}}})();var htmlparser=UE.htmlparser=function(e,i){var t=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\/\s>]+)((?:\s+[\w\-:.]+(?:\s*=\s*?(?:(?:"[^"]*")|(?:'[^']*')|[^\s"'\/>]+))?)*)[\S\s]*?(\/?)>))/g,d=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g;var n={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(new RegExp(domUtils.fillChar,"g"),"");if(!i){e=e.replace(new RegExp("[\\r\\t\\n"+(i?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(i?"":" ")+"]*","g"),function(e,t){if(t&&n[t.toLowerCase()]){return e.replace(/(^[\n\r]+)|([\n\r]+$)/g,"")}return e.replace(new RegExp("^[\\r\\n"+(i?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(i?"":" ")+"]+$"),"")})}var c={href:1,src:1};var u=UE.uNode,f={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},o={ol:"li",ul:"li"};function r(e,t){if(o[e.tagName]){var i=u.createElement(o[e.tagName]);e.appendChild(i);i.appendChild(u.createText(t));e=i}else{e.appendChild(u.createText(t))}}function m(e,t,i){var n;if(n=f[t]){var o=e,r;while(o.type!="root"){if(utils.isArray(n)?utils.indexOf(n,o.tagName)!=-1:n==o.tagName){e=o;r=true;break}o=o.parentNode}if(!r){e=m(e,utils.isArray(n)?n[0]:n)}}var a=new u({parentNode:e,type:"element",tagName:t.toLowerCase(),children:dtd.$empty[t]?null:[]});if(i){var s={},l;while(l=d.exec(i)){s[l[1].toLowerCase()]=c[l[1].toLowerCase()]?l[2]||l[3]||l[4]:utils.unhtml(l[2]||l[3]||l[4])}a.attrs=s}e.children.push(a);return dtd.$empty[t]?e:a}function a(e,t){e.children.push(new u({type:"comment",data:t,parentNode:e}))}var s,l=0,h=0;var p=new u({type:"root",children:[]});var g=p;while(s=t.exec(e)){l=s.index;try{if(l>h){r(g,e.slice(h,l))}if(s[3]){if(dtd.$cdata[g.tagName]){r(g,s[0])}else{g=m(g,s[3].toLowerCase(),s[4])}}else if(s[1]){if(g.type!="root"){if(dtd.$cdata[g.tagName]&&!dtd.$cdata[s[1]]){r(g,s[0])}else{var v=g;while(g.type=="element"&&g.tagName!=s[1].toLowerCase()){g=g.parentNode;if(g.type=="root"){g=v;throw"break"}}g=g.parentNode}}}else if(s[2]){a(g,s[2])}}catch(e){}h=t.lastIndex}if(h<e.length){r(g,e.slice(h))}return p};var filterNode=UE.filterNode=function(){function f(i,e){switch(i.type){case"text":break;case"element":var t;if(t=e[i.tagName]){if(t==="-"){i.parentNode.removeChild(i)}else if(utils.isFunction(t)){var n=i.parentNode,o=i.getIndex();t(i);if(i.parentNode){if(i.children){for(var r=0,a;a=i.children[r];){f(a,e);if(a.parentNode){r++}}}}else{for(var r=o,a;a=n.children[r];){f(a,e);if(a.parentNode){r++}}}}else{var s=t["$"];if(s&&i.attrs){var l={},d;for(var c in s){d=i.getAttr(c);if(c=="style"&&utils.isArray(s[c])){var u=[];utils.each(s[c],function(e){var t;if(t=i.getStyle(e)){u.push(e+":"+t)}});d=u.join(";")}if(d){l[c]=d}}i.attrs=l}if(i.children){for(var r=0,a;a=i.children[r];){f(a,e);if(a.parentNode){r++}}}}}else{if(dtd.$cdata[i.tagName]){i.parentNode.removeChild(i)}else{var n=i.parentNode,o=i.getIndex();i.parentNode.removeChild(i,true);for(var r=o,a;a=n.children[r];){f(a,e);if(a.parentNode){r++}}}}break;case"comment":i.parentNode.removeChild(i)}}return function(e,t){if(utils.isEmptyObject(t)){return e}var i;if(i=t["-"]){utils.each(i.split(" "),function(e){t[e]="-"})}for(var n=0,o;o=e.children[n];){f(o,t);if(o.parentNode){n++}}return e}}();UE.plugin=function(){var o={};return{register:function(e,t,i,n){if(i&&utils.isFunction(i)){n=i;i=null}o[e]={optionName:i||e,execFn:t,afterDisabled:n}},load:function(i){utils.each(o,function(e){var t=e.execFn.call(i);if(i.options[e.optionName]!==false){if(t){utils.each(t,function(e,t){switch(t.toLowerCase()){case"shortcutkey":i.addshortcutkey(e);break;case"bindevents":utils.each(e,function(e,t){i.addListener(t,e)});break;case"bindmultievents":utils.each(utils.isArray(e)?e:[e],function(t){var e=utils.trim(t.type).split(/\s+/);utils.each(e,function(e){i.addListener(e,t.handler)})});break;case"commands":utils.each(e,function(e,t){i.commands[t]=e});break;case"outputrule":i.addOutputRule(e);break;case"inputrule":i.addInputRule(e);break;case"defaultoptions":i.setOpt(e)}})}}else if(e.afterDisabled){e.afterDisabled.call(i)}});utils.each(UE.plugins,function(e){e.call(i)})},run:function(e,t){var i=o[e];if(i){i.exeFn.call(t)}}}}();var keymap=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78};var LocalStorage=UE.LocalStorage=function(){var i=window.localStorage||e()||null,n="localStorage";return{saveLocalData:function(e,t){if(i&&t){i.setItem(e,t);return true}return false},getLocalData:function(e){if(i){return i.getItem(e)}return null},removeItem:function(e){i&&i.removeItem(e)}};function e(){var i=document.createElement("div");i.style.display="none";if(!i.addBehavior){return null}i.addBehavior("#default#userdata");return{getItem:function(e){var t=null;try{document.body.appendChild(i);i.load(n);t=i.getAttribute(e);document.body.removeChild(i)}catch(e){}return t},setItem:function(e,t){document.body.appendChild(i);i.setAttribute(e,t);i.save(n);document.body.removeChild(i)},removeItem:function(e){document.body.appendChild(i);i.removeAttribute(e);i.save(n);document.body.removeChild(i)}}}}();(function(){var o="ueditor_preference";UE.Editor.prototype.setPreferences=function(e,t){var i={};if(utils.isString(e)){i[e]=t}else{i=e}var n=LocalStorage.getLocalData(o);if(n&&(n=utils.str2json(n))){utils.extend(n,i)}else{n=i}n&&LocalStorage.saveLocalData(o,utils.json2str(n))};UE.Editor.prototype.getPreferences=function(e){var t=LocalStorage.getLocalData(o);if(t&&(t=utils.str2json(t))){return e?t[e]:t}return null};UE.Editor.prototype.removePreferences=function(e){var t=LocalStorage.getLocalData(o);if(t&&(t=utils.str2json(t))){t[e]=undefined;delete t[e]}t&&LocalStorage.saveLocalData(o,utils.json2str(t))}})();UE.plugins["defaultfilter"]=function(){var l=this;l.setOpt({allowDivTransToP:true,disabledTableInTable:true,rgb2Hex:true});l.addInputRule(function(e){var r=this.options.allowDivTransToP;var a;function s(e){while(e&&e.type=="element"){if(e.tagName=="td"){return true}e=e.parentNode}return false}e.traversal(function(o){if(o.type=="element"){if(!dtd.$cdata[o.tagName]&&l.options.autoClearEmptyNode&&dtd.$inline[o.tagName]&&!dtd.$empty[o.tagName]&&(!o.attrs||utils.isEmptyObject(o.attrs))){if(!o.firstChild())o.parentNode.removeChild(o);else if(o.tagName=="span"&&(!o.attrs||utils.isEmptyObject(o.attrs))){o.parentNode.removeChild(o,true)}return}switch(o.tagName){case"style":case"script":o.setAttr({cdata_tag:o.tagName,cdata_data:o.innerHTML()||"",_ue_custom_node_:"true"});o.tagName="div";o.innerHTML("");break;case"a":if(a=o.getAttr("href")){o.setAttr("_href",a)}break;case"img":if(a=o.getAttr("src")){if(/^data:/.test(a)){o.parentNode.removeChild(o);break}}o.setAttr("_src",o.getAttr("src"));break;case"span":if(browser.webkit&&(a=o.getStyle("white-space"))){if(/nowrap|normal/.test(a)){o.setStyle("white-space","");if(l.options.autoClearEmptyNode&&utils.isEmptyObject(o.attrs)){o.parentNode.removeChild(o,true)}}}a=o.getAttr("id");if(a&&/^_baidu_bookmark_/i.test(a)){o.parentNode.removeChild(o)}break;case"p":if(a=o.getAttr("align")){o.setAttr("align");o.setStyle("text-align",a)}utils.each(o.children,function(e){if(e.type=="element"&&e.tagName=="p"){var t=e.nextSibling();o.parentNode.insertAfter(e,o);var i=e;while(t){var n=t.nextSibling();o.parentNode.insertAfter(t,i);i=t;t=n}return false}});if(!o.firstChild()){o.innerHTML(browser.ie?"&nbsp;":"<br/>")}break;case"div":if(o.getAttr("cdata_tag")){break}a=o.getAttr("class");if(a&&/^line number\d+/.test(a)){break}if(!r){break}var e,t=UE.uNode.createElement("p");while(e=o.firstChild()){if(e.type=="text"||!UE.dom.dtd.$block[e.tagName]){t.appendChild(e)}else{if(t.firstChild()){o.parentNode.insertBefore(t,o);t=UE.uNode.createElement("p")}else{o.parentNode.insertBefore(e,o)}}}if(t.firstChild()){o.parentNode.insertBefore(t,o)}o.parentNode.removeChild(o);break;case"dl":o.tagName="ul";break;case"dt":case"dd":o.tagName="li";break;case"li":var i=o.getAttr("class");if(!i||!/list\-/.test(i)){o.setAttr()}var n=o.getNodesByTagName("ol ul");UE.utils.each(n,function(e){o.parentNode.insertAfter(e,o)});break;case"td":case"th":case"caption":if(!o.children||!o.children.length){o.appendChild(browser.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"))}break;case"table":if(l.options.disabledTableInTable&&s(o)){o.parentNode.insertBefore(UE.uNode.createText(o.innerText()),o);o.parentNode.removeChild(o)}}}})});l.addOutputRule(function(e){var i;e.traversal(function(e){if(e.type=="element"){if(l.options.autoClearEmptyNode&&dtd.$inline[e.tagName]&&!dtd.$empty[e.tagName]&&(!e.attrs||utils.isEmptyObject(e.attrs))){if(!e.firstChild())e.parentNode.removeChild(e);else if(e.tagName=="span"&&(!e.attrs||utils.isEmptyObject(e.attrs))){e.parentNode.removeChild(e,true)}return}switch(e.tagName){case"div":if(i=e.getAttr("cdata_tag")){e.tagName=i;e.appendChild(UE.uNode.createText(e.getAttr("cdata_data")));e.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""})}break;case"a":if(i=e.getAttr("_href")){e.setAttr({href:utils.html(i),_href:""})}break;break;case"span":i=e.getAttr("id");if(i&&/^_baidu_bookmark_/i.test(i)){e.parentNode.removeChild(e)}if(l.getOpt("rgb2Hex")){var t=e.getAttr("style");if(t){e.setAttr("style",t.replace(/rgba?\(([\d,\s]+)\)/g,function(e,t){var i=t.split(",");if(i.length>3)return"";t="#";for(var n=0,o;o=i[n++];){o=parseInt(o.replace(/[^\d]/gi,""),10).toString(16);t+=o.length==1?"0"+o:o}return t.toUpperCase()}))}}break;case"img":if(i=e.getAttr("_src")){e.setAttr({src:e.getAttr("_src"),_src:""})}}}})})};UE.commands["inserthtml"]={execCommand:function(e,t,i){var n=this,o,r;if(!t){return}if(n.fireEvent("beforeinserthtml",t)===true){return}o=n.selection.getRange();r=o.document.createElement("div");r.style.display="inline";if(!i){var a=UE.htmlparser(t);if(n.options.filterRules){UE.filterNode(a,n.options.filterRules)}n.filterInputRule(a);t=a.toHtml()}r.innerHTML=utils.trim(t);if(!o.collapsed){var s=o.startContainer;if(domUtils.isFillChar(s)){o.setStartBefore(s)}s=o.endContainer;if(domUtils.isFillChar(s)){o.setEndAfter(s)}o.txtToElmBoundary();if(o.endContainer&&o.endContainer.nodeType==1){s=o.endContainer.childNodes[o.endOffset];if(s&&domUtils.isBr(s)){o.setEndAfter(s)}}if(o.startOffset==0){s=o.startContainer;if(domUtils.isBoundaryNode(s,"firstChild")){s=o.endContainer;if(o.endOffset==(s.nodeType==3?s.nodeValue.length:s.childNodes.length)&&domUtils.isBoundaryNode(s,"lastChild")){n.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";o.setStart(n.body.firstChild,0).collapse(true)}}}!o.collapsed&&o.deleteContents();if(o.startContainer.nodeType==1){var l=o.startContainer.childNodes[o.startOffset],d;if(l&&domUtils.isBlockElm(l)&&(d=l.previousSibling)&&domUtils.isBlockElm(d)){o.setEnd(d,d.childNodes.length).collapse();while(l.firstChild){d.appendChild(l.firstChild)}domUtils.remove(l)}}}var l,c,d,u,f=0,m;if(o.inFillChar()){l=o.startContainer;if(domUtils.isFillChar(l)){o.setStartBefore(l).collapse(true);domUtils.remove(l)}else if(domUtils.isFillChar(l,true)){l.nodeValue=l.nodeValue.replace(fillCharReg,"");o.startOffset--;o.collapsed&&o.collapse(true)}}var h=domUtils.findParentByTagName(o.startContainer,"li",true);if(h){var p,g;while(l=r.firstChild){while(l&&(l.nodeType==3||!domUtils.isBlockElm(l)||l.tagName=="HR")){p=l.nextSibling;o.insertNode(l).collapse();g=l;l=p}if(l){if(/^(ol|ul)$/i.test(l.tagName)){while(l.firstChild){g=l.firstChild;domUtils.insertAfter(h,l.firstChild);h=h.nextSibling}domUtils.remove(l)}else{var v;p=l.nextSibling;v=n.document.createElement("li");domUtils.insertAfter(h,v);v.appendChild(l);g=l;l=p;h=v}}}h=domUtils.findParentByTagName(o.startContainer,"li",true);if(domUtils.isEmptyBlock(h)){domUtils.remove(h)}if(g){o.setStartAfter(g).collapse(true).select(true)}}else{while(l=r.firstChild){if(f){var b=n.document.createElement("p");while(l&&(l.nodeType==3||!dtd.$block[l.tagName])){m=l.nextSibling;b.appendChild(l);l=m}if(b.firstChild){l=b}}o.insertNode(l);m=l.nextSibling;if(!f&&l.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(l)){c=domUtils.findParent(l,function(e){return domUtils.isBlockElm(e)});if(c&&c.tagName.toLowerCase()!="body"&&!(dtd[c.tagName][l.nodeName]&&l.parentNode===c)){if(!dtd[c.tagName][l.nodeName]){d=c}else{u=l.parentNode;while(u!==c){d=u;u=u.parentNode}}domUtils.breakParent(l,d||u);var d=l.previousSibling;domUtils.trimWhiteTextNode(d);if(!d.childNodes.length){domUtils.remove(d)}if(!browser.ie&&(p=l.nextSibling)&&domUtils.isBlockElm(p)&&p.lastChild&&!domUtils.isBr(p.lastChild)){p.appendChild(n.document.createElement("br"))}f=1}}var p=l.nextSibling;if(!r.firstChild&&p&&domUtils.isBlockElm(p)){o.setStart(p,0).collapse(true);break}o.setEndAfter(l).collapse()}l=o.startContainer;if(m&&domUtils.isBr(m)){domUtils.remove(m)}if(domUtils.isBlockElm(l)&&domUtils.isEmptyNode(l)){if(m=l.nextSibling){domUtils.remove(l);if(m.nodeType==1&&dtd.$block[m.tagName]){o.setStart(m,0).collapse(true).shrinkBoundary()}}else{try{l.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}catch(e){o.setStartBefore(l);domUtils.remove(l)}}}try{o.select(true)}catch(e){}}setTimeout(function(){o=n.selection.getRange();o.scrollToView(n.autoHeightEnabled,n.autoHeightEnabled?domUtils.getXY(n.iframe).y:0);n.fireEvent("afterinserthtml",t)},200)}};UE.plugins["autotypeset"]=function(){this.setOpt({autotypeset:{mergeEmptyline:true,removeClass:true,removeEmptyline:false,textAlign:"left",imageBlockLine:"center",pasteFilter:false,clearFontSize:false,clearFontFamily:false,removeEmptyNode:false,removeTagNames:utils.extend({div:1},dtd.$removeEmpty),indent:false,indentValue:"2em",bdc2sb:false,tobdc:false}});var t=this,g=t.options.autotypeset,v={selectTdClass:1,pagebreak:1,anchorclass:1},b={li:1},i={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1},y;if(!g){return}n();function C(e,t){if(!e||e.nodeType==3)return 0;if(domUtils.isBr(e))return 1;if(e&&e.parentNode&&i[e.tagName.toLowerCase()]){if(y&&y.contains(e)||e.getAttribute("pagebreak")){return 0}return t?!domUtils.isEmptyBlock(e):domUtils.isEmptyBlock(e,new RegExp("[\\s"+domUtils.fillChar+"]","g"))}}function w(e){if(!e.style.cssText){domUtils.removeAttributes(e,["style"]);if(e.tagName.toLowerCase()=="span"&&domUtils.hasNoAttributes(e)){domUtils.remove(e,true)}}}function e(e,t){var i=this,n;if(t){if(!g.pasteFilter){return}n=i.document.createElement("div");n.innerHTML=t.html}else{n=i.document.body}var o=domUtils.getElementsByTagName(n,"*");for(var r=0,a;a=o[r++];){if(i.fireEvent("excludeNodeinautotype",a)===true){continue}if(g.clearFontSize&&a.style.fontSize){domUtils.removeStyle(a,"font-size");w(a)}if(g.clearFontFamily&&a.style.fontFamily){domUtils.removeStyle(a,"font-family");w(a)}if(C(a)){if(g.mergeEmptyline){var s=a.nextSibling,l,d=domUtils.isBr(a);while(C(s)){l=s;s=l.nextSibling;if(d&&(!s||s&&!domUtils.isBr(s))){break}domUtils.remove(l)}}if(g.removeEmptyline&&domUtils.inDoc(a,n)&&!b[a.parentNode.tagName.toLowerCase()]){if(domUtils.isBr(a)){s=a.nextSibling;if(s&&!domUtils.isBr(s)){continue}}domUtils.remove(a);continue}}if(C(a,true)&&a.tagName!="SPAN"){if(g.indent){a.style.textIndent=g.indentValue}if(g.textAlign){a.style.textAlign=g.textAlign}}if(g.removeClass&&a.className&&!v[a.className.toLowerCase()]){if(y&&y.contains(a)){continue}domUtils.removeAttributes(a,["class"])}if(g.imageBlockLine&&a.tagName.toLowerCase()=="img"&&!a.getAttribute("emotion")){if(t){var c=a;switch(g.imageBlockLine){case"left":case"right":case"none":var u=c.parentNode,l,f,s;while(dtd.$inline[u.tagName]||u.tagName=="A"){u=u.parentNode}l=u;if(l.tagName=="P"&&domUtils.getStyle(l,"text-align")=="center"){if(!domUtils.isBody(l)&&domUtils.getChildCount(l,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1){f=l.previousSibling;s=l.nextSibling;if(f&&s&&f.nodeType==1&&s.nodeType==1&&f.tagName==s.tagName&&domUtils.isBlockElm(f)){f.appendChild(l.firstChild);while(s.firstChild){f.appendChild(s.firstChild)}domUtils.remove(l);domUtils.remove(s)}else{domUtils.setStyle(l,"text-align","")}}}domUtils.setStyle(c,"float",g.imageBlockLine);break;case"center":if(i.queryCommandValue("imagefloat")!="center"){u=c.parentNode;domUtils.setStyle(c,"float","none");l=c;while(u&&domUtils.getChildCount(u,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1&&(dtd.$inline[u.tagName]||u.tagName=="A")){l=u;u=u.parentNode}var m=i.document.createElement("p");domUtils.setAttributes(m,{style:"text-align:center"});l.parentNode.insertBefore(m,l);m.appendChild(l);domUtils.setStyle(l,"float","")}}}else{var h=i.selection.getRange();h.selectNode(a).select();i.execCommand("imagefloat",g.imageBlockLine)}}if(g.removeEmptyNode){if(g.removeTagNames[a.tagName.toLowerCase()]&&domUtils.hasNoAttributes(a)&&domUtils.isEmptyBlock(a)){domUtils.remove(a)}}}if(g.tobdc){var p=UE.htmlparser(n.innerHTML);p.traversal(function(e){if(e.type=="text"){e.data=N(e.data)}});n.innerHTML=p.toHtml()}if(g.bdc2sb){var p=UE.htmlparser(n.innerHTML);p.traversal(function(e){if(e.type=="text"){e.data=x(e.data)}});n.innerHTML=p.toHtml()}if(t){t.html=n.innerHTML}}if(g.pasteFilter){t.addListener("beforepaste",e)}function x(e){var t="";for(var i=0;i<e.length;i++){var n=e.charCodeAt(i);if(n>=65281&&n<=65373){t+=String.fromCharCode(e.charCodeAt(i)-65248)}else if(n==12288){t+=String.fromCharCode(e.charCodeAt(i)-12288+32)}else{t+=e.charAt(i)}}return t}function N(e){e=utils.html(e);var t="";var i="";for(var n=0;n<e.length;n++){if(e.charCodeAt(n)==32){t=t+String.fromCharCode(12288)}else if(e.charCodeAt(n)<127){t=t+String.fromCharCode(e.charCodeAt(n)+65248)}else{t+=e.charAt(n)}}return t}function n(){var e=t.getPreferences("autotypeset");utils.extend(t.options.autotypeset,e)}t.commands["autotypeset"]={execCommand:function(){t.removeListener("beforepaste",e);if(g.pasteFilter){t.addListener("beforepaste",e)}e.call(t)}}};UE.plugin.register("autosubmit",function(){return{shortcutkey:{autosubmit:"ctrl+13"},commands:{autosubmit:{execCommand:function(){var e=this,t=domUtils.findParentByTagName(e.iframe,"form",false);if(t){if(e.fireEvent("beforesubmit")===false){return}e.sync();t.submit()}}}}}});UE.plugin.register("background",function(){var l=this,n="editor_background",i,o=new RegExp("body[\\s]*\\{(.+)\\}","i");function r(e){var n={},t=e.split(";");utils.each(t,function(e){var t=e.indexOf(":"),i=utils.trim(e.substr(0,t)).toLowerCase();i&&(n[i]=utils.trim(e.substr(t+1)||""))});return n}function a(e){if(e){var t=[];for(var i in e){if(e.hasOwnProperty(i)){t.push(i+":"+e[i]+"; ")}}utils.cssRule(n,t.length?"body{"+t.join("")+"}":"",l.document)}else{utils.cssRule(n,"",l.document)}}var e=l.hasContents;l.hasContents=function(){if(l.queryCommandValue("background")){return true}return e.apply(l,arguments)};return{bindEvents:{getAllHtml:function(e,t){var i=this.body,n=domUtils.getComputedStyle(i,"background-image"),o="";if(n.indexOf(l.options.imagePath)>0){o=n.substring(n.indexOf(l.options.imagePath),n.length-1).replace(/"|\(|\)/gi,"")}else{o=n!="none"?n.replace(/url\("?|"?\)/gi,""):""}var r='<style type="text/css">body{';var a={"background-color":domUtils.getComputedStyle(i,"background-color")||"#ffffff","background-image":o?"url("+o+")":"","background-repeat":domUtils.getComputedStyle(i,"background-repeat")||"","background-position":browser.ie?domUtils.getComputedStyle(i,"background-position-x")+" "+domUtils.getComputedStyle(i,"background-position-y"):domUtils.getComputedStyle(i,"background-position"),height:domUtils.getComputedStyle(i,"height")};for(var s in a){if(a.hasOwnProperty(s)){r+=s+":"+a[s]+"; "}}r+="}</style> ";t.push(r)},aftersetcontent:function(){if(i==false)a()}},inputRule:function(e){i=false;utils.each(e.getNodesByTagName("p"),function(e){var t=e.getAttr("data-background");if(t){i=true;a(r(t));e.parentNode.removeChild(e)}})},outputRule:function(e){var t=this,i=(utils.cssRule(n,t.document)||"").replace(/[\n\r]+/g,"").match(o);if(i){e.appendChild(UE.uNode.createElement('<p style="display:none;" data-background="'+utils.trim(i[1].replace(/"/g,"").replace(/[\s]+/g," "))+'"><br/></p>'))}},commands:{background:{execCommand:function(e,t){a(t)},queryCommandValue:function(){var e=this,t=(utils.cssRule(n,e.document)||"").replace(/[\n\r]+/g,"").match(o);return t?r(t[1]):null},notNeedUndo:true}}}});UE.commands["imagefloat"]={execCommand:function(e,t){var i=this,n=i.selection.getRange();if(!n.collapsed){var o=n.getClosedNode();if(o&&o.tagName=="IMG"){switch(t){case"left":case"right":case"none":var r=o.parentNode,a,s,l;while(dtd.$inline[r.tagName]||r.tagName=="A"){r=r.parentNode}a=r;if(a.tagName=="P"&&domUtils.getStyle(a,"text-align")=="center"){if(!domUtils.isBody(a)&&domUtils.getChildCount(a,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1){s=a.previousSibling;l=a.nextSibling;if(s&&l&&s.nodeType==1&&l.nodeType==1&&s.tagName==l.tagName&&domUtils.isBlockElm(s)){s.appendChild(a.firstChild);while(l.firstChild){s.appendChild(l.firstChild)}domUtils.remove(a);domUtils.remove(l)}else{domUtils.setStyle(a,"text-align","")}}n.selectNode(o).select()}domUtils.setStyle(o,"float",t=="none"?"":t);if(t=="none"){domUtils.removeAttributes(o,"align")}break;case"center":if(i.queryCommandValue("imagefloat")!="center"){var r=o.parentNode;domUtils.setStyle(o,"float","");domUtils.removeAttributes(o,"align");a=o;while(r&&domUtils.getChildCount(r,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1&&(dtd.$inline[r.tagName]||r.tagName=="A")){a=r;r=r.parentNode}n.setStartBefore(a).setCursor(false);r=i.document.createElement("div");r.appendChild(a);domUtils.setStyle(a,"float","");i.execCommand("insertHtml",'<p class="_img_parent_tmp" style="text-align:center">'+r.innerHTML+"</p>");a=i.document.getElementsByClassName("_img_parent_tmp")[0];a.removeAttribute("class");a=a.firstChild;n.selectNode(a).select();l=a.parentNode.nextSibling;if(l&&domUtils.isEmptyNode(l)){domUtils.remove(l)}}break}}}},queryCommandValue:function(){var e=this.selection.getRange(),t,i;if(e.collapsed){return"none"}t=e.getClosedNode();if(t&&t.nodeType==1&&t.tagName=="IMG"){i=domUtils.getComputedStyle(t,"float")||t.getAttribute("align");if(i=="none"){i=domUtils.getComputedStyle(t.parentNode,"text-align")=="center"?"center":i}return{left:1,right:1,center:1}[i]?i:"none"}return"none"},queryCommandState:function(){var e=this.selection.getRange(),t;if(e.collapsed)return-1;t=e.getClosedNode();if(t&&t.nodeType==1&&t.tagName=="IMG"){return 0}return-1}};UE.commands["insertimage"]={execCommand:function(e,t){t=utils.isArray(t)?t:[t];if(!t.length){return}var i=this,n=i.selection.getRange(),o=n.getClosedNode();if(i.fireEvent("beforeinsertimage",t)===true){return}if(o&&/img/i.test(o.tagName)&&(o.className!="edui-faked-video"||o.className.indexOf("edui-upload-video")!=-1)&&!o.getAttribute("word_img")){var r=t.shift();var a=r["floatStyle"];delete r["floatStyle"];domUtils.setAttributes(o,r);i.execCommand("imagefloat",a);if(t.length>0){n.setStartAfter(o).setCursor(false,true);i.execCommand("insertimage",t)}}else{var s=[],l="",d;d=t[0];if(t.length==1){l='<img src="'+d.src+'" '+(d._src?' _src="'+d._src+'" ':"")+(d.width?'width="'+d.width+'" ':"")+(d.height?' height="'+d.height+'" ':"")+(d["floatStyle"]=="left"||d["floatStyle"]=="right"?' style="float:'+d["floatStyle"]+';"':"")+(d.title&&d.title!=""?' title="'+d.title+'"':"")+(d.border&&d.border!="0"?' border="'+d.border+'"':"")+(d.alt&&d.alt!=""?' alt="'+d.alt+'"':"")+(d.hspace&&d.hspace!="0"?' hspace = "'+d.hspace+'"':"")+(d.vspace&&d.vspace!="0"?' vspace = "'+d.vspace+'"':"")+"/>";if(d["floatStyle"]=="center"){l='<p style="text-align: center">'+l+"</p>"}s.push(l)}else{for(var c=0;d=t[c++];){l="<p "+(d["floatStyle"]=="center"?'style="text-align: center" ':"")+'><img src="'+d.src+'" '+(d.width?'width="'+d.width+'" ':"")+(d._src?' _src="'+d._src+'" ':"")+(d.height?' height="'+d.height+'" ':"")+' style="'+(d["floatStyle"]&&d["floatStyle"]!="center"?"float:"+d["floatStyle"]+";":"")+(d.border||"")+'" '+(d.title?' title="'+d.title+'"':"")+" /></p>";s.push(l)}}i.execCommand("insertHtml",s.join(""))}i.fireEvent("afterinsertimage",t)}};UE.plugins["justify"]=function(){var e=this,u=domUtils.isBlockElm,i={left:1,right:1,center:1,justify:1},o=function(e,t){var i=e.createBookmark(),n=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)};e.enlarge(true);var o=e.createBookmark(),r=domUtils.getNextDomNode(o.start,false,n),a=e.cloneRange(),s;while(r&&!(domUtils.getPosition(r,o.end)&domUtils.POSITION_FOLLOWING)){if(r.nodeType==3||!u(r)){a.setStartBefore(r);while(r&&r!==o.end&&!u(r)){s=r;r=domUtils.getNextDomNode(r,false,null,function(e){return!u(e)})}a.setEndAfter(s);var l=a.getCommonAncestor();if(!domUtils.isBody(l)&&u(l)){domUtils.setStyles(l,utils.isString(t)?{"text-align":t}:t);r=l}else{var d=e.document.createElement("p");domUtils.setStyles(d,utils.isString(t)?{"text-align":t}:t);var c=a.extractContents();d.appendChild(c);a.insertNode(d);r=d}r=domUtils.getNextDomNode(r,false,n)}else{r=domUtils.getNextDomNode(r,true,n)}}return e.moveToBookmark(o).moveToBookmark(i)};UE.commands["justify"]={execCommand:function(e,t){var i=this.selection.getRange(),n;if(i.collapsed){n=this.document.createTextNode("p");i.insertNode(n)}o(i,t);if(n){i.setStartBefore(n).collapse(true);domUtils.remove(n)}i.select();return true},queryCommandValue:function(){var e=this.selection.getStart(),t=domUtils.getComputedStyle(e,"text-align");return i[t]?t:"left"},queryCommandState:function(){var e=this.selection.getStart(),t=e&&domUtils.findParentByTagName(e,["td","th","caption"],true);return t?-1:0}}};UE.plugins["font"]=function(){var e=this,t={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},d={underline:1,strikethrough:1,fontborder:1},a={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"};e.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});function s(e){var t;while(t=e.parentNode){if(t.tagName=="SPAN"&&domUtils.getChildCount(t,function(e){return!domUtils.isBookmarkNode(e)&&!domUtils.isBr(e)})==1){t.style.cssText+=e.style.cssText;domUtils.remove(e,true);e=t}else{break}}}function l(n,o,r){if(a[o]){n.adjustmentBoundary();if(!n.collapsed&&n.startContainer.nodeType==1){n.traversal(function(e){var t;if(domUtils.isTagNode(e,"span")){t=e}else{t=domUtils.getElementsByTagName(e,"span")[0]}if(t&&domUtils.isTagNode(t,"span")){var i=n.createBookmark();utils.each(domUtils.getElementsByTagName(t,"span"),function(e){if(!e.parentNode||domUtils.isBookmarkNode(e))return;if(o=="backcolor"&&domUtils.getComputedStyle(e,"background-color").toLowerCase()===r){return}domUtils.removeStyle(e,a[o]);if(e.style.cssText.replace(/^\s+$/,"").length==0){domUtils.remove(e,true)}});n.moveToBookmark(i)}})}}}function c(e,n,o){var t=e.collapsed,i=e.createBookmark(),r;if(t){r=i.start.parentNode;while(dtd.$inline[r.tagName]){r=r.parentNode}}else{r=domUtils.getCommonAncestor(i.start,i.end)}utils.each(domUtils.getElementsByTagName(r,"span"),function(e){if(!e.parentNode||domUtils.isBookmarkNode(e))return;if(/\s*border\s*:\s*none;?\s*/i.test(e.style.cssText)){if(/^\s*border\s*:\s*none;?\s*$/.test(e.style.cssText)){domUtils.remove(e,true)}else{domUtils.removeStyle(e,"border")}return}if(/border/i.test(e.style.cssText)&&e.parentNode.tagName=="SPAN"&&/border/i.test(e.parentNode.style.cssText)){e.style.cssText=e.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"")}if(!(n=="fontborder"&&o=="none")){var t=e.nextSibling;while(t&&t.nodeType==1&&t.tagName=="SPAN"){if(domUtils.isBookmarkNode(t)&&n=="fontborder"){e.appendChild(t);t=e.nextSibling;continue}if(t.style.cssText==e.style.cssText){domUtils.moveChild(t,e);domUtils.remove(t)}if(e.nextSibling===t)break;t=e.nextSibling}}s(e);if(browser.ie&&browser.version>8){var i=domUtils.findParent(e,function(e){return e.tagName=="SPAN"&&/background-color/.test(e.style.cssText)});if(i&&!/background-color/.test(e.style.cssText)){e.style.backgroundColor=i.style.backgroundColor}}});e.moveToBookmark(i);l(e,n,o)}e.addInputRule(function(e){utils.each(e.getNodesByTagName("u s del font strike"),function(e){if(e.tagName=="font"){var t=[];for(var i in e.attrs){switch(i){case"size":t.push("font-size:"+({1:"10",2:"12",3:"16",4:"18",5:"24",6:"32",7:"48"}[e.attrs[i]]||e.attrs[i])+"px");break;case"color":t.push("color:"+e.attrs[i]);break;case"face":t.push("font-family:"+e.attrs[i]);break;case"style":t.push(e.attrs[i])}}e.attrs={style:t.join(";")}}else{var n=e.tagName=="u"?"underline":"line-through";e.attrs={style:(e.getAttr("style")||"")+"text-decoration:"+n+";"}}e.tagName="span"})});for(var i in t){(function(s,l){UE.commands[s]={execCommand:function(e,t){t=t||(this.queryCommandState(e)?"none":e=="underline"?"underline":e=="fontborder"?"1px solid #000":"line-through");var i=this,n=this.selection.getRange(),o;if(t=="default"){if(n.collapsed){o=i.document.createTextNode("font");n.insertNode(o).select()}i.execCommand("removeFormat","span,a",l);if(o){n.setStartBefore(o).collapse(true);domUtils.remove(o)}c(n,e,t);n.select()}else{if(!n.collapsed){if(d[s]&&i.queryCommandValue(s)){i.execCommand("removeFormat","span,a",l)}n=i.selection.getRange();n.applyInlineStyle("span",{style:l+":"+t});c(n,e,t);n.select()}else{var r=domUtils.findParentByTagName(n.startContainer,"span",true);o=i.document.createTextNode("font");if(r&&!r.children.length&&!r[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){n.insertNode(o);if(d[s]){n.selectNode(o).select();i.execCommand("removeFormat","span,a",l,null);r=domUtils.findParentByTagName(o,"span",true);n.setStartBefore(o)}r&&(r.style.cssText+=";"+l+":"+t);n.collapse(true).select()}else{n.insertNode(o);n.selectNode(o).select();r=n.document.createElement("span");if(d[s]){if(domUtils.findParentByTagName(o,"a",true)){n.setStartBefore(o).setCursor();domUtils.remove(o);return}i.execCommand("removeFormat","span,a",l)}r.style.cssText=l+":"+t;o.parentNode.insertBefore(r,o);if(!browser.ie||browser.ie&&browser.version==9){var a=r.parentNode;while(!domUtils.isBlockElm(a)){if(a.tagName=="SPAN"){r.style.cssText=a.style.cssText+";"+r.style.cssText}a=a.parentNode}}if(opera){setTimeout(function(){n.setStart(r,0).collapse(true);c(n,e,t);n.select()})}else{n.setStart(r,0).collapse(true);c(n,e,t);n.select()}}domUtils.remove(o)}}return true},queryCommandValue:function(e){var t=this.selection.getStart();if(e=="underline"||e=="strikethrough"){var i=t,n;while(i&&!domUtils.isBlockElm(i)&&!domUtils.isBody(i)){if(i.nodeType==1){n=domUtils.getComputedStyle(i,l);if(n!="none"){return n}}i=i.parentNode}return"none"}if(e=="fontborder"){var o=t,r;while(o&&dtd.$inline[o.tagName]){if(r=domUtils.getComputedStyle(o,"border")){if(/1px/.test(r)&&/solid/.test(r)){return r}}o=o.parentNode}return""}if(e=="FontSize"){var a=domUtils.getComputedStyle(t,l),o=/^([\d\.]+)(\w+)$/.exec(a);if(o){return Math.floor(o[1])+o[2]}return a}return domUtils.getComputedStyle(t,l)},queryCommandState:function(e){if(!d[e])return 0;var t=this.queryCommandValue(e);if(e=="fontborder"){return/1px/.test(t)&&/solid/.test(t)}else{return e=="underline"?/underline/.test(t):/line\-through/.test(t)}}}})(i,t[i])}};UE.plugins["link"]=function(){function l(e){var t=e.startContainer,i=e.endContainer;if(t=domUtils.findParentByTagName(t,"a",true)){e.setStartBefore(t)}if(i=domUtils.findParentByTagName(i,"a",true)){e.setEndAfter(i)}}UE.commands["unlink"]={execCommand:function(){var e=this.selection.getRange(),t;if(e.collapsed&&!domUtils.findParentByTagName(e.startContainer,"a",true)){return}t=e.createBookmark();l(e);e.removeInlineStyle("a").moveToBookmark(t).select()},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}};function n(e,t,i){var n=e.cloneRange(),o=i.queryCommandValue("link");l(e=e.adjustmentBoundary());var r=e.startContainer;if(r.nodeType==1&&o){r=r.childNodes[e.startOffset];if(r&&r.nodeType==1&&r.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(r[browser.ie?"innerText":"textContent"])){r[browser.ie?"innerText":"textContent"]=utils.html(t.textValue||t.href)}}if(!n.collapsed||o){e.removeInlineStyle("a");n=e.cloneRange()}if(n.collapsed){var a=e.document.createElement("a"),s="";if(t.textValue){s=utils.html(t.textValue);delete t.textValue}else{s=utils.html(t.href)}domUtils.setAttributes(a,t);r=domUtils.findParentByTagName(n.startContainer,"a",true);if(r&&domUtils.isInNodeEndBoundary(n,r)){e.setStartAfter(r).collapse(true)}a[browser.ie?"innerText":"textContent"]=s;e.insertNode(a).selectNode(a)}else{e.applyInlineStyle("a",t)}}UE.commands["link"]={execCommand:function(e,t){var i;t._href&&(t._href=utils.unhtml(t._href,/[<">]/g));t.href&&(t.href=utils.unhtml(t.href,/[<">]/g));t.textValue&&(t.textValue=utils.unhtml(t.textValue,/[<">]/g));n(i=this.selection.getRange(),t,this);i.collapse().select(true)},queryCommandValue:function(){var e=this.selection.getRange(),t;if(e.collapsed){t=e.startContainer;t=t.nodeType==1?t:t.parentNode;if(t&&(t=domUtils.findParentByTagName(t,"a",true))&&!domUtils.isInNodeEndBoundary(e,t)){return t}}else{e.shrinkBoundary();var i=e.startContainer.nodeType==3||!e.startContainer.childNodes[e.startOffset]?e.startContainer:e.startContainer.childNodes[e.startOffset],n=e.endContainer.nodeType==3||e.endOffset==0?e.endContainer:e.endContainer.childNodes[e.endOffset-1],o=e.getCommonAncestor();t=domUtils.findParentByTagName(o,"a",true);if(!t&&o.nodeType==1){var r=o.getElementsByTagName("a"),a,s;for(var l=0,d;d=r[l++];){a=domUtils.getPosition(d,i),s=domUtils.getPosition(d,n);if((a&domUtils.POSITION_FOLLOWING||a&domUtils.POSITION_CONTAINS)&&(s&domUtils.POSITION_PRECEDING||s&domUtils.POSITION_CONTAINS)){t=d;break}}}return t}},queryCommandState:function(){var e=this.selection.getRange().getClosedNode(),t=e&&(e.className=="edui-faked-video"||e.className.indexOf("edui-upload-video")!=-1);return t?-1:0}}};UE.plugins["insertframe"]=function(){var e=this;function t(){e._iframe&&delete e._iframe}e.addListener("selectionchange",function(){t()})};UE.commands["scrawl"]={queryCommandState:function(){return browser.ie&&browser.version<=8?-1:0}};UE.plugins["removeformat"]=function(){var e=this;e.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});e.commands["removeformat"]={execCommand:function(e,t,d,i,c){var u=new RegExp("^(?:"+(t||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),f=d?[]:(i||this.options.removeFormatAttributes).split(","),n=new dom.Range(this.document),m,o,h,p=function(e){return e.nodeType==1};function g(e){if(e.nodeType==3||e.tagName.toLowerCase()!="span"){return 0}if(browser.ie){var t=e.attributes;if(t.length){for(var i=0,n=t.length;i<n;i++){if(t[i].specified){return 0}}return 1}}return!e.attributes.length}function r(e){var t=e.createBookmark();if(e.collapsed){e.enlarge(true)}if(!c){var i=domUtils.findParentByTagName(e.startContainer,"a",true);if(i){e.setStartBefore(i)}i=domUtils.findParentByTagName(e.endContainer,"a",true);if(i){e.setEndAfter(i)}}m=e.createBookmark();a=m.start;while((h=a.parentNode)&&!domUtils.isBlockElm(h)){domUtils.breakParent(a,h);domUtils.clearEmptySibling(a)}if(m.end){a=m.end;while((h=a.parentNode)&&!domUtils.isBlockElm(h)){domUtils.breakParent(a,h);domUtils.clearEmptySibling(a)}var n=domUtils.getNextDomNode(m.start,false,p),o;while(n){if(n==m.end){break}o=domUtils.getNextDomNode(n,true,p);if(!dtd.$empty[n.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(n)){if(u.test(n.tagName)){if(d){domUtils.removeStyle(n,d);if(g(n)&&d!="text-decoration"){domUtils.remove(n,true)}}else{domUtils.remove(n,true)}}else{if(!dtd.$tableContent[n.tagName]&&!dtd.$list[n.tagName]){domUtils.removeAttributes(n,f);if(g(n)){domUtils.remove(n,true)}}}}n=o}}var r=m.start.parentNode;if(domUtils.isBlockElm(r)&&!dtd.$tableContent[r.tagName]&&!dtd.$list[r.tagName]){domUtils.removeAttributes(r,f)}r=m.end.parentNode;if(m.end&&domUtils.isBlockElm(r)&&!dtd.$tableContent[r.tagName]&&!dtd.$list[r.tagName]){domUtils.removeAttributes(r,f)}e.moveToBookmark(m).moveToBookmark(t);var a=e.startContainer,s,l=e.collapsed;while(a.nodeType==1&&domUtils.isEmptyNode(a)&&dtd.$removeEmpty[a.tagName]){s=a.parentNode;e.setStartBefore(a);if(e.startContainer===e.endContainer){e.endOffset--}domUtils.remove(a);a=s}if(!l){a=e.endContainer;while(a.nodeType==1&&domUtils.isEmptyNode(a)&&dtd.$removeEmpty[a.tagName]){s=a.parentNode;e.setEndBefore(a);domUtils.remove(a);a=s}}}n=this.selection.getRange();r(n);n.select()}}};UE.plugins["blockquote"]=function(){var e=this;function y(e){return domUtils.filterNodeList(e.selection.getStartElementPath(),"blockquote")}e.commands["blockquote"]={execCommand:function(e,t){var i=this.selection.getRange(),n=y(this),o=dtd.blockquote,r=i.createBookmark();if(n){var a=i.startContainer,s=domUtils.isBlockElm(a)?a:domUtils.findParent(a,function(e){return domUtils.isBlockElm(e)}),l=i.endContainer,d=domUtils.isBlockElm(l)?l:domUtils.findParent(l,function(e){return domUtils.isBlockElm(e)});s=domUtils.findParentByTagName(s,"li",true)||s;d=domUtils.findParentByTagName(d,"li",true)||d;if(s.tagName=="LI"||s.tagName=="TD"||s===n||domUtils.isBody(s)){domUtils.remove(n,true)}else{domUtils.breakParent(s,n)}if(s!==d){n=domUtils.findParentByTagName(d,"blockquote");if(n){if(d.tagName=="LI"||d.tagName=="TD"||domUtils.isBody(d)){n.parentNode&&domUtils.remove(n,true)}else{domUtils.breakParent(d,n)}}}var c=domUtils.getElementsByTagName(this.document,"blockquote");for(var u=0,f;f=c[u++];){if(!f.childNodes.length){domUtils.remove(f)}else if(domUtils.getPosition(f,s)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(f,d)&domUtils.POSITION_PRECEDING){domUtils.remove(f,true)}}}else{var m=i.cloneRange(),h=m.startContainer.nodeType==1?m.startContainer:m.startContainer.parentNode,p=h,g=1;while(1){if(domUtils.isBody(h)){if(p!==h){if(i.collapsed){m.selectNode(p);g=0}else{m.setStartBefore(p)}}else{m.setStart(h,0)}break}if(!o[h.tagName]){if(i.collapsed){m.selectNode(p)}else{m.setStartBefore(p)}break}p=h;h=h.parentNode}if(g){p=h=h=m.endContainer.nodeType==1?m.endContainer:m.endContainer.parentNode;while(1){if(domUtils.isBody(h)){if(p!==h){m.setEndAfter(p)}else{m.setEnd(h,h.childNodes.length)}break}if(!o[h.tagName]){m.setEndAfter(p);break}p=h;h=h.parentNode}}h=i.document.createElement("blockquote");domUtils.setAttributes(h,t);h.appendChild(m.extractContents());m.insertNode(h);var v=domUtils.getElementsByTagName(h,"blockquote");for(var u=0,b;b=v[u++];){if(b.parentNode){domUtils.remove(b,true)}}}i.moveToBookmark(r).select()},queryCommandState:function(){return y(this)?1:0}}};UE.commands["touppercase"]=UE.commands["tolowercase"]={execCommand:function(e){var t=this;var i=t.selection.getRange();if(i.collapsed){return i}var n=i.createBookmark(),o=n.end,r=function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)},a=domUtils.getNextDomNode(n.start,false,r);while(a&&domUtils.getPosition(a,o)&domUtils.POSITION_PRECEDING){if(a.nodeType==3){a.nodeValue=a.nodeValue[e=="touppercase"?"toUpperCase":"toLowerCase"]()}a=domUtils.getNextDomNode(a,true,r);if(a===o){break}}i.moveToBookmark(n).select()}};UE.commands["indent"]={execCommand:function(){var e=this,t=e.queryCommandState("indent")?"0em":e.options.indentValue||"2em";e.execCommand("Paragraph","p",{style:"text-indent:"+t})},queryCommandState:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e&&e.style.textIndent&&parseInt(e.style.textIndent)?1:0}};UE.commands["print"]={execCommand:function(){this.window.print()},notNeedUndo:1};UE.commands["preview"]={execCommand:function(){var e=window.open("","_blank",""),t=e.document;t.open();t.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+'neditor.parse.js"><\/script><script>'+"setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)"+"<\/script></head><body><div>"+this.getContent(null,null,true)+"</div></body></html>");t.close()},notNeedUndo:1};UE.plugins["selectall"]=function(){var e=this;e.commands["selectall"]={execCommand:function(){var e=this,t=e.body,i=e.selection.getRange();i.selectNodeContents(t);if(domUtils.isEmptyBlock(t)){if(browser.opera&&t.firstChild&&t.firstChild.nodeType==1){i.setStartAtFirst(t.firstChild)}i.collapse(true)}i.select(true)},notNeedUndo:1};e.addshortcutkey({selectAll:"ctrl+65"})};UE.plugins["paragraph"]=function(){var e=this,f=domUtils.isBlockElm,m=["TD","LI","PRE"],l=function(e,t,i,n){var o=e.createBookmark(),r=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)},a;e.enlarge(true);var s=e.createBookmark(),l=domUtils.getNextDomNode(s.start,false,r),d=e.cloneRange(),c;while(l&&!(domUtils.getPosition(l,s.end)&domUtils.POSITION_FOLLOWING)){if(l.nodeType==3||!f(l)){d.setStartBefore(l);while(l&&l!==s.end&&!f(l)){c=l;l=domUtils.getNextDomNode(l,false,null,function(e){return!f(e)})}d.setEndAfter(c);a=e.document.createElement(t);if(i){domUtils.setAttributes(a,i);if(n&&n=="customstyle"&&i.style){a.style.cssText=i.style}}a.appendChild(d.extractContents());if(domUtils.isEmptyNode(a)){domUtils.fillChar(e.document,a)}d.insertNode(a);var u=a.parentNode;if(f(u)&&!domUtils.isBody(a.parentNode)&&utils.indexOf(m,u.tagName)==-1){if(!(n&&n=="customstyle")){u.getAttribute("dir")&&a.setAttribute("dir",u.getAttribute("dir"));u.style.cssText&&(a.style.cssText=u.style.cssText+";"+a.style.cssText);u.style.textAlign&&!a.style.textAlign&&(a.style.textAlign=u.style.textAlign);u.style.textIndent&&!a.style.textIndent&&(a.style.textIndent=u.style.textIndent);u.style.padding&&!a.style.padding&&(a.style.padding=u.style.padding)}if(i&&/h\d/i.test(u.tagName)&&!/h\d/i.test(a.tagName)){domUtils.setAttributes(u,i);if(n&&n=="customstyle"&&i.style){u.style.cssText=i.style}domUtils.remove(a.parentNode,true);a=u}else{domUtils.remove(a.parentNode,true)}}if(utils.indexOf(m,u.tagName)!=-1){l=u}else{l=a}l=domUtils.getNextDomNode(l,false,r)}else{l=domUtils.getNextDomNode(l,true,r)}}return e.moveToBookmark(s).moveToBookmark(o)};e.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""});e.commands["paragraph"]={execCommand:function(e,t,i,n){var o=this.selection.getRange();if(o.collapsed){var r=this.document.createTextNode("p");o.insertNode(r);if(browser.ie){var a=r.previousSibling;if(a&&domUtils.isWhitespace(a)){domUtils.remove(a)}a=r.nextSibling;if(a&&domUtils.isWhitespace(a)){domUtils.remove(a)}}}o=l(o,t,i,n);if(r){o.setStartBefore(r).collapse(true);pN=r.parentNode;domUtils.remove(r);if(domUtils.isBlockElm(pN)&&domUtils.isEmptyNode(pN)){domUtils.fillNode(this.document,pN)}}if(browser.gecko&&o.collapsed&&o.startContainer.nodeType==1){var s=o.startContainer.childNodes[o.startOffset];if(s&&s.nodeType==1&&s.tagName.toLowerCase()==t){o.setStart(s,0).collapse(true)}}o.select();return true},queryCommandValue:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e?e.tagName.toLowerCase():""}}};(function(){var m=domUtils.isBlockElm,h=function(e){return domUtils.filterNodeList(e.selection.getStartElementPath(),function(e){return e&&e.nodeType==1&&e.getAttribute("dir")})},o=function(e,t,i){var n,o=function(e){return e.nodeType==1?!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)},r=h(t);if(r&&e.collapsed){r.setAttribute("dir",i);return e}n=e.createBookmark();e.enlarge(true);var a=e.createBookmark(),s=domUtils.getNextDomNode(a.start,false,o),l=e.cloneRange(),d;while(s&&!(domUtils.getPosition(s,a.end)&domUtils.POSITION_FOLLOWING)){if(s.nodeType==3||!m(s)){l.setStartBefore(s);while(s&&s!==a.end&&!m(s)){d=s;s=domUtils.getNextDomNode(s,false,null,function(e){return!m(e)})}l.setEndAfter(d);var c=l.getCommonAncestor();if(!domUtils.isBody(c)&&m(c)){c.setAttribute("dir",i);s=c}else{var u=e.document.createElement("p");u.setAttribute("dir",i);var f=l.extractContents();u.appendChild(f);l.insertNode(u);s=u}s=domUtils.getNextDomNode(s,false,o)}else{s=domUtils.getNextDomNode(s,true,o)}}return e.moveToBookmark(a).moveToBookmark(n)};UE.commands["directionality"]={execCommand:function(e,t){var i=this.selection.getRange();if(i.collapsed){var n=this.document.createTextNode("d");i.insertNode(n)}o(i,this,t);if(n){i.setStartBefore(n).collapse(true);domUtils.remove(n)}i.select();return true},queryCommandValue:function(){var e=h(this);return e?e.getAttribute("dir"):"ltr"}}})();UE.plugins["horizontal"]=function(){var e=this;e.commands["horizontal"]={execCommand:function(e){var t=this;if(t.queryCommandState(e)!==-1){t.execCommand("insertHtml","<hr>");var i=t.selection.getRange(),n=i.startContainer;if(n.nodeType==1&&!n.childNodes[i.startOffset]){var o;if(o=n.childNodes[i.startOffset-1]){if(o.nodeType==1&&o.tagName=="HR"){if(t.options.enterTag=="p"){o=t.document.createElement("p");i.insertNode(o);i.setStart(o,0).setCursor()}else{o=t.document.createElement("br");i.insertNode(o);i.setStartBefore(o).setCursor()}}}}return true}},queryCommandState:function(){return domUtils.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}};e.addListener("delkeydown",function(e,t){var i=this.selection.getRange();i.txtToElmBoundary(true);if(domUtils.isStartInblock(i)){var n=i.startContainer;var o=n.previousSibling;if(o&&domUtils.isTagNode(o,"hr")){domUtils.remove(o);i.select();domUtils.preventDefault(t);return true}}})};UE.commands["time"]=UE.commands["date"]={execCommand:function(e,t){var i=new Date;function n(e,t){var i=("0"+e.getHours()).slice(-2),n=("0"+e.getMinutes()).slice(-2),o=("0"+e.getSeconds()).slice(-2);t=t||"hh:ii:ss";return t.replace(/hh/gi,i).replace(/ii/gi,n).replace(/ss/gi,o)}function o(e,t){var i=("000"+e.getFullYear()).slice(-4),n=i.slice(-2),o=("0"+(e.getMonth()+1)).slice(-2),r=("0"+e.getDate()).slice(-2);t=t||"yyyy-mm-dd";return t.replace(/yyyy/gi,i).replace(/yy/gi,n).replace(/mm/gi,o).replace(/dd/gi,r)}this.execCommand("insertHtml",e=="time"?n(i,t):o(i,t))}};UE.plugins["rowspacing"]=function(){var e=this;e.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]});e.commands["rowspacing"]={execCommand:function(e,t,i){this.execCommand("paragraph","p",{style:"margin-"+i+":"+t+"px"});return true},queryCommandValue:function(e,t){var i=domUtils.filterNodeList(this.selection.getStartElementPath(),function(e){return domUtils.isBlockElm(e)}),n;if(i){n=domUtils.getComputedStyle(i,"margin-"+t).replace(/[^\d]/g,"");return!n?0:n}return 0}}};UE.plugins["lineheight"]=function(){var e=this;e.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]});e.commands["lineheight"]={execCommand:function(e,t){this.execCommand("paragraph","p",{style:"line-height:"+(t=="1"?"normal":t+"em")});return true},queryCommandValue:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),function(e){return domUtils.isBlockElm(e)});if(e){var t=domUtils.getComputedStyle(e,"line-height");return t=="normal"?1:t.replace(/[^\d.]*/gi,"")}}}};UE.plugins["insertcode"]=function(){var u=this;u.ready(function(){utils.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}",u.document)});u.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"});u.commands["insertcode"]={execCommand:function(e,t){var i=this,n=i.selection.getRange(),o=domUtils.findParentByTagName(n.startContainer,"pre",true);if(o){o.className="brush:"+t+";toolbar:false;"}else{var r="";if(n.collapsed){r=browser.ie&&browser.ie11below?browser.version<=8?"&nbsp;":"":"<br/>"}else{var a=n.extractContents();var s=i.document.createElement("div");s.appendChild(a);utils.each(UE.filterNode(UE.htmlparser(s.innerHTML.replace(/[\r\t]/g,"")),i.options.filterTxtRules).children,function(t){if(browser.ie&&browser.ie11below&&browser.version>8){if(t.type=="element"){if(t.tagName=="br"){r+="\n"}else if(!dtd.$empty[t.tagName]){utils.each(t.children,function(e){if(e.type=="element"){if(e.tagName=="br"){r+="\n"}else if(!dtd.$empty[t.tagName]){r+=e.innerText()}}else{r+=e.data}});if(!/\n$/.test(r)){r+="\n"}}}else{r+=t.data+"\n"}if(!t.nextSibling()&&/\n$/.test(r)){r=r.replace(/\n$/,"")}}else{if(browser.ie&&browser.ie11below){if(t.type=="element"){if(t.tagName=="br"){r+="<br>"}else if(!dtd.$empty[t.tagName]){utils.each(t.children,function(e){if(e.type=="element"){if(e.tagName=="br"){r+="<br>"}else if(!dtd.$empty[t.tagName]){r+=e.innerText()}}else{r+=e.data}});if(!/br>$/.test(r)){r+="<br>"}}}else{r+=t.data+"<br>"}if(!t.nextSibling()&&/<br>$/.test(r)){r=r.replace(/<br>$/,"")}}else{r+=t.type=="element"?dtd.$empty[t.tagName]?"":t.innerText():t.data;if(!/br\/?\s*>$/.test(r)){if(!t.nextSibling())return;r+="<br>"}}}})}i.execCommand("inserthtml",'<pre id="coder"class="brush:'+t+';toolbar:false">'+r+"</pre>",true);o=i.document.getElementById("coder");domUtils.removeAttributes(o,"id");var l=o.previousSibling;if(l&&(l.nodeType==3&&l.nodeValue.length==1&&browser.ie&&browser.version==6||domUtils.isEmptyBlock(l))){domUtils.remove(l)}var n=i.selection.getRange();if(domUtils.isEmptyBlock(o)){n.setStart(o,0).setCursor(false,true)}else{n.selectNodeContents(o).select()}}},queryCommandValue:function(){var e=this.selection.getStartElementPath();var i="";utils.each(e,function(e){if(e.nodeName=="PRE"){var t=e.className.match(/brush:([^;]+)/);i=t&&t[1]?t[1]:"";return false}});return i}};u.addInputRule(function(e){utils.each(e.getNodesByTagName("pre"),function(t){var e=t.getNodesByTagName("br");if(e.length){browser.ie&&browser.ie11below&&browser.version>8&&utils.each(e,function(e){var t=UE.uNode.createText("\n");e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e)});return}if(browser.ie&&browser.ie11below&&browser.version>8)return;var i=t.innerText().split(/\n/);t.innerHTML("");utils.each(i,function(e){if(e.length){t.appendChild(UE.uNode.createText(e))}t.appendChild(UE.uNode.createElement("br"))})})});u.addOutputRule(function(e){utils.each(e.getNodesByTagName("pre"),function(e){var t="";utils.each(e.children,function(e){if(e.type=="text"){t+=e.data.replace(/[ ]/g,"&nbsp;").replace(/\n$/,"")}else{if(e.tagName=="br"){t+="\n"}else{t+=!dtd.$empty[e.tagName]?"":e.innerText()}}});e.innerText(t.replace(/(&nbsp;|\n)+$/,""))})});u.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,insertcode:1,inserthtml:1,selectall:1};var e=u.queryCommandState;u.queryCommandState=function(e){var t=this;if(!t.notNeedCodeQuery[e.toLowerCase()]&&t.selection&&t.queryCommandValue("insertcode")){return-1}return UE.Editor.prototype.queryCommandState.apply(this,arguments)};u.addListener("beforeenterkeydown",function(){var e=u.selection.getRange();var t=domUtils.findParentByTagName(e.startContainer,"pre",true);if(t){u.fireEvent("saveScene");if(!e.collapsed){e.deleteContents()}if(!browser.ie||browser.ie9above){var i=u.document.createElement("br"),t;e.insertNode(i).setStartAfter(i).collapse(true);var n=i.nextSibling;if(!n&&(!browser.ie||browser.version>10)){e.insertNode(i.cloneNode(false))}else{e.setStartAfter(i)}t=i.previousSibling;var o;while(t){o=t;t=t.previousSibling;if(!t||t.nodeName=="BR"){t=o;break}}if(t){var r="";while(t&&t.nodeName!="BR"&&new RegExp("^[\\s"+domUtils.fillChar+"]*$").test(t.nodeValue)){r+=t.nodeValue;t=t.nextSibling}if(t.nodeName!="BR"){var a=t.nodeValue.match(new RegExp("^([\\s"+domUtils.fillChar+"]+)"));if(a&&a[1]){r+=a[1]}}if(r){r=u.document.createTextNode(r);e.insertNode(r).setStartAfter(r)}}e.collapse(true).select(true)}else{if(browser.version>8){var s=u.document.createTextNode("\n");var l=e.startContainer;if(e.startOffset==0){var d=l.previousSibling;if(d){e.insertNode(s);var c=u.document.createTextNode(" ");e.setStartAfter(s).insertNode(c).setStart(c,0).collapse(true).select(true)}}else{e.insertNode(s).setStartAfter(s);var c=u.document.createTextNode(" ");l=e.startContainer.childNodes[e.startOffset];if(l&&!/^\n/.test(l.nodeValue)){e.setStartBefore(s)}e.insertNode(c).setStart(c,0).collapse(true).select(true)}}else{var i=u.document.createElement("br");e.insertNode(i);e.insertNode(u.document.createTextNode(domUtils.fillChar));e.setStartAfter(i);t=i.previousSibling;var o;while(t){o=t;t=t.previousSibling;if(!t||t.nodeName=="BR"){t=o;break}}if(t){var r="";while(t&&t.nodeName!="BR"&&new RegExp("^[ "+domUtils.fillChar+"]*$").test(t.nodeValue)){r+=t.nodeValue;t=t.nextSibling}if(t.nodeName!="BR"){var a=t.nodeValue.match(new RegExp("^([ "+domUtils.fillChar+"]+)"));if(a&&a[1]){r+=a[1]}}r=u.document.createTextNode(r);e.insertNode(r).setStartAfter(r)}e.collapse(true).select()}}u.fireEvent("saveScene");return true}});u.addListener("tabkeydown",function(e,t){var i=u.selection.getRange();var n=domUtils.findParentByTagName(i.startContainer,"pre",true);if(n){u.fireEvent("saveScene");if(t.shiftKey){}else{if(!i.collapsed){var o=i.createBookmark();var r=o.start.previousSibling;while(r){if(n.firstChild===r&&!domUtils.isBr(r)){n.insertBefore(u.document.createTextNode("    "),r);break}if(domUtils.isBr(r)){n.insertBefore(u.document.createTextNode("    "),r.nextSibling);break}r=r.previousSibling}var a=o.end;r=o.start.nextSibling;if(n.firstChild===o.start){n.insertBefore(u.document.createTextNode("    "),r.nextSibling)}while(r&&r!==a){if(domUtils.isBr(r)&&r.nextSibling){if(r.nextSibling===a){break}n.insertBefore(u.document.createTextNode("    "),r.nextSibling)}r=r.nextSibling}i.moveToBookmark(o).select()}else{var s=u.document.createTextNode("    ");i.insertNode(s).setStartAfter(s).collapse(true).select(true)}}u.fireEvent("saveScene");return true}});u.addListener("beforeinserthtml",function(e,t){var i=this,n=i.selection.getRange(),o=domUtils.findParentByTagName(n.startContainer,"pre",true);if(o){if(!n.collapsed){n.deleteContents()}var r="";if(browser.ie&&browser.version>8){utils.each(UE.filterNode(UE.htmlparser(t),i.options.filterTxtRules).children,function(t){if(t.type=="element"){if(t.tagName=="br"){r+="\n"}else if(!dtd.$empty[t.tagName]){utils.each(t.children,function(e){if(e.type=="element"){if(e.tagName=="br"){r+="\n"}else if(!dtd.$empty[t.tagName]){r+=e.innerText()}}else{r+=e.data}});if(!/\n$/.test(r)){r+="\n"}}}else{r+=t.data+"\n"}if(!t.nextSibling()&&/\n$/.test(r)){r=r.replace(/\n$/,"")}});var a=i.document.createTextNode(utils.html(r.replace(/&nbsp;/g," ")));n.insertNode(a).selectNode(a).select()}else{var s=i.document.createDocumentFragment();utils.each(UE.filterNode(UE.htmlparser(t),i.options.filterTxtRules).children,function(t){if(t.type=="element"){if(t.tagName=="br"){s.appendChild(i.document.createElement("br"))}else if(!dtd.$empty[t.tagName]){utils.each(t.children,function(e){if(e.type=="element"){if(e.tagName=="br"){s.appendChild(i.document.createElement("br"))}else if(!dtd.$empty[t.tagName]){s.appendChild(i.document.createTextNode(utils.html(e.innerText().replace(/&nbsp;/g," "))))}}else{s.appendChild(i.document.createTextNode(utils.html(e.data.replace(/&nbsp;/g," "))))}});if(s.lastChild.nodeName!="BR"){s.appendChild(i.document.createElement("br"))}}}else{s.appendChild(i.document.createTextNode(utils.html(t.data.replace(/&nbsp;/g," "))))}if(!t.nextSibling()&&s.lastChild.nodeName=="BR"){s.removeChild(s.lastChild)}});n.insertNode(s).select()}return true}});u.addListener("keydown",function(e,t){var i=this,n=t.keyCode||t.which;if(n==40){var o=i.selection.getRange(),r,a=o.startContainer;if(o.collapsed&&(r=domUtils.findParentByTagName(o.startContainer,"pre",true))&&!r.nextSibling){var s=r.lastChild;while(s&&s.nodeName=="BR"){s=s.previousSibling}if(s===a||o.startContainer===r&&o.startOffset==r.childNodes.length){i.execCommand("insertparagraph");domUtils.preventDefault(t)}}}});u.addListener("delkeydown",function(e,t){var i=this.selection.getRange();i.txtToElmBoundary(true);var n=i.startContainer;if(domUtils.isTagNode(n,"pre")&&i.collapsed&&domUtils.isStartInblock(i)){var o=u.document.createElement("p");domUtils.fillNode(u.document,o);n.parentNode.insertBefore(o,n);domUtils.remove(n);i.setStart(o,0).setCursor(false,true);domUtils.preventDefault(t);return true}})};UE.commands["cleardoc"]={execCommand:function(e){var t=this,i=t.options.enterTag,n=t.selection.getRange();if(i=="br"){t.body.innerHTML="<br/>";n.setStart(t.body,0).setCursor()}else{t.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";n.setStart(t.body.firstChild,0).setCursor(false,true)}setTimeout(function(){t.fireEvent("clearDoc")},0)}};UE.plugin.register("anchor",function(){return{bindEvents:{ready:function(){utils.cssRule("anchor",".anchorclass{background: url('"+this.options.themePath+this.options.theme+"/images/anchor.gif') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}",this.document)}},outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){var t;if(t=e.getAttr("anchorname")){e.tagName="a";e.setAttr({anchorname:"",name:t,class:""})}})},inputRule:function(e){utils.each(e.getNodesByTagName("a"),function(e){var t;if((t=e.getAttr("name"))&&!e.getAttr("href")){if(/^\_Toc\d+$/.test(t)){e.parentNode.removeChild(e);return}e.tagName="img";e.setAttr({anchorname:e.getAttr("name"),class:"anchorclass"});e.setAttr("name")}})},commands:{anchor:{execCommand:function(e,t){var i=this.selection.getRange(),n=i.getClosedNode();if(n&&n.getAttribute("anchorname")){if(t){n.setAttribute("anchorname",t)}else{i.setStartBefore(n).setCursor();domUtils.remove(n)}}else{if(t){var o=this.document.createElement("img");i.collapse(true);domUtils.setAttributes(o,{anchorname:t,class:"anchorclass"});i.insertNode(o).setStartAfter(o).setCursor(false,true)}}}}}}});UE.plugins["wordcount"]=function(){var e=this;e.setOpt("wordCount",true);e.addListener("contentchange",function(){e.fireEvent("wordcount")});var o;e.addListener("ready",function(){var n=this;domUtils.on(n.body,"keyup",function(e){var t=e.keyCode||e.which,i={16:1,18:1,20:1,37:1,38:1,39:1,40:1};if(t in i)return;clearTimeout(o);o=setTimeout(function(){n.fireEvent("wordcount")},200)})})};UE.plugins["pagebreak"]=function(){var c=this,u=["td"];c.setOpt("pageBreakTag","_ueditor_page_break_tag_");function f(e){if(domUtils.isEmptyBlock(e)){var t=e.firstChild,i;while(t&&t.nodeType==1&&domUtils.isEmptyBlock(t)){i=t;t=t.firstChild}!i&&(i=e);domUtils.fillNode(c.document,i)}}c.ready(function(){utils.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",c.document)});function m(e){return e&&e.nodeType==1&&e.tagName=="HR"&&e.className=="pagebreak"}c.addInputRule(function(e){e.traversal(function(e){if(e.type=="text"&&e.data==c.options.pageBreakTag){var t=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e)}})});c.addOutputRule(function(e){utils.each(e.getNodesByTagName("hr"),function(e){if(e.getAttr("class")=="pagebreak"){var t=UE.uNode.createText(c.options.pageBreakTag);e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e)}})});c.commands["pagebreak"]={execCommand:function(){var e=c.selection.getRange(),t=c.document.createElement("hr");domUtils.setAttributes(t,{class:"pagebreak",noshade:"noshade",size:"5"});domUtils.unSelectable(t);var i=domUtils.findParentByTagName(e.startContainer,u,true),n=[],o;if(i){switch(i.tagName){case"TD":o=i.parentNode;if(!o.previousSibling){var r=domUtils.findParentByTagName(o,"table");r.parentNode.insertBefore(t,r);n=domUtils.findParents(t,true)}else{o.parentNode.insertBefore(t,o);n=domUtils.findParents(t)}o=n[1];if(t!==o){domUtils.breakParent(t,o)}c.fireEvent("afteradjusttable",c.document)}}else{if(!e.collapsed){e.deleteContents();var a=e.startContainer;while(!domUtils.isBody(a)&&domUtils.isBlockElm(a)&&domUtils.isEmptyNode(a)){e.setStartBefore(a).collapse(true);domUtils.remove(a);a=e.startContainer}}e.insertNode(t);var o=t.parentNode,s;while(!domUtils.isBody(o)){domUtils.breakParent(t,o);s=t.nextSibling;if(s&&domUtils.isEmptyBlock(s)){domUtils.remove(s)}o=t.parentNode}s=t.nextSibling;var l=t.previousSibling;if(m(l)){domUtils.remove(l)}else{l&&f(l)}if(!s){var d=c.document.createElement("p");t.parentNode.appendChild(d);domUtils.fillNode(c.document,d);e.setStart(d,0).collapse(true)}else{if(m(s)){domUtils.remove(s)}else{f(s)}e.setEndAfter(t).collapse(false)}e.select(true)}}}};UE.plugin.register("wordimage",function(){var r=this,i=[];return{commands:{wordimage:{execCommand:function(){var e=domUtils.getElementsByTagName(r.body,"img");var t=[];for(var i=0,n;n=e[i++];){var o=n.getAttribute("word_img");o&&t.push(o)}return t},queryCommandState:function(){i=domUtils.getElementsByTagName(r.body,"img");for(var e=0,t;t=i[e++];){if(t.getAttribute("word_img")){return 1}}return-1},notNeedUndo:true}},inputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){var t=e.attrs,i=parseInt(t.width)<128||parseInt(t.height)<43,n=r.options,o=n.UEDITOR_HOME_URL+"themes/notadd/images/spacer.gif";if(t["src"]&&/^(?:(file:\/+))/.test(t["src"])){e.setAttr({width:t.width,height:t.height,alt:t.alt,word_img:t.src,src:o,style:"background:url("+(i?n.themePath+n.theme+"/images/word.gif":n.langPath+n.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd"})}})}}});UE.plugins["dragdrop"]=function(){var r=this;r.ready(function(){domUtils.on(this.body,"dragend",function(){var e=r.selection.getRange();var t=e.getClosedNode()||r.selection.getStart();if(t&&t.tagName=="IMG"){var i=t.previousSibling,n;while(n=t.nextSibling){if(n.nodeType==1&&n.tagName=="SPAN"&&!n.firstChild){domUtils.remove(n)}else{break}}if((i&&i.nodeType==1&&!domUtils.isEmptyBlock(i)||!i)&&(!n||n&&!domUtils.isEmptyBlock(n))){if(i&&i.tagName=="P"&&!domUtils.isEmptyBlock(i)){i.appendChild(t);domUtils.moveChild(n,i);domUtils.remove(n)}else if(n&&n.tagName=="P"&&!domUtils.isEmptyBlock(n)){n.insertBefore(t,n.firstChild)}if(i&&i.tagName=="P"&&domUtils.isEmptyBlock(i)){domUtils.remove(i)}if(n&&n.tagName=="P"&&domUtils.isEmptyBlock(n)){domUtils.remove(n)}e.selectNode(t).select();r.fireEvent("saveScene")}}})});r.addListener("keyup",function(e,t){var i=t.keyCode||t.which;if(i==13){var n=r.selection.getRange(),o;if(o=domUtils.findParentByTagName(n.startContainer,"p",true)){if(domUtils.getComputedStyle(o,"text-align")=="center"){domUtils.removeStyle(o,"text-align")}}}})};UE.plugins["undo"]=function(){var r;var o=this,a=o.options.maxUndoCount||20,s=o.options.maxInputCount||20,l=new RegExp(domUtils.fillChar+"|</hr>","gi");var d={ol:1,ul:1,table:1,tbody:1,tr:1,body:1};var c=o.options.autoClearEmptyNode;function i(e,t){if(e.length!=t.length)return 0;for(var i=0,n=e.length;i<n;i++){if(e[i]!=t[i])return 0}return 1}function u(e,t){if(e.collapsed!=t.collapsed){return 0}if(!i(e.startAddress,t.startAddress)||!i(e.endAddress,t.endAddress)){return 0}return 1}function e(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0)}}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index)}}this.restore(++this.index)}};this.restore=function(){var t=this.editor;var e=this.list[this.index];var i=UE.htmlparser(e.content.replace(l,""));t.options.autoClearEmptyNode=false;t.filterInputRule(i);t.options.autoClearEmptyNode=c;t.document.body.innerHTML=i.toHtml();t.fireEvent("afterscencerestore");if(browser.ie){utils.each(domUtils.getElementsByTagName(t.document,"td th caption p"),function(e){if(domUtils.isEmptyNode(e)){domUtils.fillNode(t.document,e)}})}try{var n=new dom.Range(t.document).moveToAddress(e.address);n.select(d[n.startContainer.nodeName.toLowerCase()])}catch(e){}this.update();this.clearKey();t.fireEvent("reset",true)};this.getScene=function(){var e=this.editor;var t=e.selection.getRange(),i=t.createAddress(false,true);e.fireEvent("beforegetscene");var n=UE.htmlparser(e.body.innerHTML);e.options.autoClearEmptyNode=false;e.filterOutputRule(n);e.options.autoClearEmptyNode=c;var o=n.toHtml();e.fireEvent("aftergetscene");return{address:i,content:o}};this.save=function(e,t){clearTimeout(r);var i=this.getScene(t),n=this.list[this.index];if(n&&n.content!=i.content){o.trigger("contentchange")}if(n&&n.content==i.content&&(e?1:u(n.address,i.address))){return}this.list=this.list.slice(0,this.index+1);this.list.push(i);if(this.list.length>a){this.list.shift()}this.index=this.list.length-1;this.clearKey();this.update()};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1]};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey()};this.clearKey=function(){m=0;h=null}}o.undoManger=new e;o.undoManger.editor=o;function t(){this.undoManger.save()}o.addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)});o.addListener("reset",function(e,t){if(!t){this.undoManger.reset()}});o.commands["redo"]=o.commands["undo"]={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+(e.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var f={16:1,17:1,18:1,37:1,38:1,39:1,40:1},m=0,h;var p=false;o.addListener("ready",function(){domUtils.on(this.body,"compositionstart",function(){p=true});domUtils.on(this.body,"compositionend",function(){p=false})});o.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var g=true;o.addListener("keydown",function(e,t){var i=this;var n=t.keyCode||t.which;if(!f[n]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(p)return;if(!i.selection.getRange().collapsed){i.undoManger.save(false,true);g=false;return}if(i.undoManger.list.length==0){i.undoManger.save(true)}clearTimeout(r);function o(e){e.undoManger.save(false,true);e.fireEvent("selectionchange")}r=setTimeout(function(){if(p){var e=setInterval(function(){if(!p){o(i);clearInterval(e)}},300);return}o(i)},200);h=n;m++;if(m>=s){o(i)}}});o.addListener("keyup",function(e,t){var i=t.keyCode||t.which;if(!f[i]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(p)return;if(!g){this.undoManger.save(false,true);g=true}}});o.stopCmdUndo=function(){o.__hasEnterExecCommand=true};o.startCmdUndo=function(){o.__hasEnterExecCommand=false}};UE.plugin.register("copy",function(){var o=this;function e(){ZeroClipboard.config({debug:false,swfPath:o.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.swf"});var e=o.zeroclipboard=new ZeroClipboard;e.on("copy",function(e){var t=e.client,i=o.selection.getRange(),n=document.createElement("div");n.appendChild(i.cloneContents());t.setText(n.innerText||n.textContent);t.setHtml(n.innerHTML);i.select()});e.on("mouseover mouseout",function(e){var t=e.target;if(t){if(e.type=="mouseover"){domUtils.addClass(t,"edui-state-hover")}else if(e.type=="mouseout"){domUtils.removeClasses(t,"edui-state-hover")}}});e.on("wrongflash noflash",function(){ZeroClipboard.destroy()});o.fireEvent("zeroclipboardready",e)}return{bindEvents:{ready:function(){if(!browser.ie){if(window.ZeroClipboard){e()}else{utils.loadFile(document,{src:o.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){e()})}}}},commands:{copy:{execCommand:function(e){if(!o.document.execCommand("copy")){alert(o.getLang("copymsg"))}}}}}});UE.plugins["paste"]=function(){function t(n){var o=this.document;if(o.getElementById("baidu_pastebin")){return}var r=this.selection.getRange(),a=r.createBookmark(),s=o.createElement("div");s.id="baidu_pastebin";browser.webkit&&s.appendChild(o.createTextNode(domUtils.fillChar+domUtils.fillChar));o.body.appendChild(s);a.start.style.display="";s.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(a.start).y+"px";r.selectNodeContents(s).select(true);setTimeout(function(){if(browser.webkit){for(var e=0,t=o.querySelectorAll("#baidu_pastebin"),i;i=t[e++];){if(domUtils.isEmptyNode(i)){domUtils.remove(i)}else{s=i;break}}}try{s.parentNode.removeChild(s)}catch(e){}r.moveToBookmark(a).select(true);n(s)},0)}var v=this;v.setOpt({retainOnlyLabelPasted:false});var b,y,C;function w(e){return e.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(e,t,i,n){i=i.toLowerCase();if({img:1}[i]){return e}n=n.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(e,t,i){if({src:1,href:1,name:1}[t.toLowerCase()]){return t+"="+i+" "}return""});if({span:1,div:1}[i]){return""}else{return"<"+t+i+" "+utils.trim(n)+">"}})}function i(e){var t;if(e.firstChild){var i=domUtils.getElementsByTagName(e,"span");for(var n=0,o;o=i[n++];){if(o.id=="_baidu_cut_start"||o.id=="_baidu_cut_end"){domUtils.remove(o)}}if(browser.webkit){var r=e.querySelectorAll("div br");for(var n=0,a;a=r[n++];){var s=a.parentNode;if(s.tagName=="DIV"&&s.childNodes.length==1){s.innerHTML="<p><br/></p>";domUtils.remove(s)}}var l=e.querySelectorAll("#baidu_pastebin");for(var n=0,d;d=l[n++];){var c=v.document.createElement("p");d.parentNode.insertBefore(c,d);while(d.firstChild){c.appendChild(d.firstChild)}domUtils.remove(d)}var u=e.querySelectorAll("meta");for(var n=0,f;f=u[n++];){domUtils.remove(f)}var r=e.querySelectorAll("br");for(n=0;f=r[n++];){if(/^apple-/i.test(f.className)){domUtils.remove(f)}}}if(browser.gecko){var m=e.querySelectorAll("[_moz_dirty]");for(n=0;f=m[n++];){f.removeAttribute("_moz_dirty")}}if(!browser.ie){var h=e.querySelectorAll("span.Apple-style-span");for(var n=0,f;f=h[n++];){domUtils.remove(f,true)}}t=e.innerHTML;t=UE.filterWord(t);var p=UE.htmlparser(t);if(v.options.filterRules){UE.filterNode(p,v.options.filterRules)}v.filterInputRule(p);if(browser.webkit){var g=p.lastChild();if(g&&g.type=="element"&&g.tagName=="br"){p.removeChild(g)}utils.each(v.body.querySelectorAll("div"),function(e){if(domUtils.isEmptyBlock(e)){domUtils.remove(e,true)}})}t={html:p.toHtml()};v.fireEvent("beforepaste",t,p);if(!t.html){return}p=UE.htmlparser(t.html,true);if(v.queryCommandState("pasteplain")===1){v.execCommand("insertHtml",UE.filterNode(p,v.options.filterTxtRules).toHtml(),true)}else{UE.filterNode(p,v.options.filterTxtRules);b=p.toHtml();y=t.html;C=v.selection.getRange().createAddress(true);v.execCommand("insertHtml",v.getOpt("retainOnlyLabelPasted")===true?w(y):y,true)}v.fireEvent("afterpaste",t)}}v.addListener("pasteTransfer",function(e,t){if(C&&b&&y&&b!=y){var i=v.selection.getRange();i.moveToAddress(C,true);if(!i.collapsed){while(!domUtils.isBody(i.startContainer)){var n=i.startContainer;if(n.nodeType==1){n=n.childNodes[i.startOffset];if(!n){i.setStartBefore(i.startContainer);continue}var o=n.previousSibling;if(o&&o.nodeType==3&&new RegExp("^[\n\r\t "+domUtils.fillChar+"]*$").test(o.nodeValue)){i.setStartBefore(o)}}if(i.startOffset==0){i.setStartBefore(i.startContainer)}else{break}}while(!domUtils.isBody(i.endContainer)){var r=i.endContainer;if(r.nodeType==1){r=r.childNodes[i.endOffset];if(!r){i.setEndAfter(i.endContainer);continue}var a=r.nextSibling;if(a&&a.nodeType==3&&new RegExp("^[\n\r\t"+domUtils.fillChar+"]*$").test(a.nodeValue)){i.setEndAfter(a)}}if(i.endOffset==i.endContainer[i.endContainer.nodeType==3?"nodeValue":"childNodes"].length){i.setEndAfter(i.endContainer)}else{break}}}i.deleteContents();i.select(true);v.__hasEnterExecCommand=true;var s=y;if(t===2){s=w(s)}else if(t){s=b}v.execCommand("inserthtml",s,true);v.__hasEnterExecCommand=false;var l=v.selection.getRange();while(!domUtils.isBody(l.startContainer)&&!l.startOffset&&l.startContainer[l.startContainer.nodeType==3?"nodeValue":"childNodes"].length){l.setStartBefore(l.startContainer)}var d=l.createAddress(true);C.endAddress=d.startAddress}});v.addListener("ready",function(){domUtils.on(v.body,"cut",function(){var e=v.selection.getRange();if(!e.collapsed&&v.undoManger){v.undoManger.save()}});domUtils.on(v.body,browser.ie||browser.opera?"keydown":"paste",function(e){if((browser.ie||browser.opera)&&(!e.ctrlKey&&!e.metaKey||e.keyCode!="86")){return}t.call(v,function(e){i(e)})})});v.commands["paste"]={execCommand:function(e){if(browser.ie){t.call(v,function(e){i(e)});v.document.execCommand("paste")}else{alert(v.getLang("pastemsg"))}}}};UE.plugins["pasteplain"]=function(){var e=this;e.setOpt({pasteplain:false,filterTxtRules:function(){function e(e){e.tagName="p";e.setStyle()}function t(e){e.parentNode.removeChild(e,true)}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(e){var t,i=UE.uNode.createElement("p");while(t=e.firstChild()){if(t.type=="text"||!UE.dom.dtd.$block[t.tagName]){i.appendChild(t)}else{if(i.firstChild()){e.parentNode.insertBefore(i,e);i=UE.uNode.createElement("p")}else{e.parentNode.insertBefore(t,e)}}}if(i.firstChild()){e.parentNode.insertBefore(i,e)}e.parentNode.removeChild(e)},ol:t,ul:t,dl:t,dt:t,dd:t,li:t,caption:e,th:e,tr:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,td:function(e){var t=!!e.innerText();if(t){e.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),e)}e.parentNode.removeChild(e,e.innerText())}}}()});var t=e.options.pasteplain;e.commands["pasteplain"]={queryCommandState:function(){return t?1:0},execCommand:function(){t=!t|0},notNeedUndo:1}};UE.plugins["list"]=function(){var C=this,L={TD:1,PRE:1,BLOCKQUOTE:1};var c={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};C.setOpt({autoTransWordToList:false,insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1,disablePInList:false});function e(e){var t=[];for(var i in e){t.push(i)}return t}var h={OL:e(C.options.insertorderedlist),UL:e(C.options.insertunorderedlist)};var n=C.options.listiconpath;for(var t in c){if(!C.options.insertorderedlist.hasOwnProperty(t)&&!C.options.insertunorderedlist.hasOwnProperty(t)){delete c[t]}}C.ready(function(){var e=[];for(var t in c){if(t=="dash"||t=="dot"){e.push("li.list-"+c[t]+"{background-image:url("+n+c[t]+".gif)}");e.push("ul.custom_"+t+"{list-style:none;}ul.custom_"+t+" li{background-position:0 3px;background-repeat:no-repeat}")}else{for(var i=0;i<99;i++){e.push("li.list-"+c[t]+i+"{background-image:url("+n+"list-"+c[t]+i+".gif)}")}e.push("ol.custom_"+t+"{list-style:none;}ol.custom_"+t+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(t){case"cn":e.push("li.list-"+t+"-paddingleft-1{padding-left:25px}");e.push("li.list-"+t+"-paddingleft-2{padding-left:40px}");e.push("li.list-"+t+"-paddingleft-3{padding-left:55px}");break;case"cn1":e.push("li.list-"+t+"-paddingleft-1{padding-left:30px}");e.push("li.list-"+t+"-paddingleft-2{padding-left:40px}");e.push("li.list-"+t+"-paddingleft-3{padding-left:55px}");break;case"cn2":e.push("li.list-"+t+"-paddingleft-1{padding-left:40px}");e.push("li.list-"+t+"-paddingleft-2{padding-left:55px}");e.push("li.list-"+t+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":e.push("li.list-"+t+"-paddingleft-1{padding-left:25px}");break;case"num2":e.push("li.list-"+t+"-paddingleft-1{padding-left:35px}");e.push("li.list-"+t+"-paddingleft-2{padding-left:40px}");break;case"dash":e.push("li.list-"+t+"-paddingleft{padding-left:35px}");break;case"dot":e.push("li.list-"+t+"-paddingleft{padding-left:20px}")}}e.push(".list-paddingleft-1{padding-left:0}");e.push(".list-paddingleft-2{padding-left:"+C.options.listDefaultPaddingLeft+"px}");e.push(".list-paddingleft-3{padding-left:"+C.options.listDefaultPaddingLeft*2+"px}");utils.cssRule("list","ol,ul{margin:0;pading:0;"+(browser.ie?"":"width:95%")+"}li{clear:both;}"+e.join("\n"),C.document)});C.ready(function(){domUtils.on(C.body,"cut",function(){setTimeout(function(){var e=C.selection.getRange(),t;if(!e.collapsed){if(t=domUtils.findParentByTagName(e.startContainer,"li",true)){if(!t.nextSibling&&domUtils.isEmptyBlock(t)){var i=t.parentNode,n;if(n=i.previousSibling){domUtils.remove(i);e.setStartAtLast(n).collapse(true);e.select(true)}else if(n=i.nextSibling){domUtils.remove(i);e.setStartAtFirst(n).collapse(true);e.select(true)}else{var o=C.document.createElement("p");domUtils.fillNode(C.document,o);i.parentNode.insertBefore(o,i);domUtils.remove(i);e.setStart(o,0).collapse(true);e.select(true)}}}}})})});function A(e){var t=e.className;if(domUtils.hasClass(e,/custom_/)){return t.match(/custom_(\w+)/)[1]}return domUtils.getStyle(e,"list-style-type")}C.addListener("beforepaste",function(o,e){var t=this,i=t.selection.getRange(),n;var r=UE.htmlparser(e.html,true);if(n=domUtils.findParentByTagName(i.startContainer,"li",true)){var a=n.parentNode,s=a.tagName=="OL"?"ul":"ol";utils.each(r.getNodesByTagName(s),function(e){e.tagName=a.tagName;e.setAttr();if(e.parentNode===r){o=A(a)||(a.tagName=="OL"?"decimal":"disc")}else{var t=e.parentNode.getAttr("class");if(t&&/custom_/.test(t)){o=t.match(/custom_(\w+)/)[1]}else{o=e.parentNode.getStyle("list-style-type")}if(!o){o=a.tagName=="OL"?"decimal":"disc"}}var i=utils.indexOf(h[a.tagName],o);if(e.parentNode!==r)i=i+1==h[a.tagName].length?0:i+1;var n=h[a.tagName][i];if(c[n]){e.setAttr("class","custom_"+n)}else{e.setStyle("list-style-type",n)}})}e.html=r.toHtml()});C.getOpt("disablePInList")===true&&C.addOutputRule(function(e){utils.each(e.getNodesByTagName("li"),function(n){var o=[],r=0;utils.each(n.children,function(e){if(e.tagName=="p"){var t;while(t=e.children.pop()){o.splice(r,0,t);t.parentNode=n;lastNode=t}t=o[o.length-1];if(!t||t.type!="element"||t.tagName!="br"){var i=UE.uNode.createElement("br");i.parentNode=n;o.push(i)}r=o.length}});if(o.length){n.children=o}})});C.addInputRule(function(e){utils.each(e.getNodesByTagName("li"),function(e){var t=UE.uNode.createElement("p");for(var i=0,n;n=e.children[i];){if(n.type=="text"||dtd.p[n.tagName]){t.appendChild(n)}else{if(t.firstChild()){e.insertBefore(t,n);t=UE.uNode.createElement("p");i=i+2}else{i++}}}if(t.firstChild()&&!t.parentNode||!e.firstChild()){e.appendChild(t)}if(!t.firstChild()){t.innerHTML(browser.ie?"&nbsp;":"<br/>")}var o=e.firstChild();var r=o.lastChild();if(r&&r.type=="text"&&/^\s*$/.test(r.data)){o.removeChild(r)}});if(C.options.autoTransWordToList){var s={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},o={square:"n"};function l(e,t){var i=t.firstChild();if(i&&i.type=="element"&&i.tagName=="span"&&/Wingdings|Symbol/.test(i.getStyle("font-family"))){for(var n in o){if(o[n]==i.data){return n}}return"disc"}for(var n in s){if(s[n].test(e)){return n}}}utils.each(e.getNodesByTagName("p"),function(e){if(e.getAttr("class")!="MsoListParagraph"){return}e.setStyle("margin","");e.setStyle("margin-left","");e.setAttr("class","");function t(e,t,i){if(e.tagName=="ol"){if(browser.ie){var n=t.firstChild();if(n.type=="element"&&n.tagName=="span"&&s[i].test(n.innerText())){t.removeChild(n)}}else{t.innerHTML(t.innerHTML().replace(s[i],""))}}else{t.removeChild(t.firstChild())}var o=UE.uNode.createElement("li");o.appendChild(t);e.appendChild(o)}var i=e,n,o=e;if(e.parentNode.tagName!="li"&&(n=l(e.innerText(),e))){var r=UE.uNode.createElement(C.options.insertorderedlist.hasOwnProperty(n)?"ol":"ul");if(c[n]){r.setAttr("class","custom_"+n)}else{r.setStyle("list-style-type",n)}while(e&&e.parentNode.tagName!="li"&&l(e.innerText(),e)){i=e.nextSibling();if(!i){e.parentNode.insertBefore(r,e)}t(r,e,n);e=i}if(!r.parentNode&&e&&e.parentNode){e.parentNode.insertBefore(r,e)}}var a=o.firstChild();if(a&&a.type=="element"&&a.tagName=="span"&&/^\s*(&nbsp;)+\s*$/.test(a.innerText())){a.parentNode.removeChild(a)}})}});C.addListener("contentchange",function(){a(C.document)});function a(l,d){utils.each(domUtils.getElementsByTagName(l,"ol ul"),function(o){if(!domUtils.inDoc(o,l))return;var e=o.parentNode;if(e.tagName==o.tagName){var t=A(o)||(o.tagName=="OL"?"decimal":"disc"),i=A(e)||(e.tagName=="OL"?"decimal":"disc");if(t==i){var n=utils.indexOf(h[o.tagName],t);n=n+1==h[o.tagName].length?0:n+1;I(o,h[o.tagName][n])}}var r=0,a=2;if(domUtils.hasClass(o,/custom_/)){if(!(/[ou]l/i.test(e.tagName)&&domUtils.hasClass(e,/custom_/))){a=1}}else{if(/[ou]l/i.test(e.tagName)&&domUtils.hasClass(e,/custom_/)){a=3}}var s=domUtils.getStyle(o,"list-style-type");s&&(o.style.cssText="list-style-type:"+s);o.className=utils.trim(o.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+a;utils.each(domUtils.getElementsByTagName(o,"li"),function(e){e.style.cssText&&(e.style.cssText="");if(!e.firstChild){domUtils.remove(e);return}if(e.parentNode!==o){return}r++;if(domUtils.hasClass(o,/custom_/)){var t=1,i=A(o);if(o.tagName=="OL"){if(i){switch(i){case"cn":case"cn1":case"cn2":if(r>10&&(r%10==0||r>10&&r<20)){t=2}else if(r>20){t=3}break;case"num2":if(r>9){t=2}}}e.className="list-"+c[i]+r+" "+"list-"+i+"-paddingleft-"+t}else{e.className="list-"+c[i]+" "+"list-"+i+"-paddingleft"}}else{e.className=e.className.replace(/list-[\w\-]+/gi,"")}var n=e.getAttribute("class");if(n!==null&&!n.replace(/\s/g,"")){domUtils.removeAttributes(e,"class")}});!d&&z(o,o.tagName.toLowerCase(),A(o)||domUtils.getStyle(o,"list-style-type"),true)})}function z(e,t,i,n){var o=e.nextSibling;if(o&&o.nodeType==1&&o.tagName.toLowerCase()==t&&(A(o)||domUtils.getStyle(o,"list-style-type")||(t=="ol"?"decimal":"disc"))==i){domUtils.moveChild(o,e);if(o.childNodes.length==0){domUtils.remove(o)}}if(o&&domUtils.isFillChar(o)){domUtils.remove(o)}var r=e.previousSibling;if(r&&r.nodeType==1&&r.tagName.toLowerCase()==t&&(A(r)||domUtils.getStyle(r,"list-style-type")||(t=="ol"?"decimal":"disc"))==i){domUtils.moveChild(e,r)}if(r&&domUtils.isFillChar(r)){domUtils.remove(r)}!n&&domUtils.isEmptyBlock(e)&&domUtils.remove(e);if(A(e)){a(e.ownerDocument,true)}}function I(e,t){if(c[t]){e.className="custom_"+t}try{domUtils.setStyle(e,"list-style-type",t)}catch(e){}}function w(e){var t=e.previousSibling;if(t&&domUtils.isEmptyBlock(t)){domUtils.remove(t)}t=e.nextSibling;if(t&&domUtils.isEmptyBlock(t)){domUtils.remove(t)}}C.addListener("keydown",function(e,t){function i(){t.preventDefault?t.preventDefault():t.returnValue=false;C.fireEvent("contentchange");C.undoManger&&C.undoManger.save()}function n(e,t){while(e&&!domUtils.isBody(e)){if(t(e)){return null}if(e.nodeType==1&&/[ou]l/i.test(e.tagName)){return e}e=e.parentNode}return null}var o=t.keyCode||t.which;if(o==13&&!t.shiftKey){var r=C.selection.getRange(),a=domUtils.findParent(r.startContainer,function(e){return domUtils.isBlockElm(e)},true),s=domUtils.findParentByTagName(r.startContainer,"li",true);if(a&&a.tagName!="PRE"&&!s){var l=a.innerHTML.replace(new RegExp(domUtils.fillChar,"g"),"");if(/^\s*1\s*\.[^\d]/.test(l)){a.innerHTML=l.replace(/^\s*1\s*\./,"");r.setStartAtLast(a).collapse(true).select();C.__hasEnterExecCommand=true;C.execCommand("insertorderedlist");C.__hasEnterExecCommand=false}}var d=C.selection.getRange(),c=n(d.startContainer,function(e){return e.tagName=="TABLE"}),u=d.collapsed?c:n(d.endContainer,function(e){return e.tagName=="TABLE"});if(c&&u&&c===u){if(!d.collapsed){c=domUtils.findParentByTagName(d.startContainer,"li",true);u=domUtils.findParentByTagName(d.endContainer,"li",true);if(c&&u&&c===u){d.deleteContents();s=domUtils.findParentByTagName(d.startContainer,"li",true);if(s&&domUtils.isEmptyBlock(s)){y=s.previousSibling;next=s.nextSibling;g=C.document.createElement("p");domUtils.fillNode(C.document,g);h=s.parentNode;if(y&&next){d.setStart(next,0).collapse(true).select(true);domUtils.remove(s)}else{if(!y&&!next||!y){h.parentNode.insertBefore(g,h)}else{s.parentNode.parentNode.insertBefore(g,h.nextSibling)}domUtils.remove(s);if(!h.firstChild){domUtils.remove(h)}d.setStart(g,0).setCursor()}i();return}}else{var f=d.cloneRange(),m=f.collapse(false).createBookmark();d.deleteContents();f.moveToBookmark(m);var s=domUtils.findParentByTagName(f.startContainer,"li",true);w(s);f.select();i();return}}s=domUtils.findParentByTagName(d.startContainer,"li",true);if(s){if(domUtils.isEmptyBlock(s)){m=d.createBookmark();var h=s.parentNode;if(s!==h.lastChild){domUtils.breakParent(s,h);w(s)}else{h.parentNode.insertBefore(s,h.nextSibling);if(domUtils.isEmptyNode(h)){domUtils.remove(h)}}if(!dtd.$list[s.parentNode.tagName]){if(!domUtils.isBlockElm(s.firstChild)){g=C.document.createElement("p");s.parentNode.insertBefore(g,s);while(s.firstChild){g.appendChild(s.firstChild)}domUtils.remove(s)}else{domUtils.remove(s,true)}}d.moveToBookmark(m).select()}else{var p=s.firstChild;if(!p||!domUtils.isBlockElm(p)){var g=C.document.createElement("p");!s.firstChild&&domUtils.fillNode(C.document,g);while(s.firstChild){g.appendChild(s.firstChild)}s.appendChild(g);p=g}var v=C.document.createElement("span");d.insertNode(v);domUtils.breakParent(v,s);var b=v.nextSibling;p=b.firstChild;if(!p){g=C.document.createElement("p");domUtils.fillNode(C.document,g);b.appendChild(g);p=g}if(domUtils.isEmptyNode(p)){p.innerHTML="";domUtils.fillNode(C.document,p)}d.setStart(p,0).collapse(true).shrinkBoundary().select();domUtils.remove(v);var y=b.previousSibling;if(y&&domUtils.isEmptyBlock(y)){y.innerHTML="<p></p>";domUtils.fillNode(C.document,y.firstChild)}}i()}}}if(o==8){d=C.selection.getRange();if(d.collapsed&&domUtils.isStartInblock(d)){f=d.cloneRange().trimBoundary();s=domUtils.findParentByTagName(d.startContainer,"li",true);if(s&&domUtils.isStartInblock(f)){c=domUtils.findParentByTagName(d.startContainer,"p",true);if(c&&c!==s.firstChild){var h=domUtils.findParentByTagName(c,["ol","ul"]);domUtils.breakParent(c,h);w(c);C.fireEvent("contentchange");d.setStart(c,0).setCursor(false,true);C.fireEvent("saveScene");domUtils.preventDefault(t);return}if(s&&(y=s.previousSibling)){if(o==46&&s.childNodes.length){return}if(dtd.$list[y.tagName]){y=y.lastChild}C.undoManger&&C.undoManger.save();p=s.firstChild;if(domUtils.isBlockElm(p)){if(domUtils.isEmptyNode(p)){y.appendChild(p);d.setStart(p,0).setCursor(false,true);while(s.firstChild){y.appendChild(s.firstChild)}}else{v=C.document.createElement("span");d.insertNode(v);if(domUtils.isEmptyBlock(y)){y.innerHTML=""}domUtils.moveChild(s,y);d.setStartBefore(v).collapse(true).select(true);domUtils.remove(v)}}else{if(domUtils.isEmptyNode(s)){var g=C.document.createElement("p");y.appendChild(g);d.setStart(g,0).setCursor()}else{d.setEnd(y,y.childNodes.length).collapse().select(true);while(s.firstChild){y.appendChild(s.firstChild)}}}domUtils.remove(s);C.fireEvent("contentchange");C.fireEvent("saveScene");domUtils.preventDefault(t);return}if(s&&!s.previousSibling){var h=s.parentNode;var m=d.createBookmark();if(domUtils.isTagNode(h.parentNode,"ol ul")){h.parentNode.insertBefore(s,h);if(domUtils.isEmptyNode(h)){domUtils.remove(h)}}else{while(s.firstChild){h.parentNode.insertBefore(s.firstChild,h)}domUtils.remove(s);if(domUtils.isEmptyNode(h)){domUtils.remove(h)}}d.moveToBookmark(m).setCursor(false,true);C.fireEvent("contentchange");C.fireEvent("saveScene");domUtils.preventDefault(t);return}}}}});C.addListener("keyup",function(e,t){var i=t.keyCode||t.which;if(i==8){var n=C.selection.getRange(),o;if(o=domUtils.findParentByTagName(n.startContainer,["ol","ul"],true)){z(o,o.tagName.toLowerCase(),A(o)||domUtils.getComputedStyle(o,"list-style-type"),true)}}});C.addListener("tabkeydown",function(){var e=C.selection.getRange();function t(e){if(C.options.maxListLevel!=-1){var t=e.parentNode,i=0;while(/[ou]l/i.test(t.tagName)){i++;t=t.parentNode}if(i>=C.options.maxListLevel){return true}}}var i=domUtils.findParentByTagName(e.startContainer,"li",true);if(i){var n;if(e.collapsed){if(t(i))return true;var o=i.parentNode,r=C.document.createElement(o.tagName),a=utils.indexOf(h[r.tagName],A(o)||domUtils.getComputedStyle(o,"list-style-type"));a=a+1==h[r.tagName].length?0:a+1;var s=h[r.tagName][a];I(r,s);if(domUtils.isStartInblock(e)){C.fireEvent("saveScene");n=e.createBookmark();o.insertBefore(r,i);r.appendChild(i);z(r,r.tagName.toLowerCase(),s);C.fireEvent("contentchange");e.moveToBookmark(n).select(true);return true}}else{C.fireEvent("saveScene");n=e.createBookmark();for(var l=0,d,c=domUtils.findParents(i),u;u=c[l++];){if(domUtils.isTagNode(u,"ol ul")){d=u;break}}var f=i;if(n.end){while(f&&!(domUtils.getPosition(f,n.end)&domUtils.POSITION_FOLLOWING)){if(t(f)){f=domUtils.getNextDomNode(f,false,null,function(e){return e!==d});continue}var o=f.parentNode,r=C.document.createElement(o.tagName),a=utils.indexOf(h[r.tagName],A(o)||domUtils.getComputedStyle(o,"list-style-type"));var m=a+1==h[r.tagName].length?0:a+1;var s=h[r.tagName][m];I(r,s);o.insertBefore(r,f);while(f&&!(domUtils.getPosition(f,n.end)&domUtils.POSITION_FOLLOWING)){i=f.nextSibling;r.appendChild(f);if(!i||domUtils.isTagNode(i,"ol ul")){if(i){while(i=i.firstChild){if(i.tagName=="LI"){break}}}else{i=domUtils.getNextDomNode(f,false,null,function(e){return e!==d})}break}f=i}z(r,r.tagName.toLowerCase(),s);f=i}}C.fireEvent("contentchange");e.moveToBookmark(n).select();return true}}});function _(e){while(e&&!domUtils.isBody(e)){if(e.nodeName=="TABLE"){return null}if(e.nodeName=="LI"){return e}e=e.parentNode}}C.commands["insertorderedlist"]=C.commands["insertunorderedlist"]={execCommand:function(e,t){if(!t){t=e.toLowerCase()=="insertorderedlist"?"decimal":"disc"}var i=this,n=this.selection.getRange(),o=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br":!domUtils.isWhitespace(e)},r=e.toLowerCase()=="insertorderedlist"?"ol":"ul",a=i.document.createDocumentFragment();n.adjustmentBoundary().shrinkBoundary();var s=n.createBookmark(true),l=_(i.document.getElementById(s.start)),d=0,c=_(i.document.getElementById(s.end)),u=0,f,m,h,p;if(l||c){l&&(f=l.parentNode);if(!s.end){c=l}c&&(m=c.parentNode);if(f===m){while(l!==c){p=l;l=l.nextSibling;if(!domUtils.isBlockElm(p.firstChild)){var g=i.document.createElement("p");while(p.firstChild){g.appendChild(p.firstChild)}p.appendChild(g)}a.appendChild(p)}p=i.document.createElement("span");f.insertBefore(p,c);if(!domUtils.isBlockElm(c.firstChild)){g=i.document.createElement("p");while(c.firstChild){g.appendChild(c.firstChild)}c.appendChild(g)}a.appendChild(c);domUtils.breakParent(p,f);if(domUtils.isEmptyNode(p.previousSibling)){domUtils.remove(p.previousSibling)}if(domUtils.isEmptyNode(p.nextSibling)){domUtils.remove(p.nextSibling)}var v=A(f)||domUtils.getComputedStyle(f,"list-style-type")||(e.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(f.tagName.toLowerCase()==r&&v==t){for(var b=0,y,C=i.document.createDocumentFragment();y=a.firstChild;){if(domUtils.isTagNode(y,"ol ul")){C.appendChild(y)}else{while(y.firstChild){C.appendChild(y.firstChild);domUtils.remove(y)}}}p.parentNode.insertBefore(C,p)}else{h=i.document.createElement(r);I(h,t);h.appendChild(a);p.parentNode.insertBefore(h,p)}domUtils.remove(p);h&&z(h,r,t);n.moveToBookmark(s).select();return}if(l){while(l){p=l.nextSibling;if(domUtils.isTagNode(l,"ol ul")){a.appendChild(l)}else{var w=i.document.createDocumentFragment(),x=0;while(l.firstChild){if(domUtils.isBlockElm(l.firstChild)){x=1}w.appendChild(l.firstChild)}if(!x){var N=i.document.createElement("p");N.appendChild(w);a.appendChild(N)}else{a.appendChild(w)}domUtils.remove(l)}l=p}f.parentNode.insertBefore(a,f.nextSibling);if(domUtils.isEmptyNode(f)){n.setStartBefore(f);domUtils.remove(f)}else{n.setStartAfter(f)}d=1}if(c&&domUtils.inDoc(m,i.document)){l=m.firstChild;while(l&&l!==c){p=l.nextSibling;if(domUtils.isTagNode(l,"ol ul")){a.appendChild(l)}else{w=i.document.createDocumentFragment();x=0;while(l.firstChild){if(domUtils.isBlockElm(l.firstChild)){x=1}w.appendChild(l.firstChild)}if(!x){N=i.document.createElement("p");N.appendChild(w);a.appendChild(N)}else{a.appendChild(w)}domUtils.remove(l)}l=p}var U=domUtils.createElement(i.document,"div",{tmpDiv:1});domUtils.moveChild(c,U);a.appendChild(U);domUtils.remove(c);m.parentNode.insertBefore(a,m);n.setEndBefore(m);if(domUtils.isEmptyNode(m)){domUtils.remove(m)}u=1}}if(!d){n.setStartBefore(i.document.getElementById(s.start))}if(s.end&&!u){n.setEndAfter(i.document.getElementById(s.end))}n.enlarge(true,function(e){return L[e.tagName]});a=i.document.createDocumentFragment();var E=n.createBookmark(),T=domUtils.getNextDomNode(E.start,false,o),S=n.cloneRange(),k,B=domUtils.isBlockElm;while(T&&T!==E.end&&domUtils.getPosition(T,E.end)&domUtils.POSITION_PRECEDING){if(T.nodeType==3||dtd.li[T.tagName]){if(T.nodeType==1&&dtd.$list[T.tagName]){while(T.firstChild){a.appendChild(T.firstChild)}k=domUtils.getNextDomNode(T,false,o);domUtils.remove(T);T=k;continue}k=T;S.setStartBefore(T);while(T&&T!==E.end&&(!B(T)||domUtils.isBookmarkNode(T))){k=T;T=domUtils.getNextDomNode(T,false,null,function(e){return!L[e.tagName]})}if(T&&B(T)){p=domUtils.getNextDomNode(k,false,o);if(p&&domUtils.isBookmarkNode(p)){T=domUtils.getNextDomNode(p,false,o);k=p}}S.setEndAfter(k);T=domUtils.getNextDomNode(k,false,o);var M=n.document.createElement("li");M.appendChild(S.extractContents());if(domUtils.isEmptyNode(M)){var k=n.document.createElement("p");while(M.firstChild){k.appendChild(M.firstChild)}M.appendChild(k)}a.appendChild(M)}else{T=domUtils.getNextDomNode(T,true,o)}}n.moveToBookmark(E).collapse(true);h=i.document.createElement(r);I(h,t);h.appendChild(a);n.insertNode(h);z(h,r,t);for(var b=0,y,H=domUtils.getElementsByTagName(h,"div");y=H[b++];){if(y.getAttribute("tmpDiv")){domUtils.remove(y,true)}}n.moveToBookmark(s).select()},queryCommandState:function(e){var t=e.toLowerCase()=="insertorderedlist"?"ol":"ul";var i=this.selection.getStartElementPath();for(var n=0,o;o=i[n++];){if(o.nodeName=="TABLE"){return 0}if(t==o.nodeName.toLowerCase()){return 1}}return 0},queryCommandValue:function(e){var t=e.toLowerCase()=="insertorderedlist"?"ol":"ul";var i=this.selection.getStartElementPath(),n;for(var o=0,r;r=i[o++];){if(r.nodeName=="TABLE"){n=null;break}if(t==r.nodeName.toLowerCase()){n=r;break}}return n?A(n)||domUtils.getComputedStyle(n,"list-style-type"):null}}};(function(){var n={textarea:function(e,t){var i=t.ownerDocument.createElement("textarea");i.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";if(browser.ie&&browser.version<8){i.style.width=t.offsetWidth+"px";i.style.height=t.offsetHeight+"px";t.onresize=function(){i.style.width=t.offsetWidth+"px";i.style.height=t.offsetHeight+"px"}}t.appendChild(i);return{setContent:function(e){i.value=e},getContent:function(){return i.value},select:function(){var e;if(browser.ie){e=i.createTextRange();e.collapse(true);e.select()}else{i.setSelectionRange(0,0);i.focus()}},dispose:function(){t.removeChild(i);t.onresize=null;i=null;t=null},focus:function(){i.focus()},blur:function(){i.blur()}}},codemirror:function(e,t){var i=window.CodeMirror(t,{mode:"text/html",tabMode:"indent",lineNumbers:true,lineWrapping:true});var n=i.getWrapperElement();n.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';i.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";i.refresh();return{getCodeMirror:function(){return i},setContent:function(e){i.setValue(e)},getContent:function(){return i.getValue()},select:function(){i.focus()},dispose:function(){t.removeChild(n);n=null;i=null},focus:function(){i.focus()},blur:function(){i.setOption("readOnly",true);i.setOption("readOnly",false)}}}};UE.plugins["source"]=function(){var r=this;var t=this.options;var a=false;var s;var l;var d;var c;t.sourceEditor=browser.ie?"textarea":t.sourceEditor||"codemirror";r.setOpt({sourceEditorFirst:false});function u(e){return n[t.sourceEditor=="codemirror"&&window.CodeMirror?"codemirror":"textarea"](r,e)}var f;var m,h;r.commands["source"]={execCommand:function(){a=!a;if(a){h=r.selection.getRange().createAddress(false,true);r.undoManger&&r.undoManger.save(true);if(browser.gecko){r.body.contentEditable=false}f=r.iframe.style.cssText;r.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";r.fireEvent("beforegetcontent");var e=UE.htmlparser(r.body.innerHTML);r.filterOutputRule(e);e.traversal(function(e){if(e.type=="element"){switch(e.tagName){case"td":case"th":case"caption":if(e.children&&e.children.length==1){if(e.firstChild().tagName=="br"){e.removeChild(e.firstChild())}}break;case"pre":e.innerText(e.innerText().replace(/&nbsp;/g," "))}}});r.fireEvent("aftergetcontent");var t=e.toHtml(true);s=u(r.iframe.parentNode);s.setContent(t);l=r.setContent;r.setContent=function(e){var t=UE.htmlparser(e);r.filterInputRule(t);e=t.toHtml();s.setContent(e)};setTimeout(function(){s.select();r.addListener("fullscreenchanged",function(){try{s.getCodeMirror().refresh()}catch(e){}})});m=r.getContent;r.getContent=function(){return s.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>"};d=r.focus;c=r.blur;r.focus=function(){s.focus()};r.blur=function(){c.call(r);s.blur()}}else{r.iframe.style.cssText=f;var i=s.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";i=i.replace(new RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>","g"),function(e,t){if(t&&!dtd.$inlineWithA[t.toLowerCase()]){return e.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,"")}return e.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,"")});r.setContent=l;r.setContent(i);s.dispose();s=null;r.getContent=m;r.focus=d;r.blur=c;var n=r.body.firstChild;if(!n){r.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";n=r.body.firstChild}r.undoManger&&r.undoManger.save(true);if(browser.gecko){var o=document.createElement("input");o.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(o);r.body.contentEditable=false;setTimeout(function(){domUtils.setViewportOffset(o,{left:-32768,top:0});o.focus();setTimeout(function(){r.body.contentEditable=true;r.selection.getRange().moveToAddress(h).select(true);domUtils.remove(o)})})}else{try{r.selection.getRange().moveToAddress(h).select(true)}catch(e){}}}this.fireEvent("sourcemodechanged",a)},queryCommandState:function(){return a|0},notNeedUndo:1};var i=r.queryCommandState;r.queryCommandState=function(e){e=e.toLowerCase();if(a){return e in{source:1,fullscreen:1}?1:-1}return i.apply(this,arguments)};if(t.sourceEditor=="codemirror"){r.addListener("ready",function(){utils.loadFile(document,{src:t.codeMirrorJsUrl||t.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){if(t.sourceEditorFirst){setTimeout(function(){r.execCommand("source")},0)}});utils.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:t.codeMirrorCssUrl||t.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}}})();UE.plugins["enterkey"]=function(){var c,u=this,f=u.options.enterTag;u.addListener("keyup",function(e,t){var i=t.keyCode||t.which;if(i==13){var n=u.selection.getRange(),o=n.startContainer,r;if(!browser.ie){if(/h\d/i.test(c)){if(browser.gecko){var a=domUtils.findParentByTagName(o,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],true);if(!a){u.document.execCommand("formatBlock",false,"<p>");r=1}}else{if(o.nodeType==1){var s=u.document.createTextNode(""),l;n.insertNode(s);l=domUtils.findParentByTagName(s,"div",true);if(l){var d=u.document.createElement("p");while(l.firstChild){d.appendChild(l.firstChild)}l.parentNode.insertBefore(d,l);domUtils.remove(l);n.setStartBefore(s).setCursor();r=1}domUtils.remove(s)}}if(u.undoManger&&r){u.undoManger.save()}}browser.opera&&n.select()}else{u.fireEvent("saveScene",true,true)}}});u.addListener("keydown",function(e,t){var i=t.keyCode||t.which;if(i==13){if(u.fireEvent("beforeenterkeydown")){domUtils.preventDefault(t);return}u.fireEvent("saveScene",true,true);c="";var n=u.selection.getRange();if(!n.collapsed){var o=n.startContainer,r=n.endContainer,a=domUtils.findParentByTagName(o,"td",true),s=domUtils.findParentByTagName(r,"td",true);if(a&&s&&a!==s||!a&&s||a&&!s){t.preventDefault?t.preventDefault():t.returnValue=false;return}}if(f=="p"){if(!browser.ie){o=domUtils.findParentByTagName(n.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],true);if(!o&&!browser.opera){u.document.execCommand("formatBlock",false,"<p>");if(browser.gecko){n=u.selection.getRange();o=domUtils.findParentByTagName(n.startContainer,"p",true);o&&domUtils.removeDirtyAttr(o)}}else{c=o.tagName;o.tagName.toLowerCase()=="p"&&browser.gecko&&domUtils.removeDirtyAttr(o)}}}else{t.preventDefault?t.preventDefault():t.returnValue=false;if(!n.collapsed){n.deleteContents();o=n.startContainer;if(o.nodeType==1&&(o=o.childNodes[n.startOffset])){while(o.nodeType==1){if(dtd.$empty[o.tagName]){n.setStartBefore(o).setCursor();if(u.undoManger){u.undoManger.save()}return false}if(!o.firstChild){var l=n.document.createElement("br");o.appendChild(l);n.setStart(o,0).setCursor();if(u.undoManger){u.undoManger.save()}return false}o=o.firstChild}if(o===n.startContainer.childNodes[n.startOffset]){l=n.document.createElement("br");n.insertNode(l).setCursor()}else{n.setStart(o,0).setCursor()}}else{l=n.document.createElement("br");n.insertNode(l).setStartAfter(l).setCursor()}}else{l=n.document.createElement("br");n.insertNode(l);var d=l.parentNode;if(d.lastChild===l){l.parentNode.insertBefore(l.cloneNode(true),l);n.setStartBefore(l)}else{n.setStartAfter(l)}n.setCursor()}}}})};UE.plugins["keystrokes"]=function(){var y=this;var C=true;y.addListener("keydown",function(e,t){var i=t.keyCode||t.which,n=y.selection.getRange();if(!n.collapsed&&!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&(i>=65&&i<=90||i>=48&&i<=57||i>=96&&i<=111||{13:1,8:1,46:1}[i])){var o=n.startContainer;if(domUtils.isFillChar(o)){n.setStartBefore(o)}o=n.endContainer;if(domUtils.isFillChar(o)){n.setEndAfter(o)}n.txtToElmBoundary();if(n.endContainer&&n.endContainer.nodeType==1){o=n.endContainer.childNodes[n.endOffset];if(o&&domUtils.isBr(o)){n.setEndAfter(o)}}if(n.startOffset==0){o=n.startContainer;if(domUtils.isBoundaryNode(o,"firstChild")){o=n.endContainer;if(n.endOffset==(o.nodeType==3?o.nodeValue.length:o.childNodes.length)&&domUtils.isBoundaryNode(o,"lastChild")){y.fireEvent("saveScene");y.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";n.setStart(y.body.firstChild,0).setCursor(false,true);y._selectionChange();return}}}}if(i==keymap.Backspace){n=y.selection.getRange();C=n.collapsed;if(y.fireEvent("delkeydown",t)){return}var r,a;if(n.collapsed&&n.inFillChar()){r=n.startContainer;if(domUtils.isFillChar(r)){n.setStartBefore(r).shrinkBoundary(true).collapse(true);domUtils.remove(r)}else{r.nodeValue=r.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"");n.startOffset--;n.collapse(true).select(true)}}if(r=n.getClosedNode()){y.fireEvent("saveScene");n.setStartBefore(r);domUtils.remove(r);n.setCursor();y.fireEvent("saveScene");domUtils.preventDefault(t);return}if(!browser.ie){r=domUtils.findParentByTagName(n.startContainer,"table",true);a=domUtils.findParentByTagName(n.endContainer,"table",true);if(r&&!a||!r&&a||r!==a){t.preventDefault();return}}}if(i==keymap.Tab){var s={ol:1,ul:1,table:1};if(y.fireEvent("tabkeydown",t)){domUtils.preventDefault(t);return}var l=y.selection.getRange();y.fireEvent("saveScene");for(var d=0,c="",u=y.options.tabSize||4,f=y.options.tabNode||"&nbsp;";d<u;d++){c+=f}var m=y.document.createElement("span");m.innerHTML=c+domUtils.fillChar;if(l.collapsed){l.insertNode(m.cloneNode(true).firstChild).setCursor(true)}else{var h=function(e){return domUtils.isBlockElm(e)&&!s[e.tagName.toLowerCase()]};r=domUtils.findParent(l.startContainer,h,true);a=domUtils.findParent(l.endContainer,h,true);if(r&&a&&r===a){l.deleteContents();l.insertNode(m.cloneNode(true).firstChild).setCursor(true)}else{var p=l.createBookmark();l.enlarge(true);var g=l.createBookmark(),v=domUtils.getNextDomNode(g.start,false,h);while(v&&!(domUtils.getPosition(v,g.end)&domUtils.POSITION_FOLLOWING)){v.insertBefore(m.cloneNode(true).firstChild,v.firstChild);v=domUtils.getNextDomNode(v,false,h)}l.moveToBookmark(g).moveToBookmark(p).select()}}domUtils.preventDefault(t)}if(browser.gecko&&i==46){l=y.selection.getRange();if(l.collapsed){r=l.startContainer;if(domUtils.isEmptyBlock(r)){var b=r.parentNode;while(domUtils.getChildCount(b)==1&&!domUtils.isBody(b)){r=b;b=b.parentNode}if(r===b.lastChild)t.preventDefault();return}}}browser.chrome&&y.on("keydown",function(e,t){var i=t.keyCode||t.which;if((t.metaKey&&t.altKey||t.ctrlKey&&t.shiftKey)&&i==73){return true}})});y.addListener("keyup",function(e,t){var i=t.keyCode||t.which,n,o=this;if(i==keymap.Backspace){if(o.fireEvent("delkeyup")){return}n=o.selection.getRange();if(n.collapsed){var r,a=["h1","h2","h3","h4","h5","h6"];if(r=domUtils.findParentByTagName(n.startContainer,a,true)){if(domUtils.isEmptyBlock(r)){var s=r.previousSibling;if(s&&s.nodeName!="TABLE"){domUtils.remove(r);n.setStartAtLast(s).setCursor(false,true);return}else{var l=r.nextSibling;if(l&&l.nodeName!="TABLE"){domUtils.remove(r);n.setStartAtFirst(l).setCursor(false,true);return}}}}if(domUtils.isBody(n.startContainer)){var r=domUtils.createElement(o.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});n.insertNode(r).setStart(r,0).setCursor(false,true)}}if(!C&&(n.startContainer.nodeType==3||n.startContainer.nodeType==1&&domUtils.isEmptyBlock(n.startContainer))){if(browser.ie){var d=n.document.createElement("span");n.insertNode(d).setStartBefore(d).collapse(true);n.select();domUtils.remove(d)}else{n.select()}}}})};UE.plugins["fiximgclick"]=function(){var n=false;function d(){this.editor=null;this.resizer=null;this.cover=null;this.doc=document;this.prePos={x:0,y:0};this.startPos={x:0,y:0}}(function(){var r=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];d.prototype={init:function(e){var t=this;t.editor=e;t.startPos=this.prePos={x:0,y:0};t.dragId=-1;var n=[],o=t.cover=document.createElement("div"),r=t.resizer=document.createElement("div");o.id=t.editor.ui.id+"_imagescale_cover";o.style.cssText="position:absolute;display:none;z-index:"+t.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;";domUtils.on(o,"mousedown click",function(){t.hide()});for(i=0;i<8;i++){n.push('<span class="edui-editor-imagescale-hand'+i+'"></span>')}r.id=t.editor.ui.id+"_imagescale";r.className="edui-editor-imagescale";r.innerHTML=n.join("");r.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+t.editor.options.zIndex+";";t.editor.ui.getDom().appendChild(o);t.editor.ui.getDom().appendChild(r);t.initStyle();t.initEvents()},initStyle:function(){utils.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}"+".edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}"+".edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}"+".edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}"+".edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}"+".edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}"+".edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}"+".edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}"+".edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}"+".edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},initEvents:function(){var e=this;e.startPos.x=e.startPos.y=0;e.isDraging=false},_eventHandler:function(e){var t=this;switch(e.type){case"mousedown":var i=e.target||e.srcElement,i;if(i.className.indexOf("edui-editor-imagescale-hand")!=-1&&t.dragId==-1){t.dragId=i.className.slice(-1);t.startPos.x=t.prePos.x=e.clientX;t.startPos.y=t.prePos.y=e.clientY;domUtils.on(t.doc,"mousemove",t.proxy(t._eventHandler,t))}break;case"mousemove":if(t.dragId!=-1){t.updateContainerStyle(t.dragId,{x:e.clientX-t.prePos.x,y:e.clientY-t.prePos.y});t.prePos.x=e.clientX;t.prePos.y=e.clientY;n=true;t.updateTargetElement()}break;case"mouseup":if(t.dragId!=-1){t.updateContainerStyle(t.dragId,{x:e.clientX-t.prePos.x,y:e.clientY-t.prePos.y});t.updateTargetElement();if(t.target.parentNode)t.attachTo(t.target);t.dragId=-1}domUtils.un(t.doc,"mousemove",t.proxy(t._eventHandler,t));if(n){n=false;t.editor.fireEvent("contentchange")}break;default:break}},updateTargetElement:function(){var e=this;domUtils.setStyles(e.target,{width:e.resizer.style.width,height:e.resizer.style.height});e.target.width=parseInt(e.resizer.style.width);e.target.height=parseInt(e.resizer.style.height);e.attachTo(e.target)},updateContainerStyle:function(e,t){var i=this,n=i.resizer,o;if(r[e][0]!=0){o=parseInt(n.style.left)+t.x;n.style.left=i._validScaledProp("left",o)+"px"}if(r[e][1]!=0){o=parseInt(n.style.top)+t.y;n.style.top=i._validScaledProp("top",o)+"px"}if(r[e][2]!=0){o=n.clientWidth+r[e][2]*t.x;n.style.width=i._validScaledProp("width",o)+"px"}if(r[e][3]!=0){o=n.clientHeight+r[e][3]*t.y;n.style.height=i._validScaledProp("height",o)+"px"}},_validScaledProp:function(e,t){var i=this.resizer,n=document;t=isNaN(t)?0:t;switch(e){case"left":return t<0?0:t+i.clientWidth>n.clientWidth?n.clientWidth-i.clientWidth:t;case"top":return t<0?0:t+i.clientHeight>n.clientHeight?n.clientHeight-i.clientHeight:t;case"width":return t<=0?1:t+i.offsetLeft>n.clientWidth?n.clientWidth-i.offsetLeft:t;case"height":return t<=0?1:t+i.offsetTop>n.clientHeight?n.clientHeight-i.offsetTop:t}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var e=this,t=domUtils.getXY(e.editor.ui.getDom()),i=domUtils.getXY(e.editor.iframe);domUtils.setStyles(e.cover,{width:e.editor.iframe.offsetWidth+"px",height:e.editor.iframe.offsetHeight+"px",top:i.y-t.y+"px",left:i.x-t.x+"px",position:"absolute",display:""})},show:function(e){var t=this;t.resizer.style.display="block";if(e)t.attachTo(e);domUtils.on(this.resizer,"mousedown",t.proxy(t._eventHandler,t));domUtils.on(t.doc,"mouseup",t.proxy(t._eventHandler,t));t.showCover();t.editor.fireEvent("afterscaleshow",t);t.editor.fireEvent("saveScene")},hide:function(){var e=this;e.hideCover();e.resizer.style.display="none";domUtils.un(e.resizer,"mousedown",e.proxy(e._eventHandler,e));domUtils.un(e.doc,"mouseup",e.proxy(e._eventHandler,e));e.editor.fireEvent("afterscalehide",e)},proxy:function(t,i){return function(e){return t.apply(i||this,arguments)}},attachTo:function(e){var t=this,i=t.target=e,n=this.resizer,o=domUtils.getXY(i),r=domUtils.getXY(t.editor.iframe),a=domUtils.getXY(n.parentNode);var s=t.editor.document;domUtils.setStyles(n,{width:i.width+"px",height:i.height+"px",left:r.x+o.x-(s.documentElement.scrollLeft||s.body.scrollLeft||0)-a.x-parseInt(n.style.borderLeftWidth)+"px",top:r.y+o.y-(s.documentElement.scrollTop||s.body.scrollTop||0)-a.y-parseInt(n.style.borderTopWidth)+"px"})}}})();return function(){var s=this,l;s.setOpt("imageScaleEnabled",true);if(!browser.ie&&s.options.imageScaleEnabled){s.addListener("click",function(e,t){var i=s.selection.getRange(),n=i.getClosedNode();if(n&&n.tagName=="IMG"&&s.body.contentEditable!="false"){if(n.className.indexOf("edui-faked-music")!=-1||n.getAttribute("anchorname")||domUtils.hasClass(n,"loadingclass")||domUtils.hasClass(n,"loaderrorclass")){return}if(!l){l=new d;l.init(s);s.ui.getDom().appendChild(l.resizer);var o=function(e){l.hide();if(l.target)s.selection.getRange().selectNode(l.target).select()},r=function(e){var t=e.target||e.srcElement;if(t&&(t.className===undefined||t.className.indexOf("edui-editor-imagescale")==-1)){o(e)}},a;s.addListener("afterscaleshow",function(e){s.addListener("beforekeydown",o);s.addListener("beforemousedown",r);domUtils.on(document,"keydown",o);domUtils.on(document,"mousedown",r);s.selection.getNative().removeAllRanges()});s.addListener("afterscalehide",function(e){s.removeListener("beforekeydown",o);s.removeListener("beforemousedown",r);domUtils.un(document,"keydown",o);domUtils.un(document,"mousedown",r);var t=l.target;if(t.parentNode){s.selection.getRange().selectNode(t).select()}});domUtils.on(l.resizer,"mousedown",function(e){s.selection.getNative().removeAllRanges();var t=e.target||e.srcElement;if(t&&t.className.indexOf("edui-editor-imagescale-hand")==-1){a=setTimeout(function(){l.hide();if(l.target)s.selection.getRange().selectNode(t).select()},200)}});domUtils.on(l.resizer,"mouseup",function(e){var t=e.target||e.srcElement;if(t&&t.className.indexOf("edui-editor-imagescale-hand")==-1){clearTimeout(a)}})}l.show(n)}else{if(l&&l.resizer.style.display!="none")l.hide()}})}if(browser.webkit){s.addListener("click",function(e,t){if(t.target.tagName=="IMG"&&s.body.contentEditable!="false"){var i=new dom.Range(s.document);i.selectNode(t.target).select()}})}}}();UE.plugin.register("autolink",function(){var e=0;return!browser.ie?{bindEvents:{reset:function(){e=0},keydown:function(e,t){var i=this;var n=t.keyCode||t.which;if(n==32||n==13){var o=i.selection.getNative(),r=o.getRangeAt(0).cloneRange(),a,s;var l=r.startContainer;while(l.nodeType==1&&r.startOffset>0){l=r.startContainer.childNodes[r.startOffset-1];if(!l){break}r.setStart(l,l.nodeType==1?l.childNodes.length:l.nodeValue.length);r.collapse(true);l=r.startContainer}do{if(r.startOffset==0){l=r.startContainer.previousSibling;while(l&&l.nodeType==1){l=l.lastChild}if(!l||domUtils.isFillChar(l)){break}a=l.nodeValue.length}else{l=r.startContainer;a=r.startOffset}r.setStart(l,a-1);s=r.toString().charCodeAt(0)}while(s!=160&&s!=32);if(r.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(r.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(r.toString())){break}try{r.setStart(r.startContainer,r.startOffset+1)}catch(e){var l=r.startContainer;while(!(next=l.nextSibling)){if(domUtils.isBody(l)){return}l=l.parentNode}r.setStart(next,0)}}if(domUtils.findParentByTagName(r.startContainer,"a",true)){return}var d=i.document.createElement("a"),c=i.document.createTextNode(" "),u;i.undoManger&&i.undoManger.save();d.appendChild(r.extractContents());d.href=d.innerHTML=d.innerHTML.replace(/<[^>]+>/g,"");u=d.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),"");u=/^(?:https?:\/\/)/gi.test(u)?u:"http://"+u;d.setAttribute("_src",utils.html(u));d.href=utils.html(u);r.insertNode(d);d.parentNode.insertBefore(c,d.nextSibling);r.setStart(c,0);r.collapse(true);o.removeAllRanges();o.addRange(r);i.undoManger&&i.undoManger.save()}}}}}:{}},function(){var l={37:1,38:1,39:1,40:1,13:1,32:1};function d(e){if(e.nodeType==3){return null}if(e.nodeName=="A"){return e}var t=e.lastChild;while(t){if(t.nodeName=="A"){return t}if(t.nodeType==3){if(domUtils.isWhitespace(t)){t=t.previousSibling;continue}return null}t=t.lastChild}}browser.ie&&this.addListener("keyup",function(e,t){var i=this,n=t.keyCode;if(l[n]){var o=i.selection.getRange();var r=o.startContainer;if(n==13){while(r&&!domUtils.isBody(r)&&!domUtils.isBlockElm(r)){r=r.parentNode}if(r&&!domUtils.isBody(r)&&r.nodeName=="P"){var a=r.previousSibling;if(a&&a.nodeType==1){var a=d(a);if(a&&!a.getAttribute("_href")){domUtils.remove(a,true)}}}}else if(n==32){if(r.nodeType==3&&/^\s$/.test(r.nodeValue)){r=r.previousSibling;if(r&&r.nodeName=="A"&&!r.getAttribute("_href")){domUtils.remove(r,true)}}}else{r=domUtils.findParentByTagName(r,"a",true);if(r&&!r.getAttribute("_href")){var s=o.createBookmark();domUtils.remove(r,true);o.moveToBookmark(s).select(true)}}}})});UE.plugins["autoheight"]=function(){var t=this;t.autoHeightEnabled=t.options.autoHeightEnabled!==false;if(!t.autoHeightEnabled){return}var i,n=0,o=t.options,r,e;function a(){var t=this;clearTimeout(e);if(s)return;if(!t.queryCommandState||t.queryCommandState&&t.queryCommandState("source")!=1){e=setTimeout(function(){var e=t.body.lastChild;while(e&&e.nodeType!=1){e=e.previousSibling}if(e&&e.nodeType==1){e.style.clear="both";r=Math.max(domUtils.getXY(e).y+e.offsetHeight+25,Math.max(o.minFrameHeight,o.initialFrameHeight));if(r!=n){if(r!==parseInt(t.iframe.parentNode.style.height)){t.iframe.parentNode.style.height=r+"px"}t.body.style.height=r+"px";n=r}domUtils.removeStyle(e,"clear")}},50)}}var s;t.addListener("fullscreenchanged",function(e,t){s=t});t.addListener("destroy",function(){domUtils.un(t.window,"scroll",d);t.removeListener("contentchange afterinserthtml keyup mouseup",a)});t.enableAutoHeight=function(){var e=this;if(!e.autoHeightEnabled){return}var t=e.document;e.autoHeightEnabled=true;i=t.body.style.overflowY;t.body.style.overflowY="hidden";e.addListener("contentchange afterinserthtml keyup mouseup",a);setTimeout(function(){a.call(e)},browser.gecko?100:0);e.fireEvent("autoheightchanged",e.autoHeightEnabled)};t.disableAutoHeight=function(){t.body.style.overflowY=i||"";t.removeListener("contentchange",a);t.removeListener("keyup",a);t.removeListener("mouseup",a);t.autoHeightEnabled=false;t.fireEvent("autoheightchanged",t.autoHeightEnabled)};t.on("setHeight",function(){t.disableAutoHeight()});t.addListener("ready",function(){t.enableAutoHeight();var e;domUtils.on(browser.ie?t.body:t.document,browser.webkit?"dragover":"drop",function(){clearTimeout(e);e=setTimeout(function(){a.call(t)},100)});domUtils.on(t.window,"scroll",d)});var l;function d(){if(!t.window)return;if(l===null){l=t.window.scrollY}else if(t.window.scrollY==0&&l!=0){t.window.scrollTo(0,0);l=null}}};UE.plugins["autofloat"]=function(){var n=this,e=n.getLang();n.setOpt({topOffset:0});var t=n.options.autoFloatEnabled!==false,o=n.options.topOffset;if(!t){return}var i=UE.ui.uiUtils,r=browser.ie&&browser.version<=6,a=browser.quirks;function s(){if(!UE.ui){alert(e.autofloatMsg);return 0}return 1}function l(){var e=document.body.style;e.backgroundImage='url("about:blank")';e.backgroundAttachment="fixed"}var d,c=document.createElement("div"),u,f,m,h=true;function p(){var e=domUtils.getXY(u),t=domUtils.getComputedStyle(u,"position"),i=domUtils.getComputedStyle(u,"left");u.style.width=u.offsetWidth+"px";u.style.zIndex=n.options.zIndex*1+1;u.parentNode.insertBefore(c,u);if(r||a&&browser.ie){if(u.style.position!="absolute"){u.style.position="absolute"}u.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-f+o+"px"}else{if(browser.ie7Compat&&h){h=false;u.style.left=domUtils.getXY(u).x-document.documentElement.getBoundingClientRect().left+2+"px"}if(u.style.position!="fixed"){u.style.position="fixed";u.style.top=o+"px";(t=="absolute"||t=="relative")&&parseFloat(i)&&(u.style.left=e.x+"px")}}}function g(){h=true;if(c.parentNode){c.parentNode.removeChild(c)}u.style.cssText=d}function v(){var e=m(n.container);var t=n.options.toolbarTopOffset||0;if(e.top<0&&e.bottom-u.offsetHeight>t){p()}else{g()}}var b=utils.defer(function(){v()},browser.ie?200:100,true);n.addListener("destroy",function(){domUtils.un(window,["scroll","resize"],v);n.removeListener("keydown",b);var e=document.getElementById("scrollBox");if(e){domUtils.un(e,["scroll","resize"],v)}});n.addListener("ready",function(){if(s(n)){if(!n.ui){return}m=i.getClientRect;u=n.ui.getDom("toolbarbox");f=m(u).top;d=u.style.cssText;c.style.height=u.offsetHeight+"px";if(r){l()}domUtils.on(window,["scroll","resize"],v);n.addListener("keydown",b);var e=document.getElementById("scrollBox");if(e){domUtils.on(e,["scroll","resize"],v)}n.addListener("beforefullscreenchange",function(e,t){if(t){g()}});n.addListener("fullscreenchanged",function(e,t){if(!t){v()}});n.addListener("sourcemodechanged",function(e,t){setTimeout(function(){v()},0)});n.addListener("clearDoc",function(){setTimeout(function(){v()},0)})}})};UE.plugins["video"]=function(){var u=this;function f(e,t,i,n,o,r,a){var s;switch(a){case"image":s="<img "+(n?'id="'+n+'"':"")+' width="'+t+'" height="'+i+'" _url="'+e+'" class="'+r.replace(/\bvideo-js\b/,"")+'"'+' src="'+u.options.UEDITOR_HOME_URL+'themes/notadd/images/spacer.gif" style="background:url('+u.options.UEDITOR_HOME_URL+"themes/notadd/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(o?"float:"+o+";":"")+'" />';break;case"embed":s='<embed type="application/x-shockwave-flash" class="'+r+'" pluginspage="http://www.macromedia.com/go/getflashplayer"'+' src="'+utils.html(e)+'" width="'+t+'" height="'+i+'"'+(o?' style="float:'+o+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';break;case"video":var l=e.substr(e.lastIndexOf(".")+1);if(l=="ogv")l="ogg";s="<video"+(n?' id="'+n+'"':"")+' class="'+r+' video-js" '+(o?' style="float:'+o+'"':"")+' controls preload="none" width="'+t+'" height="'+i+'" src="'+e+'" data-setup="{}">'+'<source src="'+e+'" type="video/'+l+'" /></video>';break}return s}function t(e,n){utils.each(e.getNodesByTagName(n?"img":"embed video"),function(e){var t=e.getAttr("class");if(t&&t.indexOf("edui-faked-video")!=-1){var i=f(n?e.getAttr("_url"):e.getAttr("src"),e.getAttr("width"),e.getAttr("height"),null,e.getStyle("float")||"",t,n?"embed":"image");e.parentNode.replaceChild(UE.uNode.createElement(i),e)}if(t&&t.indexOf("edui-upload-video")!=-1){var i=f(n?e.getAttr("_url"):e.getAttr("src"),e.getAttr("width"),e.getAttr("height"),null,e.getStyle("float")||"",t,n?"video":"image");e.parentNode.replaceChild(UE.uNode.createElement(i),e)}})}u.addOutputRule(function(e){t(e,true)});u.addInputRule(function(e){t(e)});u.commands["insertvideo"]={execCommand:function(e,t,i){t=utils.isArray(t)?t:[t];if(u.fireEvent("beforeinsertvideo",t)===true){return}var n=[],o="tmpVedio",r;for(var a=0,s,l=t.length;a<l;a++){s=t[a];r=i=="upload"?"edui-upload-video video-js vjs-default-skin":"edui-faked-video";n.push(f(s.url,s.width||420,s.height||280,o+a,null,r,"image"))}u.execCommand("inserthtml",n.join(""),true);var d=this.selection.getRange();for(var a=0,l=t.length;a<l;a++){var c=this.document.getElementById("tmpVedio"+a);domUtils.removeAttributes(c,"id");d.selectNode(c).select();u.execCommand("imagefloat",t[a].align)}u.fireEvent("afterinsertvideo",t)},queryCommandState:function(){var e=u.selection.getRange().getClosedNode(),t=e&&(e.className=="edui-faked-video"||e.className.indexOf("edui-upload-video")!=-1);return t?1:0}}};(function(){var r=UE.UETable=function(e){this.table=e;this.indexTable=[];this.selectedTds=[];this.cellsRange={};this.update(e)};r.removeSelectedClass=function(e){utils.each(e,function(e){domUtils.removeClasses(e,"selectTdClass")})};r.addSelectedClass=function(e){utils.each(e,function(e){domUtils.addClass(e,"selectTdClass")})};r.isEmptyBlock=function(e){var t=new RegExp(domUtils.fillChar,"g");if(e[browser.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(t,"").length>0){return 0}for(var i in dtd.$isNotEmpty)if(dtd.$isNotEmpty.hasOwnProperty(i)){if(e.getElementsByTagName(i).length){return 0}}return 1};r.getWidth=function(e){if(!e)return 0;return parseInt(domUtils.getComputedStyle(e,"width"),10)};r.getTableCellAlignState=function(e){!utils.isArray(e)&&(e=[e]);var i={},n=["align","valign"],o=null,r=true;utils.each(e,function(t){utils.each(n,function(e){o=t.getAttribute(e);if(!i[e]&&o){i[e]=o}else if(!i[e]||o!==i[e]){r=false;return false}});return r});return r?i:null};r.getTableItemsByRange=function(e){var t=e.selection.getStart();if(t&&t.id&&t.id.indexOf("_baidu_bookmark_start_")===0&&t.nextSibling){t=t.nextSibling}var i=t&&domUtils.findParentByTagName(t,["td","th"],true),n=i&&i.parentNode,o=n&&domUtils.findParentByTagName(n,["table"]),r=o&&o.getElementsByTagName("caption")[0];return{cell:i,tr:n,table:o,caption:r}};r.getUETableBySelected=function(e){var t=r.getTableItemsByRange(e).table;if(t&&t.ueTable&&t.ueTable.selectedTds.length){return t.ueTable}return null};r.getDefaultValue=function(e,t){var i={thin:"0px",medium:"1px",thick:"2px"},n,o,r,a;if(!t){t=e.document.createElement("table");t.insertRow(0).insertCell(0).innerHTML="xxx";e.body.appendChild(t);var s=t.getElementsByTagName("td")[0];a=domUtils.getComputedStyle(t,"border-left-width");n=parseInt(i[a]||a,10);a=domUtils.getComputedStyle(s,"padding-left");o=parseInt(i[a]||a,10);a=domUtils.getComputedStyle(s,"border-left-width");r=parseInt(i[a]||a,10);domUtils.remove(t);return{tableBorder:n,tdPadding:o,tdBorder:r}}else{s=t.getElementsByTagName("td")[0];a=domUtils.getComputedStyle(t,"border-left-width");n=parseInt(i[a]||a,10);a=domUtils.getComputedStyle(s,"padding-left");o=parseInt(i[a]||a,10);a=domUtils.getComputedStyle(s,"border-left-width");r=parseInt(i[a]||a,10);return{tableBorder:n,tdPadding:o,tdBorder:r}}};r.getUETable=function(e){var t=e.tagName.toLowerCase();e=t=="td"||t=="th"||t=="caption"?domUtils.findParentByTagName(e,"table",true):e;if(!e.ueTable){e.ueTable=new r(e)}return e.ueTable};r.cloneCell=function(e,t,i){if(!e||utils.isString(e)){return this.table.ownerDocument.createElement(e||"td")}var n=domUtils.hasClass(e,"selectTdClass");n&&domUtils.removeClasses(e,"selectTdClass");var o=e.cloneNode(true);if(t){o.rowSpan=o.colSpan=1}!i&&domUtils.removeAttributes(o,"width height");!i&&domUtils.removeAttributes(o,"style");o.style.borderLeftStyle="";o.style.borderTopStyle="";o.style.borderLeftColor=e.style.borderRightColor;o.style.borderLeftWidth=e.style.borderRightWidth;o.style.borderTopColor=e.style.borderBottomColor;o.style.borderTopWidth=e.style.borderBottomWidth;n&&domUtils.addClass(e,"selectTdClass");return o};r.prototype={getMaxRows:function(){var e=this.table.rows,t=1;for(var i=0,n;n=e[i];i++){var o=1;for(var r=0,a;a=n.cells[r++];){o=Math.max(a.rowSpan||1,o)}t=Math.max(o+i,t)}return t},getMaxCols:function(){var e=this.table.rows,t=0,i={};for(var n=0,o;o=e[n];n++){var r=0;for(var a=0,s;s=o.cells[a++];){r+=s.colSpan||1;if(s.rowSpan&&s.rowSpan>1){for(var l=1;l<s.rowSpan;l++){if(!i["row_"+(n+l)]){i["row_"+(n+l)]=s.colSpan||1}else{i["row_"+(n+l)]++}}}}r+=i["row_"+n]||0;t=Math.max(r,t)}return t},getCellColIndex:function(e){},getHSideCell:function(e,t){try{var i=this.getCellInfo(e),n,o;var r=this.selectedTds.length,a=this.cellsRange;if(!t&&(!r?!i.colIndex:!a.beginColIndex)||t&&(!r?i.colIndex==this.colsNum-1:a.endColIndex==this.colsNum-1))return null;n=!r?i.rowIndex:a.beginRowIndex;o=!t?!r?i.colIndex<1?0:i.colIndex-1:a.beginColIndex-1:!r?i.colIndex+1:a.endColIndex+1;return this.getCell(this.indexTable[n][o].rowIndex,this.indexTable[n][o].cellIndex)}catch(e){u(e)}},getTabNextCell:function(e,t){var i=this.getCellInfo(e),n=t||i.rowIndex,o=i.colIndex+1+(i.colSpan-1),r;try{r=this.getCell(this.indexTable[n][o].rowIndex,this.indexTable[n][o].cellIndex)}catch(e){try{n=n*1+1;o=0;r=this.getCell(this.indexTable[n][o].rowIndex,this.indexTable[n][o].cellIndex)}catch(e){}}return r},getVSideCell:function(e,t,i){try{var n=this.getCellInfo(e),o,r;var a=this.selectedTds.length&&!i,s=this.cellsRange;if(!t&&n.rowIndex==0||t&&(!a?n.rowIndex+n.rowSpan>this.rowsNum-1:s.endRowIndex==this.rowsNum-1))return null;o=!t?!a?n.rowIndex-1:s.beginRowIndex-1:!a?n.rowIndex+n.rowSpan:s.endRowIndex+1;r=!a?n.colIndex:s.beginColIndex;return this.getCell(this.indexTable[o][r].rowIndex,this.indexTable[o][r].cellIndex)}catch(e){u(e)}},getSameEndPosCells:function(e,t){try{var i=t.toLowerCase()==="x",n=domUtils.getXY(e)[i?"x":"y"]+e["offset"+(i?"Width":"Height")],o=this.table.rows,r=null,a=[];for(var s=0;s<this.rowsNum;s++){r=o[s].cells;for(var l=0,d;d=r[l++];){var c=domUtils.getXY(d)[i?"x":"y"]+d["offset"+(i?"Width":"Height")];if(c>n&&i)break;if(e==d||n==c){if(d[i?"colSpan":"rowSpan"]==1){a.push(d)}if(i)break}}}return a}catch(e){u(e)}},setCellContent:function(e,t){e.innerHTML=t||(browser.ie?domUtils.fillChar:"<br />")},cloneCell:r.cloneCell,getSameStartPosXCells:function(e){try{var t=domUtils.getXY(e).x+e.offsetWidth,i=this.table.rows,n,o=[];for(var r=0;r<this.rowsNum;r++){n=i[r].cells;for(var a=0,s;s=n[a++];){var l=domUtils.getXY(s).x;if(l>t)break;if(l==t&&s.colSpan==1){o.push(s);break}}}return o}catch(e){u(e)}},update:function(e){this.table=e||this.table;this.selectedTds=[];this.cellsRange={};this.indexTable=[];var t=this.table.rows,i=this.getMaxRows(),n=i-t.length,o=this.getMaxCols();while(n--){this.table.insertRow(t.length)}this.rowsNum=i;this.colsNum=o;for(var r=0,a=t.length;r<a;r++){this.indexTable[r]=new Array(o)}for(var s=0,l;l=t[s];s++){for(var d=0,c,u=l.cells;c=u[d];d++){if(c.rowSpan>i){c.rowSpan=i}var f=d,m=c.rowSpan||1,h=c.colSpan||1;while(this.indexTable[s][f])f++;for(var p=0;p<m;p++){for(var g=0;g<h;g++){this.indexTable[s+p][f+g]={rowIndex:s,cellIndex:d,colIndex:f,rowSpan:m,colSpan:h}}}}}for(p=0;p<i;p++){for(g=0;g<o;g++){if(this.indexTable[p][g]===undefined){l=t[p];c=l.cells[l.cells.length-1];c=c?c.cloneNode(true):this.table.ownerDocument.createElement("td");this.setCellContent(c);if(c.colSpan!==1)c.colSpan=1;if(c.rowSpan!==1)c.rowSpan=1;l.appendChild(c);this.indexTable[p][g]={rowIndex:p,cellIndex:c.cellIndex,colIndex:g,rowSpan:1,colSpan:1}}}}var v=domUtils.getElementsByTagName(this.table,"td"),b=[];utils.each(v,function(e){if(domUtils.hasClass(e,"selectTdClass")){b.push(e)}});if(b.length){var y=b[0],C=b[b.length-1],w=this.getCellInfo(y),x=this.getCellInfo(C);this.selectedTds=b;this.cellsRange={beginRowIndex:w.rowIndex,beginColIndex:w.colIndex,endRowIndex:x.rowIndex+x.rowSpan-1,endColIndex:x.colIndex+x.colSpan-1}}if(!domUtils.hasClass(this.table.rows[0],"firstRow")){domUtils.addClass(this.table.rows[0],"firstRow");for(var r=1;r<this.table.rows.length;r++){domUtils.removeClasses(this.table.rows[r],"firstRow")}}},getCellInfo:function(e){if(!e)return;var t=e.cellIndex,i=e.parentNode.rowIndex,n=this.indexTable[i],o=this.colsNum;for(var r=t;r<o;r++){var a=n[r];if(a.rowIndex===i&&a.cellIndex===t){return a}}},getCell:function(e,t){return e<this.rowsNum&&this.table.rows[e].cells[t]||null},deleteCell:function(e,t){t=typeof t=="number"?t:e.parentNode.rowIndex;var i=this.table.rows[t];i.deleteCell(e.cellIndex)},getCellsRange:function(e,t){function u(e,t,i,n){var o=e,r=t,a=i,s=n,l,d,c;if(e>0){for(d=t;d<n;d++){l=f.indexTable[e][d];c=l.rowIndex;if(c<e){o=Math.min(c,o)}}}if(n<f.colsNum){for(c=e;c<i;c++){l=f.indexTable[c][n];d=l.colIndex+l.colSpan-1;if(d>n){s=Math.max(d,s)}}}if(i<f.rowsNum){for(d=t;d<n;d++){l=f.indexTable[i][d];c=l.rowIndex+l.rowSpan-1;if(c>i){a=Math.max(c,a)}}}if(t>0){for(c=e;c<i;c++){l=f.indexTable[c][t];d=l.colIndex;if(d<t){r=Math.min(l.colIndex,r)}}}if(o!=e||r!=t||a!=i||s!=n){return u(o,r,a,s)}else{return{beginRowIndex:e,beginColIndex:t,endRowIndex:i,endColIndex:n}}}try{var f=this,i=f.getCellInfo(e);if(e===t){return{beginRowIndex:i.rowIndex,beginColIndex:i.colIndex,endRowIndex:i.rowIndex+i.rowSpan-1,endColIndex:i.colIndex+i.colSpan-1}}var n=f.getCellInfo(t);var o=Math.min(i.rowIndex,n.rowIndex),r=Math.min(i.colIndex,n.colIndex),a=Math.max(i.rowIndex+i.rowSpan-1,n.rowIndex+n.rowSpan-1),s=Math.max(i.colIndex+i.colSpan-1,n.colIndex+n.colSpan-1);return u(o,r,a,s)}catch(e){}},getCells:function(e){this.clearSelected();var t=e.beginRowIndex,i=e.beginColIndex,n=e.endRowIndex,o=e.endColIndex,r,a,s,l={},d=[];for(var c=t;c<=n;c++){for(var u=i;u<=o;u++){r=this.indexTable[c][u];a=r.rowIndex;s=r.colIndex;var f=a+"|"+s;if(l[f])continue;l[f]=1;if(a<c||s<u||a+r.rowSpan-1>n||s+r.colSpan-1>o){return null}d.push(this.getCell(a,r.cellIndex))}}return d},clearSelected:function(){r.removeSelectedClass(this.selectedTds);this.selectedTds=[];this.cellsRange={}},setSelected:function(e){var t=this.getCells(e);r.addSelectedClass(t);this.selectedTds=t;this.cellsRange=e},isFullRow:function(){var e=this.cellsRange;return e.endColIndex-e.beginColIndex+1==this.colsNum},isFullCol:function(){var e=this.cellsRange,t=this.table,i=t.getElementsByTagName("th"),n=e.endRowIndex-e.beginRowIndex+1;return!i.length?n==this.rowsNum:n==this.rowsNum||n==this.rowsNum-1},getNextCell:function(e,t,i){try{var n=this.getCellInfo(e),o,r;var a=this.selectedTds.length&&!i,s=this.cellsRange;if(!t&&n.rowIndex==0||t&&(!a?n.rowIndex+n.rowSpan>this.rowsNum-1:s.endRowIndex==this.rowsNum-1))return null;o=!t?!a?n.rowIndex-1:s.beginRowIndex-1:!a?n.rowIndex+n.rowSpan:s.endRowIndex+1;r=!a?n.colIndex:s.beginColIndex;return this.getCell(this.indexTable[o][r].rowIndex,this.indexTable[o][r].cellIndex)}catch(e){u(e)}},getPreviewCell:function(e,t){try{var i=this.getCellInfo(e),n,o;var r=this.selectedTds.length,a=this.cellsRange;if(!t&&(!r?!i.colIndex:!a.beginColIndex)||t&&(!r?i.rowIndex>this.colsNum-1:a.endColIndex==this.colsNum-1))return null;n=!t?!r?i.rowIndex:a.beginRowIndex:!r?i.rowIndex<1?0:i.rowIndex-1:a.beginRowIndex;o=!t?!r?i.colIndex<1?0:i.colIndex-1:a.beginColIndex-1:!r?i.colIndex:a.endColIndex+1;return this.getCell(this.indexTable[n][o].rowIndex,this.indexTable[n][o].cellIndex)}catch(e){u(e)}},moveContent:function(e,t){if(r.isEmptyBlock(t))return;if(r.isEmptyBlock(e)){e.innerHTML=t.innerHTML;return}var i=e.lastChild;if(i.nodeType==3||!dtd.$block[i.tagName]){e.appendChild(e.ownerDocument.createElement("br"))}while(i=t.firstChild){e.appendChild(i)}},mergeRight:function(e){var t=this.getCellInfo(e),i=t.colIndex+t.colSpan,n=this.indexTable[t.rowIndex][i],o=this.getCell(n.rowIndex,n.cellIndex);e.colSpan=t.colSpan+n.colSpan;e.removeAttribute("width");this.moveContent(e,o);this.deleteCell(o,n.rowIndex);this.update()},mergeDown:function(e){var t=this.getCellInfo(e),i=t.rowIndex+t.rowSpan,n=this.indexTable[i][t.colIndex],o=this.getCell(n.rowIndex,n.cellIndex);e.rowSpan=t.rowSpan+n.rowSpan;e.removeAttribute("height");this.moveContent(e,o);this.deleteCell(o,n.rowIndex);this.update()},mergeRange:function(){var e=this.cellsRange,t=this.getCell(e.beginRowIndex,this.indexTable[e.beginRowIndex][e.beginColIndex].cellIndex);var i=this.getCells(e);for(var n=0,o;o=i[n++];){if(o!==t){this.moveContent(t,o);this.deleteCell(o)}}t.rowSpan=e.endRowIndex-e.beginRowIndex+1;t.rowSpan>1&&t.removeAttribute("height");t.colSpan=e.endColIndex-e.beginColIndex+1;t.colSpan>1&&t.removeAttribute("width");if(t.rowSpan==this.rowsNum&&t.colSpan!=1){t.colSpan=1}if(t.colSpan==this.colsNum&&t.rowSpan!=1){var r=t.parentNode.rowIndex;if(this.table.deleteRow){for(var n=r+1,a=r+1,s=t.rowSpan;n<s;n++){this.table.deleteRow(a)}}else{for(var n=0,s=t.rowSpan-1;n<s;n++){var l=this.table.rows[r+1];l.parentNode.removeChild(l)}}t.rowSpan=1}this.update()},insertRow:function(e,t){var i=this.colsNum,n=this.table,o=n.insertRow(e),r,a=null,s=typeof t=="string"&&t.toUpperCase()=="TH";function l(e,t,i){if(e==0){var n=i.nextSibling||i.previousSibling,o=n.cells[e];if(o.tagName=="TH"){o=t.ownerDocument.createElement("th");o.appendChild(t.firstChild);i.insertBefore(o,t);domUtils.remove(t)}}else{if(t.tagName=="TH"){var r=t.ownerDocument.createElement("td");r.appendChild(t.firstChild);i.insertBefore(r,t);domUtils.remove(t)}}}if(e==0||e==this.rowsNum){for(var d=0;d<i;d++){r=this.cloneCell(t,true);this.setCellContent(r);r.getAttribute("vAlign")&&r.setAttribute("vAlign",r.getAttribute("vAlign"));o.appendChild(r);if(!s)l(d,r,o)}if(s){a=n.createTHead();a.insertBefore(o,a.firstChild)}}else{var c=this.indexTable[e],u=0;for(d=0;d<i;d++){var f=c[d];if(f.rowIndex<e){r=this.getCell(f.rowIndex,f.cellIndex);r.rowSpan=f.rowSpan+1}else{r=this.cloneCell(t,true);this.setCellContent(r);o.appendChild(r)}if(!s)l(d,r,o)}}this.update();return o},deleteRow:function(e){var t=this.table.rows[e],i=this.indexTable[e],n=this.colsNum,o=0;for(var r=0;r<n;){var a=i[r],s=this.getCell(a.rowIndex,a.cellIndex);if(s.rowSpan>1){if(a.rowIndex==e){var l=s.cloneNode(true);l.rowSpan=s.rowSpan-1;l.innerHTML="";s.rowSpan=1;var d=e+1,c=this.table.rows[d],u,f=this.getPreviewMergedCellsNum(d,r)-o;if(f<r){u=r-f-1;domUtils.insertAfter(c.cells[u],l)}else{if(c.cells.length)c.insertBefore(l,c.cells[0])}o+=1}}r+=s.colSpan||1}var m=[],h={};for(r=0;r<n;r++){var p=i[r].rowIndex,g=i[r].cellIndex,v=p+"_"+g;if(h[v])continue;h[v]=1;s=this.getCell(p,g);m.push(s)}var b=[];utils.each(m,function(e){if(e.rowSpan==1){e.parentNode.removeChild(e)}else{b.push(e)}});utils.each(b,function(e){e.rowSpan--});t.parentNode.removeChild(t);this.update()},insertCol:function(e,t,i){var n=this.rowsNum,o=0,r,a,s=parseInt((this.table.offsetWidth-(this.colsNum+1)*20-(this.colsNum+1))/(this.colsNum+1),10),l=typeof t=="string"&&t.toUpperCase()=="TH";function d(e,t,i){if(e==0){var n=t.nextSibling||t.previousSibling;if(n.tagName=="TH"){n=t.ownerDocument.createElement("th");n.appendChild(t.firstChild);i.insertBefore(n,t);domUtils.remove(t)}}else{if(t.tagName=="TH"){var o=t.ownerDocument.createElement("td");o.appendChild(t.firstChild);i.insertBefore(o,t);domUtils.remove(t)}}}var c;if(e==0||e==this.colsNum){for(;o<n;o++){r=this.table.rows[o];c=r.cells[e==0?e:r.cells.length];a=this.cloneCell(t,true);this.setCellContent(a);a.setAttribute("vAlign",a.getAttribute("vAlign"));c&&a.setAttribute("width",c.getAttribute("width"));if(!e){r.insertBefore(a,r.cells[0])}else{domUtils.insertAfter(r.cells[r.cells.length-1],a)}if(!l)d(o,a,r)}}else{for(;o<n;o++){var u=this.indexTable[o][e];if(u.colIndex<e){a=this.getCell(u.rowIndex,u.cellIndex);a.colSpan=u.colSpan+1}else{r=this.table.rows[o];c=r.cells[u.cellIndex];a=this.cloneCell(t,true);this.setCellContent(a);a.setAttribute("vAlign",a.getAttribute("vAlign"));c&&a.setAttribute("width",c.getAttribute("width"));c?r.insertBefore(a,c):r.appendChild(a)}if(!l)d(o,a,r)}}this.update();this.updateWidth(s,i||{tdPadding:10,tdBorder:1})},updateWidth:function(t,e){var i=this.table,n=r.getWidth(i)-e.tdPadding*2-e.tdBorder+t;if(n<i.ownerDocument.body.offsetWidth){i.setAttribute("width",n);return}var o=domUtils.getElementsByTagName(this.table,"td th");utils.each(o,function(e){e.setAttribute("width",t)})},deleteCol:function(e){var t=this.indexTable,i=this.table.rows,n=this.table.getAttribute("width"),o=0,r=this.rowsNum,a={};for(var s=0;s<r;){var l=t[s],d=l[e],c=d.rowIndex+"_"+d.colIndex;if(a[c])continue;a[c]=1;var u=this.getCell(d.rowIndex,d.cellIndex);if(!o)o=u&&parseInt(u.offsetWidth/u.colSpan,10).toFixed(0);if(u.colSpan>1){u.colSpan--}else{i[s].deleteCell(d.cellIndex)}s+=d.rowSpan||1}this.table.setAttribute("width",n-o);this.update()},splitToCells:function(e){var t=this,i=this.splitToRows(e);utils.each(i,function(e){t.splitToCols(e)})},splitToRows:function(e){var t=this.getCellInfo(e),i=t.rowIndex,n=t.colIndex,o=[];e.rowSpan=1;o.push(e);for(var r=i,a=i+t.rowSpan;r<a;r++){if(r==i)continue;var s=this.table.rows[r],l=s.insertCell(n-this.getPreviewMergedCellsNum(r,n));l.colSpan=t.colSpan;this.setCellContent(l);l.setAttribute("vAlign",e.getAttribute("vAlign"));l.setAttribute("align",e.getAttribute("align"));if(e.style.cssText){l.style.cssText=e.style.cssText}o.push(l)}this.update();return o},getPreviewMergedCellsNum:function(e,t){var i=this.indexTable[e],n=0;for(var o=0;o<t;){var r=i[o].colSpan,a=i[o].rowIndex;n+=r-(a==e?1:0);o+=r}return n},splitToCols:function(e){var t=(e.offsetWidth/e.colSpan-22).toFixed(0),i=this.getCellInfo(e),n=i.rowIndex,o=i.colIndex,r=[];e.colSpan=1;e.setAttribute("width",t);r.push(e);for(var a=o,s=o+i.colSpan;a<s;a++){if(a==o)continue;var l=this.table.rows[n],d=l.insertCell(this.indexTable[n][a].cellIndex+1);d.rowSpan=i.rowSpan;this.setCellContent(d);d.setAttribute("vAlign",e.getAttribute("vAlign"));d.setAttribute("align",e.getAttribute("align"));d.setAttribute("width",t);if(e.style.cssText){d.style.cssText=e.style.cssText}if(e.tagName=="TH"){var c=e.ownerDocument.createElement("th");c.appendChild(d.firstChild);c.setAttribute("vAlign",e.getAttribute("vAlign"));c.rowSpan=d.rowSpan;l.insertBefore(c,d);domUtils.remove(d)}r.push(d)}this.update();return r},isLastCell:function(e,t,i){t=t||this.rowsNum;i=i||this.colsNum;var n=this.getCellInfo(e);return n.rowIndex+n.rowSpan==t&&n.colIndex+n.colSpan==i},getLastCell:function(e){e=e||this.table.getElementsByTagName("td");var t=this.getCellInfo(e[0]);var i=this,n=e[0],o=n.parentNode,r=0,a=0,s;utils.each(e,function(e){if(e.parentNode==o)a+=e.colSpan||1;r+=e.rowSpan*e.colSpan||1});s=r/a;utils.each(e,function(e){if(i.isLastCell(e,s,a)){n=e;return false}});return n},selectRow:function(e){var t=this.indexTable[e],i=this.getCell(t[0].rowIndex,t[0].cellIndex),n=this.getCell(t[this.colsNum-1].rowIndex,t[this.colsNum-1].cellIndex),o=this.getCellsRange(i,n);this.setSelected(o)},selectTable:function(){var e=this.table.getElementsByTagName("td"),t=this.getCellsRange(e[0],e[e.length-1]);this.setSelected(t)},setBackground:function(e,t){if(typeof t==="string"){utils.each(e,function(e){e.style.backgroundColor=t})}else if(typeof t==="object"){t=utils.extend({repeat:true,colorList:["#ddd","#fff"]},t);var i=this.getCellInfo(e[0]).rowIndex,n=0,o=t.colorList,r=function(e,t,i){return e[t]?e[t]:i?e[t%e.length]:""};for(var a=0,s;s=e[a++];){var l=this.getCellInfo(s);s.style.backgroundColor=r(o,i+n==l.rowIndex?n:++n,t.repeat)}}},removeBackground:function(e){utils.each(e,function(e){e.style.backgroundColor=""})}};function u(e){}})();(function(){var i=UE.UETable,u=function(e){return i.getTableItemsByRange(e)},a=function(e){return i.getUETableBySelected(e)},v=function(e,t){return i.getDefaultValue(e,t)},f=function(e){return i.getUETable(e)};UE.commands["inserttable"]={queryCommandState:function(){return u(this).table?-1:0},execCommand:function(e,t){function i(e,t){var i=[],n=e.numRows,o=e.numCols;for(var r=0;r<n;r++){i.push("<tr"+(r==0?' class="firstRow"':"")+">");for(var a=0;a<o;a++){i.push('<td width="'+t+'"  vAlign="'+e.tdvalign+'" >'+(browser.ie&&browser.version<11?domUtils.fillChar:"<br/>")+"</td>")}i.push("</tr>")}return"<table><tbody>"+i.join("")+"</tbody></table>"}if(!t){t=utils.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign})}var n=this;var o=this.selection.getRange(),r=o.startContainer,a=domUtils.findParent(r,function(e){return domUtils.isBlockElm(e)},true)||n.body;var s=v(n),l=a.offsetWidth,d=Math.floor(l/t.numCols-s.tdPadding*2-s.tdBorder);!t.tdvalign&&(t.tdvalign=n.options.tdvalign);n.execCommand("inserthtml",i(t,d))}};UE.commands["insertparagraphbeforetable"]={queryCommandState:function(){return u(this).cell?0:-1},execCommand:function(){var e=u(this).table;if(e){var t=this.document.createElement("p");t.innerHTML=browser.ie?"&nbsp;":"<br />";e.parentNode.insertBefore(t,e);this.selection.getRange().setStart(t,0).setCursor()}}};UE.commands["deletetable"]={queryCommandState:function(){var e=this.selection.getRange();return domUtils.findParentByTagName(e.startContainer,"table",true)?0:-1},execCommand:function(e,t){var i=this.selection.getRange();t=t||domUtils.findParentByTagName(i.startContainer,"table",true);if(t){var n=t.nextSibling;if(!n){n=domUtils.createElement(this.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});t.parentNode.insertBefore(n,t)}domUtils.remove(t);i=this.selection.getRange();if(n.nodeType==3){i.setStartBefore(n)}else{i.setStart(n,0)}i.setCursor(false,true);this.fireEvent("tablehasdeleted")}}};UE.commands["cellalign"]={queryCommandState:function(){return s(this).length?0:-1},execCommand:function(e,t){var i=s(this);if(i.length){for(var n=0,o;o=i[n++];){o.setAttribute("align",t)}}}};UE.commands["cellvalign"]={queryCommandState:function(){return s(this).length?0:-1},execCommand:function(e,t){var i=s(this);if(i.length){for(var n=0,o;o=i[n++];){o.setAttribute("vAlign",t)}}}};UE.commands["insertcaption"]={queryCommandState:function(){var e=u(this).table;if(e){return e.getElementsByTagName("caption").length==0?1:-1}return-1},execCommand:function(){var e=u(this).table;if(e){var t=this.document.createElement("caption");t.innerHTML=browser.ie?domUtils.fillChar:"<br/>";e.insertBefore(t,e.firstChild);var i=this.selection.getRange();i.setStart(t,0).setCursor()}}};UE.commands["deletecaption"]={queryCommandState:function(){var e=this.selection.getRange(),t=domUtils.findParentByTagName(e.startContainer,"table");if(t){return t.getElementsByTagName("caption").length==0?-1:1}return-1},execCommand:function(){var e=this.selection.getRange(),t=domUtils.findParentByTagName(e.startContainer,"table");if(t){domUtils.remove(t.getElementsByTagName("caption")[0]);var i=this.selection.getRange();i.setStart(t.rows[0].cells[0],0).setCursor()}}};UE.commands["inserttitle"]={queryCommandState:function(){var e=u(this).table;if(e){var t=e.rows[0];return t.cells[t.cells.length-1].tagName.toLowerCase()!="th"?0:-1}return-1},execCommand:function(){var e=u(this).table;if(e){f(e).insertRow(0,"th")}var t=e.getElementsByTagName("th")[0];this.selection.getRange().setStart(t,0).setCursor(false,true)}};UE.commands["deletetitle"]={queryCommandState:function(){var e=u(this).table;if(e){var t=e.rows[0];return t.cells[t.cells.length-1].tagName.toLowerCase()=="th"?0:-1}return-1},execCommand:function(){var e=u(this).table;if(e){domUtils.remove(e.rows[0])}var t=e.getElementsByTagName("td")[0];this.selection.getRange().setStart(t,0).setCursor(false,true)}};UE.commands["inserttitlecol"]={queryCommandState:function(){var e=u(this).table;if(e){var t=e.rows[e.rows.length-1];return t.getElementsByTagName("th").length?-1:0}return-1},execCommand:function(e){var t=u(this).table;if(t){f(t).insertCol(0,"th")}o(t,this);var i=t.getElementsByTagName("th")[0];this.selection.getRange().setStart(i,0).setCursor(false,true)}};UE.commands["deletetitlecol"]={queryCommandState:function(){var e=u(this).table;if(e){var t=e.rows[e.rows.length-1];return t.getElementsByTagName("th").length?0:-1}return-1},execCommand:function(){var e=u(this).table;if(e){for(var t=0;t<e.rows.length;t++){domUtils.remove(e.rows[t].children[0])}}o(e,this);var i=e.getElementsByTagName("td")[0];this.selection.getRange().setStart(i,0).setCursor(false,true)}};UE.commands["mergeright"]={queryCommandState:function(e){var t=u(this),i=t.table,n=t.cell;if(!i||!n)return-1;var o=f(i);if(o.selectedTds.length)return-1;var r=o.getCellInfo(n),a=r.colIndex+r.colSpan;if(a>=o.colsNum)return-1;var s=o.indexTable[r.rowIndex][a],l=i.rows[s.rowIndex].cells[s.cellIndex];if(!l||n.tagName!=l.tagName)return-1;return s.rowIndex==r.rowIndex&&s.rowSpan==r.rowSpan?0:-1},execCommand:function(e){var t=this.selection.getRange(),i=t.createBookmark(true);var n=u(this).cell,o=f(n);o.mergeRight(n);t.moveToBookmark(i).select()}};UE.commands["mergedown"]={queryCommandState:function(e){var t=u(this),i=t.table,n=t.cell;if(!i||!n)return-1;var o=f(i);if(o.selectedTds.length)return-1;var r=o.getCellInfo(n),a=r.rowIndex+r.rowSpan;if(a>=o.rowsNum)return-1;var s=o.indexTable[a][r.colIndex],l=i.rows[s.rowIndex].cells[s.cellIndex];if(!l||n.tagName!=l.tagName)return-1;return s.colIndex==r.colIndex&&s.colSpan==r.colSpan?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(true);var i=u(this).cell,n=f(i);n.mergeDown(i);e.moveToBookmark(t).select()}};UE.commands["mergecells"]={queryCommandState:function(){return a(this)?0:-1},execCommand:function(){var e=a(this);if(e&&e.selectedTds.length){var t=e.selectedTds[0];e.mergeRange();var i=this.selection.getRange();if(domUtils.isEmptyBlock(t)){i.setStart(t,0).collapse(true)}else{i.selectNodeContents(t)}i.select()}}};UE.commands["insertrow"]={queryCommandState:function(){var e=u(this),t=e.cell;return t&&(t.tagName=="TD"||t.tagName=="TH"&&e.tr!==e.table.rows[0])&&f(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(true);var i=u(this),n=i.cell,o=i.table,r=f(o),a=r.getCellInfo(n);if(!r.selectedTds.length){r.insertRow(a.rowIndex,n)}else{var s=r.cellsRange;for(var l=0,d=s.endRowIndex-s.beginRowIndex+1;l<d;l++){r.insertRow(s.beginRowIndex,n)}}e.moveToBookmark(t).select();if(o.getAttribute("interlaced")==="enabled")this.fireEvent("interlacetable",o)}};UE.commands["insertrownext"]={queryCommandState:function(){var e=u(this),t=e.cell;return t&&t.tagName=="TD"&&f(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(true);var i=u(this),n=i.cell,o=i.table,r=f(o),a=r.getCellInfo(n);if(!r.selectedTds.length){r.insertRow(a.rowIndex+a.rowSpan,n)}else{var s=r.cellsRange;for(var l=0,d=s.endRowIndex-s.beginRowIndex+1;l<d;l++){r.insertRow(s.endRowIndex+1,n)}}e.moveToBookmark(t).select();if(o.getAttribute("interlaced")==="enabled")this.fireEvent("interlacetable",o)}};UE.commands["deleterow"]={queryCommandState:function(){var e=u(this);return e.cell?0:-1},execCommand:function(){var e=u(this).cell,t=f(e),i=t.cellsRange,n=t.getCellInfo(e),o=t.getVSideCell(e),r=t.getVSideCell(e,true),a=this.selection.getRange();if(utils.isEmptyObject(i)){t.deleteRow(n.rowIndex)}else{for(var s=i.beginRowIndex;s<i.endRowIndex+1;s++){t.deleteRow(i.beginRowIndex)}}var l=t.table;if(!l.getElementsByTagName("td").length){var d=l.nextSibling;domUtils.remove(l);if(d){a.setStart(d,0).setCursor(false,true)}}else{if(n.rowSpan==1||n.rowSpan==i.endRowIndex-i.beginRowIndex+1){if(r||o)a.selectNodeContents(r||o).setCursor(false,true)}else{var c=t.getCell(n.rowIndex,t.indexTable[n.rowIndex][n.colIndex].cellIndex);if(c)a.selectNodeContents(c).setCursor(false,true)}}if(l.getAttribute("interlaced")==="enabled")this.fireEvent("interlacetable",l)}};UE.commands["insertcol"]={queryCommandState:function(e){var t=u(this),i=t.cell;return i&&(i.tagName=="TD"||i.tagName=="TH"&&i!==t.tr.cells[0])&&f(t.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(e){var t=this.selection.getRange(),i=t.createBookmark(true);if(this.queryCommandState(e)==-1)return;var n=u(this).cell,o=f(n),r=o.getCellInfo(n);if(!o.selectedTds.length){o.insertCol(r.colIndex,n)}else{var a=o.cellsRange;for(var s=0,l=a.endColIndex-a.beginColIndex+1;s<l;s++){o.insertCol(a.beginColIndex,n)}}t.moveToBookmark(i).select(true)}};UE.commands["insertcolnext"]={queryCommandState:function(){var e=u(this),t=e.cell;return t&&f(e.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(true);var i=u(this).cell,n=f(i),o=n.getCellInfo(i);if(!n.selectedTds.length){n.insertCol(o.colIndex+o.colSpan,i)}else{var r=n.cellsRange;for(var a=0,s=r.endColIndex-r.beginColIndex+1;a<s;a++){n.insertCol(r.endColIndex+1,i)}}e.moveToBookmark(t).select()}};UE.commands["deletecol"]={queryCommandState:function(){var e=u(this);return e.cell?0:-1},execCommand:function(){var e=u(this).cell,t=f(e),i=t.cellsRange,n=t.getCellInfo(e),o=t.getHSideCell(e),r=t.getHSideCell(e,true);if(utils.isEmptyObject(i)){t.deleteCol(n.colIndex)}else{for(var a=i.beginColIndex;a<i.endColIndex+1;a++){t.deleteCol(i.beginColIndex)}}var s=t.table,l=this.selection.getRange();if(!s.getElementsByTagName("td").length){var d=s.nextSibling;domUtils.remove(s);if(d){l.setStart(d,0).setCursor(false,true)}}else{if(domUtils.inDoc(e,this.document)){l.setStart(e,0).setCursor(false,true)}else{if(r&&domUtils.inDoc(r,this.document)){l.selectNodeContents(r).setCursor(false,true)}else{if(o&&domUtils.inDoc(o,this.document)){l.selectNodeContents(o).setCursor(true,true)}}}}}};UE.commands["splittocells"]={queryCommandState:function(){var e=u(this),t=e.cell;if(!t)return-1;var i=f(e.table);if(i.selectedTds.length>0)return-1;return t&&(t.colSpan>1||t.rowSpan>1)?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(true);var i=u(this).cell,n=f(i);n.splitToCells(i);e.moveToBookmark(t).select()}};UE.commands["splittorows"]={queryCommandState:function(){var e=u(this),t=e.cell;if(!t)return-1;var i=f(e.table);if(i.selectedTds.length>0)return-1;return t&&t.rowSpan>1?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(true);var i=u(this).cell,n=f(i);n.splitToRows(i);e.moveToBookmark(t).select()}};UE.commands["splittocols"]={queryCommandState:function(){var e=u(this),t=e.cell;if(!t)return-1;var i=f(e.table);if(i.selectedTds.length>0)return-1;return t&&t.colSpan>1?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(true);var i=u(this).cell,n=f(i);n.splitToCols(i);e.moveToBookmark(t).select()}};UE.commands["adaptbytext"]=UE.commands["adaptbywindow"]={queryCommandState:function(){return u(this).table?0:-1},execCommand:function(e){var t=u(this),i=t.table;if(i){if(e=="adaptbywindow"){o(i,this)}else{var n=domUtils.getElementsByTagName(i,"td th");utils.each(n,function(e){e.removeAttribute("width")});i.removeAttribute("width")}}}};UE.commands["averagedistributecol"]={queryCommandState:function(){var e=a(this);if(!e)return-1;return e.isFullRow()||e.isFullCol()?0:-1},execCommand:function(e){var d=this,c=a(d);function t(){var e=c.table,t,i=0,n=0,o=v(d,e);if(c.isFullRow()){i=e.offsetWidth;n=c.colsNum}else{var r=c.cellsRange.beginColIndex,a=c.cellsRange.endColIndex,s;for(var l=r;l<=a;){s=c.selectedTds[l];i+=s.offsetWidth;l+=s.colSpan;n+=1}}t=Math.ceil(i/n)-o.tdBorder*2-o.tdPadding*2;return t}function i(t){utils.each(domUtils.getElementsByTagName(c.table,"th"),function(e){e.setAttribute("width","")});var e=c.isFullRow()?domUtils.getElementsByTagName(c.table,"td"):c.selectedTds;utils.each(e,function(e){if(e.colSpan==1){e.setAttribute("width",t)}})}if(c&&c.selectedTds.length){i(t())}}};UE.commands["averagedistributerow"]={queryCommandState:function(){var e=a(this);if(!e)return-1;if(e.selectedTds&&/th/gi.test(e.selectedTds[0].tagName))return-1;return e.isFullRow()||e.isFullCol()?0:-1},execCommand:function(e){var p=this,g=a(p);function t(){var e,t,i=0,n=g.table,o=v(p,n),r=parseInt(domUtils.getComputedStyle(n.getElementsByTagName("td")[0],"padding-top"));if(g.isFullCol()){var a=domUtils.getElementsByTagName(n,"caption"),s=domUtils.getElementsByTagName(n,"th"),l,d;if(a.length>0){l=a[0].offsetHeight}if(s.length>0){d=s[0].offsetHeight}i=n.offsetHeight-(l||0)-(d||0);t=s.length==0?g.rowsNum:g.rowsNum-1}else{var c=g.cellsRange.beginRowIndex,u=g.cellsRange.endRowIndex,f=0,m=domUtils.getElementsByTagName(n,"tr");for(var h=c;h<=u;h++){i+=m[h].offsetHeight;f+=1}t=f}if(browser.ie&&browser.version<9){e=Math.ceil(i/t)}else{e=Math.ceil(i/t)-o.tdBorder*2-r*2}return e}function i(t){var e=g.isFullCol()?domUtils.getElementsByTagName(g.table,"td"):g.selectedTds;utils.each(e,function(e){if(e.rowSpan==1){e.setAttribute("height",t)}})}if(g&&g.selectedTds.length){i(t())}}};UE.commands["cellalignment"]={queryCommandState:function(){return u(this).table?0:-1},execCommand:function(e,t){var i=this,n=a(i);if(!n){var o=i.selection.getStart(),r=o&&domUtils.findParentByTagName(o,["td","th","caption"],true);if(!/caption/gi.test(r.tagName)){domUtils.setAttributes(r,t)}else{r.style.textAlign=t.align;r.style.verticalAlign=t.vAlign}i.selection.getRange().setCursor(true)}else{utils.each(n.selectedTds,function(e){domUtils.setAttributes(e,t)})}},queryCommandValue:function(e){var t=u(this).cell;if(!t){t=s(this)[0]}if(!t){return null}else{var i=UE.UETable.getUETable(t).selectedTds;!i.length&&(i=t);return UE.UETable.getTableCellAlignState(i)}}};UE.commands["tablealignment"]={queryCommandState:function(){if(browser.ie&&browser.version<8){return-1}return u(this).table?0:-1},execCommand:function(e,t){var i=this,n=i.selection.getStart(),o=n&&domUtils.findParentByTagName(n,["table"],true);if(o){o.setAttribute("align",t)}}};UE.commands["edittable"]={queryCommandState:function(){return u(this).table?0:-1},execCommand:function(e,t){var i=this.selection.getRange(),n=domUtils.findParentByTagName(i.startContainer,"table");if(n){var o=domUtils.getElementsByTagName(n,"td").concat(domUtils.getElementsByTagName(n,"th"),domUtils.getElementsByTagName(n,"caption"));utils.each(o,function(e){e.style.borderColor=t})}}};UE.commands["edittd"]={queryCommandState:function(){return u(this).table?0:-1},execCommand:function(e,t){var i=this,n=a(i);if(!n){var o=i.selection.getStart(),r=o&&domUtils.findParentByTagName(o,["td","th","caption"],true);if(r){r.style.backgroundColor=t}}else{utils.each(n.selectedTds,function(e){e.style.backgroundColor=t})}}};UE.commands["settablebackground"]={queryCommandState:function(){return s(this).length>1?0:-1},execCommand:function(e,t){var i,n;i=s(this);n=f(i[0]);n.setBackground(i,t)}};UE.commands["cleartablebackground"]={queryCommandState:function(){var e=s(this);if(!e.length)return-1;for(var t=0,i;i=e[t++];){if(i.style.backgroundColor!=="")return 0}return-1},execCommand:function(){var e=s(this),t=f(e[0]);t.removeBackground(e)}};UE.commands["interlacetable"]=UE.commands["uninterlacetable"]={queryCommandState:function(e){var t=u(this).table;if(!t)return-1;var i=t.getAttribute("interlaced");if(e=="interlacetable"){return i==="enabled"?-1:0}else{return!i||i==="disabled"?-1:0}},execCommand:function(e,t){var i=u(this).table;if(e=="interlacetable"){i.setAttribute("interlaced","enabled");this.fireEvent("interlacetable",i,t)}else{i.setAttribute("interlaced","disabled");this.fireEvent("uninterlacetable",i)}}};UE.commands["setbordervisible"]={queryCommandState:function(e){var t=u(this).table;if(!t)return-1;return 0},execCommand:function(){var e=u(this).table;utils.each(domUtils.getElementsByTagName(e,"td"),function(e){e.style.borderWidth="1px";e.style.borderStyle="solid"})}};function o(e,t){var i=domUtils.getElementsByTagName(e,"td th");utils.each(i,function(e){e.removeAttribute("width")});e.setAttribute("width",r(t,true,v(t,e)));var n=[];setTimeout(function(){utils.each(i,function(e){e.colSpan==1&&n.push(e.offsetWidth)});utils.each(i,function(e,t){e.colSpan==1&&e.setAttribute("width",n[t]+"")})},0)}function r(e,t,i){var n=e.body;return n.offsetWidth-(t?parseInt(domUtils.getComputedStyle(n,"margin-left"),10)*2:0)-i.tableBorder*2-(e.options.offsetWidth||0)}function s(e){var t=u(e).cell;if(t){var i=f(t);return i.selectedTds.length?i.selectedTds:[t]}else{return[]}}})();UE.plugins["table"]=function(){var d=this,e=null,t=null,u=null,l=5,f=false,r=5,a=10,m=0,h=null,p=360,T=UE.UETable,S=function(e){return T.getUETable(e)},k=function(e){return T.getUETableBySelected(e)},B=function(e,t){return T.getDefaultValue(e,t)},s=function(e){return T.removeSelectedClass(e)};function c(e){}d.ready(function(){var i=this;var n=i.selection.getText;i.selection.getText=function(){var e=k(i);if(e){var t="";utils.each(e.selectedTds,function(e){t+=e[browser.ie?"innerText":"textContent"]});return t}else{return n.call(i.selection)}}});var g=null,v=null,b="",y=false,o=null,C=false,w=null,x=null;var N=false,M=true;d.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:d.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:false,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]});d.getUETable=S;var H={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1};d.ready(function(){utils.cssRule("table",".selectTdClass{background-color:#edf5fa !important}"+"table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}"+"table{margin-bottom:10px;border-collapse:collapse;display:table;}"+"td,th{padding: 5px 10px;border: 1px solid #DDD;}"+"caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}"+"th{border-top:1px solid #BBB;background-color:#F7F7F7;}"+"table tr.firstRow th{border-top-width:2px;}"+".ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }"+"td p{margin:0;padding:0;}",d.document);var N,U,E;d.addListener("keydown",function(e,t){var i=this;var n=t.keyCode||t.which;if(n==8){var o=k(i);if(o&&o.selectedTds.length){if(o.isFullCol()){i.execCommand("deletecol")}else if(o.isFullRow()){i.execCommand("deleterow")}else{i.fireEvent("delcells")}domUtils.preventDefault(t)}var r=domUtils.findParentByTagName(i.selection.getStart(),"caption",true),a=i.selection.getRange();if(a.collapsed&&r&&z(r)){i.fireEvent("saveScene");var s=r.parentNode;domUtils.remove(r);if(s){a.setStart(s.rows[0].cells[0],0).setCursor(false,true)}i.fireEvent("saveScene")}}if(n==46){o=k(i);if(o){i.fireEvent("saveScene");for(var l=0,d;d=o.selectedTds[l++];){domUtils.fillNode(i.document,d)}i.fireEvent("saveScene");domUtils.preventDefault(t)}}if(n==13){var c=i.selection.getRange(),r=domUtils.findParentByTagName(c.startContainer,"caption",true);if(r){var s=domUtils.findParentByTagName(r,"table");if(!c.collapsed){c.deleteContents();i.fireEvent("saveScene")}else{if(r){c.setStart(s.rows[0].cells[0],0).setCursor(false,true)}}domUtils.preventDefault(t);return}if(c.collapsed){var s=domUtils.findParentByTagName(c.startContainer,"table");if(s){var u=s.rows[0].cells[0],f=domUtils.findParentByTagName(i.selection.getStart(),["td","th"],true),m=s.previousSibling;if(u===f&&(!m||m.nodeType==1&&m.tagName=="TABLE")&&domUtils.isStartInblock(c)){var h=domUtils.findParent(i.selection.getStart(),function(e){return domUtils.isBlockElm(e)},true);if(h&&(/t(h|d)/i.test(h.tagName)||h===f.firstChild)){i.execCommand("insertparagraphbeforetable");domUtils.preventDefault(t)}}}}}if((t.ctrlKey||t.metaKey)&&t.keyCode=="67"){N=null;var o=k(i);if(o){var p=o.selectedTds;U=o.isFullCol();E=o.isFullRow();N=[[o.cloneCell(p[0],null,true)]];for(var l=1,d;d=p[l];l++){if(d.parentNode!==p[l-1].parentNode){N.push([o.cloneCell(d,null,true)])}else{N[N.length-1].push(o.cloneCell(d,null,true))}}}}});d.addListener("tablehasdeleted",function(){O(this,false,"",null);if(o)domUtils.remove(o)});d.addListener("beforepaste",function(e,t){var i=this;var n=i.selection.getRange();if(domUtils.findParentByTagName(n.startContainer,"caption",true)){var o=i.document.createElement("div");o.innerHTML=t.html;t.html=o[browser.ie9below?"innerText":"textContent"];return}var r=k(i);if(N){i.fireEvent("saveScene");var n=i.selection.getRange();var a=domUtils.findParentByTagName(n.startContainer,["td","th"],true),s,l;if(a){var d=S(a);if(E){var c=d.getCellInfo(a).rowIndex;if(a.tagName=="TH"){c++}for(var u=0,f;f=N[u++];){var m=d.insertRow(c++,"td");for(var h=0,p;p=f[h];h++){var g=m.cells[h];if(!g){g=m.insertCell(h)}g.innerHTML=p.innerHTML;p.getAttribute("width")&&g.setAttribute("width",p.getAttribute("width"));p.getAttribute("vAlign")&&g.setAttribute("vAlign",p.getAttribute("vAlign"));p.getAttribute("align")&&g.setAttribute("align",p.getAttribute("align"));p.style.cssText&&(g.style.cssText=p.style.cssText)}for(var h=0,p;p=m.cells[h];h++){if(!f[h])break;p.innerHTML=f[h].innerHTML;f[h].getAttribute("width")&&p.setAttribute("width",f[h].getAttribute("width"));f[h].getAttribute("vAlign")&&p.setAttribute("vAlign",f[h].getAttribute("vAlign"));f[h].getAttribute("align")&&p.setAttribute("align",f[h].getAttribute("align"));f[h].style.cssText&&(p.style.cssText=f[h].style.cssText)}}}else{if(U){y=d.getCellInfo(a);var v=0;for(var h=0,f=N[0],p;p=f[h++];){v+=p.colSpan||1}i.__hasEnterExecCommand=true;for(u=0;u<v;u++){i.execCommand("insertcol")}i.__hasEnterExecCommand=false;a=d.table.rows[0].cells[y.cellIndex];if(a.tagName=="TH"){a=d.table.rows[1].cells[y.cellIndex]}}for(var u=0,f;f=N[u++];){s=a;for(var h=0,p;p=f[h++];){if(a){a.innerHTML=p.innerHTML;p.getAttribute("width")&&a.setAttribute("width",p.getAttribute("width"));p.getAttribute("vAlign")&&a.setAttribute("vAlign",p.getAttribute("vAlign"));p.getAttribute("align")&&a.setAttribute("align",p.getAttribute("align"));p.style.cssText&&(a.style.cssText=p.style.cssText);l=a;a=a.nextSibling}else{var b=p.cloneNode(true);domUtils.removeAttributes(b,["class","rowSpan","colSpan"]);l.parentNode.appendChild(b)}}a=d.getNextCell(s,true,true);if(!N[u])break;if(!a){var y=d.getCellInfo(s);d.table.insertRow(d.table.rows.length);d.update();a=d.getVSideCell(s,true)}}}d.update()}else{r=i.document.createElement("table");for(var u=0,f;f=N[u++];){var m=r.insertRow(r.rows.length);for(var h=0,p;p=f[h++];){b=T.cloneCell(p,null,true);domUtils.removeAttributes(b,["class"]);m.appendChild(b)}if(h==2&&b.rowSpan>1){b.rowSpan=1}}var C=B(i),w=i.body.offsetWidth-(M?parseInt(domUtils.getComputedStyle(i.body,"margin-left"),10)*2:0)-C.tableBorder*2-(i.options.offsetWidth||0);i.execCommand("insertHTML","<table  "+(U&&E?'width="'+w+'"':"")+">"+r.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}i.fireEvent("contentchange");i.fireEvent("saveScene");t.html="";return true}else{var o=i.document.createElement("div"),x;o.innerHTML=t.html;x=o.getElementsByTagName("table");if(domUtils.findParentByTagName(i.selection.getStart(),"table")){utils.each(x,function(e){domUtils.remove(e)});if(domUtils.findParentByTagName(i.selection.getStart(),"caption",true)){o.innerHTML=o[browser.ie?"innerText":"textContent"]}}else{utils.each(x,function(e){L(e,true);domUtils.removeAttributes(e,["style","border"]);utils.each(domUtils.getElementsByTagName(e,"td"),function(e){if(z(e)){domUtils.fillNode(i.document,e)}L(e,true)})})}t.html=o.innerHTML}});d.addListener("afterpaste",function(){utils.each(domUtils.getElementsByTagName(d.body,"table"),function(e){if(e.offsetWidth>d.body.offsetWidth){var t=B(d,e);e.style.width=d.body.offsetWidth-(M?parseInt(domUtils.getComputedStyle(d.body,"margin-left"),10)*2:0)-t.tableBorder*2-(d.options.offsetWidth||0)+"px"}})});d.addListener("blur",function(){N=null});var e;d.addListener("keydown",function(){clearTimeout(e);e=setTimeout(function(){var e=d.selection.getRange(),t=domUtils.findParentByTagName(e.startContainer,["th","td"],true);if(t){var i=t.parentNode.parentNode.parentNode;if(i.offsetWidth>i.getAttribute("width")){t.style.wordBreak="break-all"}}},100)});d.addListener("selectionchange",function(){O(d,false,"",null)});d.addListener("contentchange",function(){var d=this;he(d);if(k(d))return;var e=d.selection.getRange();var t=e.startContainer;t=domUtils.findParentByTagName(t,["td","th"],true);utils.each(domUtils.getElementsByTagName(d.document,"table"),function(e){if(d.fireEvent("excludetable",e)===true)return;e.ueTable=new T(e);e.onmouseover=function(){d.fireEvent("tablemouseover",e)};e.onmousemove=function(){d.fireEvent("tablemousemove",e);d.options.tableDragable&&I(true,this,d);utils.defer(function(){d.fireEvent("contentchange",50)},true)};e.onmouseout=function(){d.fireEvent("tablemouseout",e);O(d,false,"",null);he(d)};e.onclick=function(e){e=d.window.event||e;var t=A(e.target||e.srcElement);if(!t)return;var i=S(t),n=i.table,o=i.getCellInfo(t),r,a=d.selection.getRange();if(R(n,t,e,true)){var s=i.getCell(i.indexTable[i.rowsNum-1][o.colIndex].rowIndex,i.indexTable[i.rowsNum-1][o.colIndex].cellIndex);if(e.shiftKey&&i.selectedTds.length){if(i.selectedTds[0]!==s){r=i.getCellsRange(i.selectedTds[0],s);i.setSelected(r)}else{a&&a.selectNodeContents(s).select()}}else{if(t!==s){r=i.getCellsRange(t,s);i.setSelected(r)}else{a&&a.selectNodeContents(s).select()}}return}if(R(n,t,e)){var l=i.getCell(i.indexTable[o.rowIndex][i.colsNum-1].rowIndex,i.indexTable[o.rowIndex][i.colsNum-1].cellIndex);if(e.shiftKey&&i.selectedTds.length){if(i.selectedTds[0]!==l){r=i.getCellsRange(i.selectedTds[0],l);i.setSelected(r)}else{a&&a.selectNodeContents(l).select()}}else{if(t!==l){r=i.getCellsRange(t,l);i.setSelected(r)}else{a&&a.selectNodeContents(l).select()}}}}});ge(d,true)});domUtils.on(d.document,"mousemove",n);domUtils.on(d.document,"mouseout",function(e){var t=e.target||e.srcElement;if(t.tagName=="TABLE"){O(d,false,"",null)}});d.addListener("interlacetable",function(e,t,i){if(!t)return;var n=this,o=t.rows,r=o.length,a=function(e,t,i){return e[t]?e[t]:i?e[t%e.length]:""};for(var s=0;s<r;s++){o[s].className=a(i||n.options.classList,s,true)}});d.addListener("uninterlacetable",function(e,t){if(!t)return;var i=this,n=t.rows,o=i.options.classList,r=n.length;for(var a=0;a<r;a++){domUtils.removeClasses(n[a],o)}});d.addListener("mousedown",W);d.addListener("mouseup",ee);domUtils.on(d.body,"dragstart",function(e){ee.call(d,"dragstart",e)});d.addOutputRule(function(e){utils.each(e.getNodesByTagName("div"),function(e){if(e.getAttr("id")=="ue_tableDragLine"){e.parentNode.removeChild(e)}})});var a=0;d.addListener("mousedown",function(){a=0});d.addListener("tabkeydown",function(){var e=this.selection.getRange(),t=e.getCommonAncestor(true,true),i=domUtils.findParentByTagName(t,"table");if(i){if(domUtils.findParentByTagName(t,"caption",true)){var n=domUtils.getElementsByTagName(i,"th td");if(n&&n.length){e.setStart(n[0],0).setCursor(false,true)}}else{var n=domUtils.findParentByTagName(t,["td","th"],true),o=S(n);a=n.rowSpan>1?a:o.getCellInfo(n).rowIndex;var r=o.getTabNextCell(n,a);if(r){if(z(r)){e.setStart(r,0).setCursor(false,true)}else{e.selectNodeContents(r).select()}}else{d.fireEvent("saveScene");d.__hasEnterExecCommand=true;this.execCommand("insertrownext");d.__hasEnterExecCommand=false;e=this.selection.getRange();e.setStart(i.rows[i.rows.length-1].cells[0],0).setCursor();d.fireEvent("saveScene")}}return true}});browser.ie&&d.addListener("selectionchange",function(){O(this,false,"",null)});d.addListener("keydown",function(e,t){var i=this;var n=t.keyCode||t.which;if(n==8||n==46){return}var o=!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey;o&&s(domUtils.getElementsByTagName(i.body,"td"));var r=k(i);if(!r)return;o&&r.clearSelected()});d.addListener("beforegetcontent",function(){ge(this,false);browser.ie&&utils.each(this.document.getElementsByTagName("caption"),function(e){if(domUtils.isEmptyNode(e)){e.innerHTML="&nbsp;"}})});d.addListener("aftergetcontent",function(){ge(this,true)});d.addListener("getAllHtml",function(){s(d.document.getElementsByTagName("td"))});d.addListener("fullscreenchanged",function(e,t){if(!t){var r=this.body.offsetWidth/document.body.offsetWidth,i=domUtils.getElementsByTagName(this.body,"table");utils.each(i,function(e){if(e.offsetWidth<d.body.offsetWidth)return false;var t=domUtils.getElementsByTagName(e,"td"),i=[];utils.each(t,function(e){i.push(e.offsetWidth)});for(var n=0,o;o=t[n];n++){o.setAttribute("width",Math.floor(i[n]*r))}e.setAttribute("width",Math.floor(ve(d,M,B(d))))})}});var p=d.execCommand;d.execCommand=function(e,t){var i=this,n=arguments;e=e.toLowerCase();var o=k(i),r,a=new dom.Range(i.document),s=i.commands[e]||UE.commands[e],l;if(!s)return;if(o&&!H[e]&&!s.notNeedUndo&&!i.__hasEnterExecCommand){i.__hasEnterExecCommand=true;i.fireEvent("beforeexeccommand",e);r=o.selectedTds;var d=-2,c=-2,u,f;for(var m=0,h;h=r[m];m++){if(z(h)){a.setStart(h,0).setCursor(false,true)}else{a.selectNode(h).select(true)}f=i.queryCommandState(e);u=i.queryCommandValue(e);if(f!=-1){if(d!==f||c!==u){i._ignoreContentChange=true;l=p.apply(i,arguments);i._ignoreContentChange=false}d=i.queryCommandState(e);c=i.queryCommandValue(e);if(domUtils.isEmptyBlock(h)){domUtils.fillNode(i.document,h)}}}a.setStart(r[0],0).shrinkBoundary(true).setCursor(false,true);i.fireEvent("contentchange");i.fireEvent("afterexeccommand",e);i.__hasEnterExecCommand=false;i._selectionChange()}else{l=p.apply(i,arguments)}return l}});function L(e,t){i(e,"width",true);i(e,"height",true)}function i(e,t,i){if(e.style[t]){i&&e.setAttribute(t,parseInt(e.style[t],10));e.style[t]=""}}function A(e){if(e.tagName=="TD"||e.tagName=="TH")return e;var t;if(t=domUtils.findParentByTagName(e,"td",true)||domUtils.findParentByTagName(e,"th",true))return t;return null}function z(e){var t=new RegExp(domUtils.fillChar,"g");if(e[browser.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(t,"").length>0){return 0}for(var i in dtd.$isNotEmpty){if(e.getElementsByTagName(i).length){return 0}}return 1}function U(e){if(e.pageX||e.pageY){return{x:e.pageX,y:e.pageY}}return{x:e.clientX+d.document.body.scrollLeft-d.document.body.clientLeft,y:e.clientY+d.document.body.scrollTop-d.document.body.clientTop}}function n(e){if(re()){return}try{var t=A(e.target||e.srcElement),i;if(f){d.body.style.webkitUserSelect="none";if(Math.abs(h.x-e.clientX)>a||Math.abs(h.y-e.clientY)>a){K();f=false;m=0;Q(e)}}if(b&&x){m=0;d.body.style.webkitUserSelect="none";d.selection.getNative()[browser.ie9below?"empty":"removeAllRanges"]();i=U(e);O(d,true,b,i,t);if(b=="h"){w.style.left=D(x,e)+"px"}else if(b=="v"){w.style.top=V(x,e)+"px"}return}if(t){if(d.fireEvent("excludetable",t)===true)return;i=U(e);var n=q(t,i),o=domUtils.findParentByTagName(t,"table",true);if(R(o,t,e,true)){if(d.fireEvent("excludetable",o)===true)return;d.body.style.cursor="url("+d.options.cursorpath+"h.png),pointer"}else if(R(o,t,e)){if(d.fireEvent("excludetable",o)===true)return;d.body.style.cursor="url("+d.options.cursorpath+"v.png),pointer"}else{d.body.style.cursor="text";var r=t;if(/\d/.test(n)){n=n.replace(/\d/,"");t=S(t).getPreviewCell(t,n=="v")}O(d,t?!!n:false,t?n:"",i,t)}}else{I(false,o,d)}}catch(e){c(e)}}var E;function I(e,t,i){if(!e){if(C)return;E=setTimeout(function(){!C&&o&&o.parentNode&&o.parentNode.removeChild(o)},2e3)}else{_(t,i)}}function _(r,a){var e=domUtils.getXY(r),t=r.ownerDocument;if(o&&o.parentNode)return o;o=t.createElement("div");o.contentEditable=false;o.innerHTML="";o.style.cssText="width:15px;height:15px;background-image:url("+a.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(e.y-15)+"px;left:"+e.x+"px;";domUtils.unSelectable(o);o.onmouseover=function(e){C=true};o.onmouseout=function(e){C=false};domUtils.on(o,"click",function(e,t){i(t,this)});domUtils.on(o,"dblclick",function(e,t){n(t)});domUtils.on(o,"dragstart",function(e,t){domUtils.preventDefault(t)});var s;function i(e,t){clearTimeout(s);s=setTimeout(function(){a.fireEvent("tableClicked",r,t)},300)}function n(e){clearTimeout(s);var t=S(r),i=r.rows[0].cells[0],n=t.getLastCell(),o=t.getCellsRange(i,n);a.selection.getRange().setStart(i,0).setCursor(false,true);t.setSelected(o)}t.body.appendChild(o)}function R(e,t,i,n){var o=U(i),r=q(t,o);if(n){var a=e.getElementsByTagName("caption")[0],s=a?a.offsetHeight:0;return r=="v1"&&o.y-domUtils.getXY(e).y-s<8}else{return r=="h1"&&o.x-domUtils.getXY(e).x<8}}function D(e,t){var i=S(e);if(i){var n=i.getSameEndPosCells(e,"x")[0],o=i.getSameStartPosXCells(e)[0],r=U(t).x,a=(n?domUtils.getXY(n).x:domUtils.getXY(i.table).x)+20,s=o?domUtils.getXY(o).x+o.offsetWidth-20:d.body.offsetWidth+5||parseInt(domUtils.getComputedStyle(d.body,"width"),10);a+=l;s-=l;return r<a?a:r>s?s:r}}function V(e,t){try{var i=domUtils.getXY(e).y,n=U(t).y;return n<i?i:n}catch(e){c(e)}}function O(e,t,i,n,o){try{e.body.style.cursor=i=="h"?"col-resize":i=="v"?"row-resize":"text";if(browser.ie){if(i&&!N&&!k(e)){me(e,e.document);pe(i,o)}else{he(e)}}y=t}catch(e){c(e)}}function P(){var e="_UETableResizeLine",t=this.document.getElementById(e);if(!t){t=this.document.createElement("div");t.id=e;t.contnetEditable=false;t.setAttribute("unselectable","on");var i={width:2*r+1+"px",position:"absolute","z-index":1e5,cursor:"col-resize",background:"red",display:"none"};t.onmouseout=function(){this.style.display="none"};utils.extend(t.style,i);this.document.body.appendChild(t)}return t}function F(e,t){var i=P.call(this),n=t.table,o={top:domUtils.getXY(n).y+"px",left:domUtils.getXY(e).x+e.offsetWidth-r+"px",display:"block",height:n.offsetHeight+"px"};utils.extend(i.style,o)}function $(e){var t=S(e);F.call(this,e,t)}function q(e,t){var i=domUtils.getXY(e);if(!i){return""}if(i.x+e.offsetWidth-t.x<r){return"h"}if(t.x-i.x<r){return"h1"}if(i.y+e.offsetHeight-t.y<r){return"v"}if(t.y-i.y<r){return"v1"}return""}function W(e,t){if(re()){return}h={x:t.clientX,y:t.clientY};if(t.button==2){var i=k(d),n=false;if(i){var o=be(d,t);utils.each(i.selectedTds,function(e){if(e===o){n=true}});if(!n){s(domUtils.getElementsByTagName(d.body,"th td"));i.clearSelected()}else{o=i.selectedTds[0];setTimeout(function(){d.selection.getRange().setStart(o,0).setCursor(false,true)},0)}}}else{X(t)}}function j(){e&&clearTimeout(e);e=null}function Z(e){m=0;e=e||d.window.event;var t=A(e.target||e.srcElement);if(t){var i;if(i=q(t,U(e))){he(d);if(i=="h1"){i="h";if(R(domUtils.findParentByTagName(t,"table"),t,e)){d.execCommand("adaptbywindow")}else{t=S(t).getPreviewCell(t);if(t){var n=d.selection.getRange();n.selectNodeContents(t).setCursor(true,true)}}}if(i=="h"){var o=S(t),r=o.table,a=se(t,r,true);a=G(a,"left");o.width=o.offsetWidth;var s=[],l=[];utils.each(a,function(e){s.push(e.offsetWidth)});utils.each(a,function(e){e.removeAttribute("width")});window.setTimeout(function(){var n=true;utils.each(a,function(e,t){var i=e.offsetWidth;if(i>s[t]){n=false;return false}l.push(i)});var i=n?l:s;utils.each(a,function(e,t){e.width=i[t]-fe()})},0)}}}}function X(e){s(domUtils.getElementsByTagName(d.body,"td th"));utils.each(d.document.getElementsByTagName("table"),function(e){e.ueTable=null});g=be(d,e);if(!g)return;var t=domUtils.findParentByTagName(g,"table",true);ut=S(t);ut&&ut.clearSelected();if(!y){d.document.body.style.webkitUserSelect="";N=true;d.addListener("mouseover",te)}else{Y(e)}}function Y(e){if(browser.ie){e=J(e)}K();f=true;t=setTimeout(function(){Q(e)},p)}function G(e,t){var i=[],n=null;for(var o=0,r=e.length;o<r;o++){n=e[o][t];if(n){i.push(n)}}return i}function K(){t&&clearTimeout(t);t=null}function J(e){var t=["pageX","pageY","clientX","clientY","srcElement","target"],i={};if(e){for(var n=0,o,r;o=t[n];n++){r=e[o];r&&(i[o]=r)}}return i}function Q(e){f=false;g=e.target||e.srcElement;if(!g)return;var t=q(g,U(e));if(/\d/.test(t)){t=t.replace(/\d/,"");g=S(g).getPreviewCell(g,t=="v")}he(d);me(d,d.document);d.fireEvent("saveScene");pe(t,g);N=true;b=t;x=g}function ee(e,t){if(re()){return}K();f=false;if(y){m=++m%3;h={x:t.clientX,y:t.clientY};u=setTimeout(function(){m>0&&m--},p);if(m===2){m=0;Z(t);return}}if(t.button==2)return;var i=this;var n=i.selection.getRange(),o=domUtils.findParentByTagName(n.startContainer,"table",true),r=domUtils.findParentByTagName(n.endContainer,"table",true);if(o||r){if(o===r){o=domUtils.findParentByTagName(n.startContainer,["td","th","caption"],true);r=domUtils.findParentByTagName(n.endContainer,["td","th","caption"],true);if(o!==r){i.selection.clearRange()}}else{i.selection.clearRange()}}N=false;i.document.body.style.webkitUserSelect="";if(b&&x){i.selection.getNative()[browser.ie9below?"empty":"removeAllRanges"]();m=0;w=i.document.getElementById("ue_tableDragLine");if(w){var a=domUtils.getXY(x),s=domUtils.getXY(w);switch(b){case"h":oe(x,s.x-a.x);break;case"v":ae(x,s.y-a.y-x.offsetHeight);break;default:}b="";x=null;he(i);i.fireEvent("saveScene");return}}if(!g){var l=domUtils.findParentByTagName(t.target||t.srcElement,"td",true);if(!l)l=domUtils.findParentByTagName(t.target||t.srcElement,"th",true);if(l&&(l.tagName=="TD"||l.tagName=="TH")){if(i.fireEvent("excludetable",l)===true)return;n=new dom.Range(i.document);n.setStart(l,0).setCursor(false,true)}}else{var d=S(g),c=d?d.selectedTds[0]:null;if(c){n=new dom.Range(i.document);if(domUtils.isEmptyBlock(c)){n.setStart(c,0).setCursor(false,true)}else{n.selectNodeContents(c).shrinkBoundary().setCursor(false,true)}}else{n=i.selection.getRange().shrinkBoundary();if(!n.collapsed){var o=domUtils.findParentByTagName(n.startContainer,["td","th"],true),r=domUtils.findParentByTagName(n.endContainer,["td","th"],true);if(o&&!r||!o&&r||o&&r&&o!==r){n.setCursor(false,true)}}}g=null;i.removeListener("mouseover",te)}i._selectionChange(250,t)}function te(e,t){if(re()){return}var i=this,n=t.target||t.srcElement;v=domUtils.findParentByTagName(n,"td",true)||domUtils.findParentByTagName(n,"th",true);if(g&&v&&(g.tagName=="TD"&&v.tagName=="TD"||g.tagName=="TH"&&v.tagName=="TH")&&domUtils.findParentByTagName(g,"table")==domUtils.findParentByTagName(v,"table")){var o=S(v);if(g!=v){i.document.body.style.webkitUserSelect="none";i.selection.getNative()[browser.ie9below?"empty":"removeAllRanges"]();var r=o.getCellsRange(g,v);o.setSelected(r)}else{i.document.body.style.webkitUserSelect="";o.clearSelected()}}t.preventDefault?t.preventDefault():t.returnValue=false}function ie(e,t,i){var n=parseInt(domUtils.getComputedStyle(e,"line-height"),10),o=i+t;t=o<n?n:o;if(e.style.height)e.style.height="";e.rowSpan==1?e.setAttribute("height",t):e.removeAttribute&&e.removeAttribute("height")}function ne(e){if(!e)return 0;return parseInt(domUtils.getComputedStyle(e,"width"),10)}function oe(e,t){var i=S(e);if(i){var n=i.table,o=se(e,n);n.style.width="";n.removeAttribute("width");t=de(t,e,o);if(e.nextSibling){var r=0;utils.each(o,function(e){e.left.width=+e.left.width+t;e.right&&(e.right.width=+e.right.width-t)})}else{utils.each(o,function(e){e.left.width-=-t})}}}function re(){return d.body.contentEditable==="false"}function ae(e,t){if(Math.abs(t)<10)return;var i=S(e);if(i){var n=i.getSameEndPosCells(e,"y"),o=n[0]?n[0].offsetHeight:0;for(var r=0,a;a=n[r++];){ie(a,t,o)}}}function se(e,t,n){if(!t){t=domUtils.findParentByTagName(e,"table")}if(!t){return null}var i=domUtils.getNodeIndex(e),o=e,r=t.rows,a=0;while(o){if(o.nodeType===1){a+=o.colSpan||1}o=o.previousSibling}o=null;var s=[];utils.each(r,function(e){var t=e.cells,i=0;utils.each(t,function(e){i+=e.colSpan||1;if(i===a){s.push({left:e,right:e.nextSibling||null});return false}else if(i>a){if(n){s.push({left:e})}return false}})});return s}function le(e){var t=Number.MAX_VALUE;for(var i=0,n;n=e[i];i++){t=Math.min(t,n.width||ce(n))}return t}function de(i,e,t){i-=fe();if(i<0){return 0}i-=ce(e);var n=i<0?"left":"right";i=Math.abs(i);utils.each(t,function(e){var t=e[n];if(t){i=Math.min(i,ce(t)-l)}});i=i<0?0:i;return n==="left"?-i:i}function ce(e){var t=0,i=0,t=e.offsetWidth-fe();if(!e.nextSibling){t-=ue(e)}t=t<0?0:t;try{e.width=t}catch(e){}return t}function ue(e){tab=domUtils.findParentByTagName(e,"table",false);if(tab.offsetVal===undefined){var t=e.previousSibling;if(t){tab.offsetVal=e.offsetWidth-t.offsetWidth===T.borderWidth?T.borderWidth:0}else{tab.offsetVal=0}}return tab.offsetVal}function fe(){if(T.tabcellSpace===undefined){var e=null,t=d.document.createElement("table"),i=d.document.createElement("tbody"),n=d.document.createElement("tr"),o=d.document.createElement("td"),r=null;o.style.cssText="border: 0;";o.width=1;n.appendChild(o);n.appendChild(r=o.cloneNode(false));i.appendChild(n);t.appendChild(i);t.style.cssText="visibility: hidden;";d.body.appendChild(t);T.paddingSpace=o.offsetWidth-1;var a=t.offsetWidth;o.style.cssText="";r.style.cssText="";T.borderWidth=(t.offsetWidth-a)/3;T.tabcellSpace=T.paddingSpace+T.borderWidth;d.body.removeChild(t)}fe=function(){return T.tabcellSpace};return T.tabcellSpace}function me(e,t){if(N)return;w=e.document.createElement("div");domUtils.setAttributes(w,{id:"ue_tableDragLine",unselectable:"on",contenteditable:false,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"});e.body.appendChild(w)}function he(e){if(N)return;var t;while(t=e.document.getElementById("ue_tableDragLine")){domUtils.remove(t)}}function pe(e,t){if(!t)return;var i=domUtils.findParentByTagName(t,"table"),n=i.getElementsByTagName("caption"),o=i.offsetWidth,r=i.offsetHeight-(n.length>0?n[0].offsetHeight:0),a=domUtils.getXY(i),s=domUtils.getXY(t),l;switch(e){case"h":l="height:"+r+"px;top:"+(a.y+(n.length>0?n[0].offsetHeight:0))+"px;left:"+(s.x+t.offsetWidth);w.style.cssText=l+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":l="width:"+o+"px;left:"+a.x+"px;top:"+(s.y+t.offsetHeight);w.style.cssText=l+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)";break;default:}}function ge(e,t){var i=domUtils.getElementsByTagName(e.body,"table"),n;for(var o=0,r;r=i[o++];){var a=domUtils.getElementsByTagName(r,"td");if(a[0]){if(t){n=a[0].style.borderColor.replace(/\s/g,"");if(/(#ffffff)|(rgb\(255,255,255\))/gi.test(n))domUtils.addClass(r,"noBorderTable")}else{domUtils.removeClasses(r,"noBorderTable")}}}}function ve(e,t,i){var n=e.body;return n.offsetWidth-(t?parseInt(domUtils.getComputedStyle(n,"margin-left"),10)*2:0)-i.tableBorder*2-(e.options.offsetWidth||0)}function be(e,t){var i=domUtils.findParentByTagName(t.target||t.srcElement,["td","th"],true),n=null;if(!i){return null}n=q(i,U(t));if(!i){return null}if(n==="h1"&&i.previousSibling){var o=domUtils.getXY(i),r=i.offsetWidth;if(Math.abs(o.x+r-t.clientX)>r/3){i=i.previousSibling}}else if(n==="v1"&&i.parentNode.previousSibling){var o=domUtils.getXY(i),a=i.offsetHeight;if(Math.abs(o.y+a-t.clientY)>a/3){i=i.parentNode.previousSibling.firstChild}}return i&&!(e.fireEvent("excludetable",i)===true)?i:null}};UE.UETable.prototype.sortTable=function(n,o){var e=this.table,t=e.rows,i=[],r=t[0].cells[0].tagName==="TH",a=0;if(this.selectedTds.length){var s=this.cellsRange,l=s.endRowIndex+1;for(var d=s.beginRowIndex;d<l;d++){i[d]=t[d]}i.splice(0,s.beginRowIndex);a=s.endRowIndex+1===this.rowsNum?0:s.endRowIndex+1}else{for(var d=0,l=t.length;d<l;d++){i[d]=t[d]}}var c={reversecurrent:function(e,t){return 1},orderbyasc:function(e,t){var i=e.innerText||e.textContent,n=t.innerText||t.textContent;return i.localeCompare(n)},reversebyasc:function(e,t){var i=e.innerHTML,n=t.innerHTML;return n.localeCompare(i)},orderbynum:function(e,t){var i=e[browser.ie?"innerText":"textContent"].match(/\d+/),n=t[browser.ie?"innerText":"textContent"].match(/\d+/);if(i)i=+i[0];if(n)n=+n[0];return(i||0)-(n||0)},reversebynum:function(e,t){var i=e[browser.ie?"innerText":"textContent"].match(/\d+/),n=t[browser.ie?"innerText":"textContent"].match(/\d+/);if(i)i=+i[0];if(n)n=+n[0];return(n||0)-(i||0)}};e.setAttribute("data-sort-type",o&&typeof o==="string"&&c[o]?o:"");r&&i.splice(0,1);i=utils.sort(i,function(e,t){var i;if(o&&typeof o==="function"){i=o.call(this,e.cells[n],t.cells[n])}else if(o&&typeof o==="number"){i=1}else if(o&&typeof o==="string"&&c[o]){i=c[o].call(this,e.cells[n],t.cells[n])}else{i=c["orderbyasc"].call(this,e.cells[n],t.cells[n])}return i});var u=e.ownerDocument.createDocumentFragment();for(var f=0,l=i.length;f<l;f++){u.appendChild(i[f])}var m=e.getElementsByTagName("tbody")[0];if(!a){m.appendChild(u)}else{m.insertBefore(u,t[a-s.endRowIndex+s.beginRowIndex-1])}};UE.plugins["tablesort"]=function(){var e=this,t=UE.UETable,d=function(e){return t.getUETable(e)},c=function(e){return t.getTableItemsByRange(e)};e.ready(function(){utils.cssRule("tablesort","table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;"+"   background-image:url("+e.options.themePath+e.options.theme+"/images/sortable.png);}",e.document);e.addListener("afterexeccommand",function(e,t){if(t=="mergeright"||t=="mergedown"||t=="mergecells"){this.execCommand("disablesort")}})});UE.commands["sorttable"]={queryCommandState:function(){var e=this,t=c(e);if(!t.cell)return-1;var i=t.table,n=i.getElementsByTagName("td");for(var o=0,r;r=n[o++];){if(r.rowSpan!=1||r.colSpan!=1)return-1}return 0},execCommand:function(e,t){var i=this,n=i.selection.getRange(),o=n.createBookmark(true),r=c(i),a=r.cell,s=d(r.table),l=s.getCellInfo(a);s.sortTable(l.cellIndex,t);n.moveToBookmark(o);try{n.select()}catch(e){}}};UE.commands["enablesort"]=UE.commands["disablesort"]={queryCommandState:function(e){var t=c(this).table;if(t&&e=="enablesort"){var i=domUtils.getElementsByTagName(t,"th td");for(var n=0;n<i.length;n++){if(i[n].getAttribute("colspan")>1||i[n].getAttribute("rowspan")>1)return-1}}return!t?-1:e=="enablesort"^t.getAttribute("data-sort")!="sortEnabled"?-1:0},execCommand:function(e){var t=c(this).table;t.setAttribute("data-sort",e=="enablesort"?"sortEnabled":"sortDisabled");e=="enablesort"?domUtils.addClass(t,"sortEnabled"):domUtils.removeClasses(t,"sortEnabled")}}};UE.plugins["contextmenu"]=function(){var d=this;d.setOpt("enableContextMenu",d.getOpt("enableContextMenu")||true);if(d.getOpt("enableContextMenu")===false){return}var c=d.getLang("contextMenu"),u,f=d.options.contextMenu||[{label:c["selectall"],cmdName:"selectall"},{label:c.cleardoc,cmdName:"cleardoc",exec:function(){if(confirm(c.confirmclear)){this.execCommand("cleardoc")}}},"-",{label:c.unlink,cmdName:"unlink"},"-",{group:c.paragraph,icon:"justifyjustify",subMenu:[{label:c.justifyleft,cmdName:"justify",value:"left"},{label:c.justifyright,cmdName:"justify",value:"right"},{label:c.justifycenter,cmdName:"justify",value:"center"},{label:c.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:c.table,icon:"table",subMenu:[{label:c.inserttable,cmdName:"inserttable"},{label:c.deletetable,cmdName:"deletetable"},"-",{label:c.deleterow,cmdName:"deleterow"},{label:c.deletecol,cmdName:"deletecol"},{label:c.insertcol,cmdName:"insertcol"},{label:c.insertcolnext,cmdName:"insertcolnext"},{label:c.insertrow,cmdName:"insertrow"},{label:c.insertrownext,cmdName:"insertrownext"},"-",{label:c.insertcaption,cmdName:"insertcaption"},{label:c.deletecaption,cmdName:"deletecaption"},{label:c.inserttitle,cmdName:"inserttitle"},{label:c.deletetitle,cmdName:"deletetitle"},{label:c.inserttitlecol,cmdName:"inserttitlecol"},{label:c.deletetitlecol,cmdName:"deletetitlecol"},"-",{label:c.mergecells,cmdName:"mergecells"},{label:c.mergeright,cmdName:"mergeright"},{label:c.mergedown,cmdName:"mergedown"},"-",{label:c.splittorows,cmdName:"splittorows"},{label:c.splittocols,cmdName:"splittocols"},{label:c.splittocells,cmdName:"splittocells"},"-",{label:c.averageDiseRow,cmdName:"averagedistributerow"},{label:c.averageDisCol,cmdName:"averagedistributecol"},"-",{label:c.edittd,cmdName:"edittd",exec:function(){if(UE.ui["edittd"]){new UE.ui["edittd"](this)}this.getDialog("edittd").open()}},{label:c.edittable,cmdName:"edittable",exec:function(){if(UE.ui["edittable"]){new UE.ui["edittable"](this)}this.getDialog("edittable").open()}},{label:c.setbordervisible,cmdName:"setbordervisible"}]},{group:c.tablesort,icon:"tablesort",subMenu:[{label:c.enablesort,cmdName:"enablesort"},{label:c.disablesort,cmdName:"disablesort"},"-",{label:c.reversecurrent,cmdName:"sorttable",value:"reversecurrent"},{label:c.orderbyasc,cmdName:"sorttable",value:"orderbyasc"},{label:c.reversebyasc,cmdName:"sorttable",value:"reversebyasc"},{label:c.orderbynum,cmdName:"sorttable",value:"orderbynum"},{label:c.reversebynum,cmdName:"sorttable",value:"reversebynum"}]},{group:c.borderbk,icon:"borderBack",subMenu:[{label:c.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:c.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:c.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:true,colorList:["#bbb","#ccc"]})}},{label:c.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},{label:c.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:true,colorList:["red","blue"]})}},{label:c.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:true,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:c.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:c.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:c.tableleft,value:"left"},{cmdName:"tablealignment",className:"center",label:c.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:c.tableright,value:"right"}]},"-",{label:c.insertparagraphbefore,cmdName:"insertparagraph",value:true},{label:c.insertparagraphafter,cmdName:"insertparagraph"},{label:c["copy"],cmdName:"copy"},{label:c["paste"],cmdName:"paste"}];if(!f.length){return}var m=UE.ui.uiUtils;d.addListener("contextmenu",function(e,t){var i=m.getViewportOffsetByEvent(t);d.fireEvent("beforeselectionchange");if(u){u.destroy()}for(var n=0,o,r=[];o=f[n];n++){var a;(function(e){if(e=="-"){if((a=r[r.length-1])&&a!=="-"){r.push("-")}}else if(e.hasOwnProperty("group")){for(var t=0,i,n=[];i=e.subMenu[t];t++){(function(e){if(e=="-"){if((a=n[n.length-1])&&a!=="-"){n.push("-")}else{n.splice(n.length-1)}}else{if((d.commands[e.cmdName]||UE.commands[e.cmdName]||e.query)&&(e.query?e.query():d.queryCommandState(e.cmdName))>-1){n.push({label:e.label||d.getLang("contextMenu."+e.cmdName+(e.value||""))||"",className:"edui-for-"+e.cmdName+(e.className?" edui-for-"+e.cmdName+"-"+e.className:""),onclick:e.exec?function(){e.exec.call(d)}:function(){d.execCommand(e.cmdName,e.value)}})}}})(i)}if(n.length){function o(){switch(e.icon){case"table":return d.getLang("contextMenu.table");case"justifyjustify":return d.getLang("contextMenu.paragraph");case"aligntd":return d.getLang("contextMenu.aligntd");case"aligntable":return d.getLang("contextMenu.aligntable");case"tablesort":return c.tablesort;case"borderBack":return c.borderbk;default:return""}}r.push({label:o(),className:"edui-for-"+e.icon,subMenu:{items:n,editor:d}})}}else{if((d.commands[e.cmdName]||UE.commands[e.cmdName]||e.query)&&(e.query?e.query.call(d):d.queryCommandState(e.cmdName))>-1){r.push({label:e.label||d.getLang("contextMenu."+e.cmdName),className:"edui-for-"+(e.icon?e.icon:e.cmdName+(e.value||"")),onclick:e.exec?function(){e.exec.call(d)}:function(){d.execCommand(e.cmdName,e.value)}})}}})(o)}if(r[r.length-1]=="-"){r.pop()}u=new UE.ui.Menu({items:r,className:"edui-contextmenu",editor:d});u.render();u.showAt(i);d.fireEvent("aftershowcontextmenu",u);domUtils.preventDefault(t);if(browser.ie){var s;try{s=d.selection.getNative().createRange()}catch(e){return}if(s.item){var l=new dom.Range(d.document);l.selectNode(s.item(0)).select(true,true)}}});d.addListener("aftershowcontextmenu",function(e,t){if(d.zeroclipboard){var i=t.items;for(var n in i){if(i[n].className=="edui-for-copy"){d.zeroclipboard.clip(i[n].getDom())}}}})};UE.plugins["shortcutmenu"]=function(){var e=this,a,s=e.options.shortcutMenu||[];if(!s.length){return}e.addListener("contextmenu mouseup",function(t,e){var i=this,n={type:t,target:e.target||e.srcElement,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY};setTimeout(function(){var e=i.selection.getRange();if(e.collapsed===false||t=="contextmenu"){if(!a){a=new baidu.editor.ui.ShortCutMenu({editor:i,items:s,theme:i.options.theme,className:"edui-shortcutmenu"});a.render();i.fireEvent("afterrendershortcutmenu",a)}a.show(n,!!UE.plugins["contextmenu"])}});if(t=="contextmenu"){domUtils.preventDefault(e);if(browser.ie9below){var o;try{o=i.selection.getNative().createRange()}catch(e){return}if(o.item){var r=new dom.Range(i.document);r.selectNode(o.item(0)).select(true,true)}}}});e.addListener("keydown",function(e){if(e=="keydown"){a&&!a.isHidden&&a.hide()}})};UE.plugins["basestyle"]=function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},a=function(e,t){return domUtils.filterNodeList(e.selection.getStartElementPath(),t)},s=this;s.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"});s.addInputRule(function(e){utils.each(e.getNodesByTagName("b i"),function(e){switch(e.tagName){case"b":e.tagName="strong";break;case"i":e.tagName="em"}})});for(var t in e){(function(e,r){s.commands[e]={execCommand:function(e){var t=s.selection.getRange(),i=a(this,r);if(t.collapsed){if(i){var n=s.document.createTextNode("");t.insertNode(n).removeInlineStyle(r);t.setStartBefore(n);domUtils.remove(n)}else{var o=t.document.createElement(r[0]);if(e=="superscript"||e=="subscript"){n=s.document.createTextNode("");t.insertNode(n).removeInlineStyle(["sub","sup"]).setStartBefore(n).collapse(true)}t.insertNode(o).setStart(o,0)}t.collapse(true)}else{if(e=="superscript"||e=="subscript"){if(!i||i.tagName.toLowerCase()!=e){t.removeInlineStyle(["sub","sup"])}}i?t.removeInlineStyle(r):t.applyInlineStyle(r[0])}t.select()},queryCommandState:function(){return a(this,r)?1:0}}})(t,e[t])}};UE.plugins["elementpath"]=function(){var r,a,o=this;o.setOpt("elementPathEnabled",true);if(!o.options.elementPathEnabled){return}o.commands["elementpath"]={execCommand:function(e,t){var i=a[t],n=o.selection.getRange();r=t*1;n.selectNode(i).select()},queryCommandValue:function(){var e=[].concat(this.selection.getStartElementPath()).reverse(),t=[];a=e;for(var i=0,n;n=e[i];i++){if(n.nodeType==3){continue}var o=n.tagName.toLowerCase();if(o=="img"&&n.getAttribute("anchorname")){o="anchor"}t[i]=o;if(r==i){r=-1;break}}return t}}};UE.plugins["formatmatch"]=function(){var d=this,c=[],u,f=0;d.addListener("reset",function(){c=[];f=0});function m(e,t){if(browser.webkit){var i=t.target.tagName=="IMG"?t.target:null}function n(e){if(s){e.selectNode(s)}return e.applyInlineStyle(c[c.length-1].tagName,null,c)}d.undoManger&&d.undoManger.save();var o=d.selection.getRange(),r=i||o.getClosedNode();if(u&&r&&r.tagName=="IMG"){r.style.cssText+=";float:"+(u.style.cssFloat||u.style.styleFloat||"none")+";display:"+(u.style.display||"inline");u=null}else{if(!u){var a=o.collapsed;if(a){var s=d.document.createTextNode("match");o.insertNode(s).select()}d.__hasEnterExecCommand=true;var l=d.options.removeFormatAttributes;d.options.removeFormatAttributes="";d.execCommand("removeformat");d.options.removeFormatAttributes=l;d.__hasEnterExecCommand=false;o=d.selection.getRange();if(c.length){n(o)}if(s){o.setStartBefore(s).collapse(true)}o.select();s&&domUtils.remove(s)}}d.undoManger&&d.undoManger.save();d.removeListener("mouseup",m);f=0}d.commands["formatmatch"]={execCommand:function(e){if(f){f=0;c=[];d.removeListener("mouseup",m);return}var t=d.selection.getRange();u=t.getClosedNode();if(!u||u.tagName!="IMG"){t.collapse(true).shrinkBoundary();var i=t.startContainer;c=domUtils.findParents(i,true,function(e){return!domUtils.isBlockElm(e)&&e.nodeType==1});for(var n=0,o;o=c[n];n++){if(o.tagName=="A"){c.splice(n,1);break}}}d.addListener("mouseup",m);f=1},queryCommandState:function(){return f},notNeedUndo:1}};UE.plugin.register("searchreplace",function(){var r=this;var s={table:1,tbody:1,tr:1,ol:1,ul:1};var u=null;function f(e){var t=e.nodeType==3?e.nodeValue:e[browser.ie?"innerText":"textContent"];return t.replace(domUtils.fillChar,"")}function l(e,t,i){var n=t.searchStr;var o=new RegExp(n,"g"+(t.casesensitive?"":"i")),r;if(t.dir==-1){e=e.substr(0,i);e=e.split("").reverse().join("");n=n.split("").reverse().join("");r=o.exec(e);if(r){return i-r.index-n.length}}else{e=e.substr(i);r=o.exec(e);if(r){return r.index+i}}return-1}function m(e,t,i){var n,o,r=i.all||i.dir==1?"getNextDomNode":"getPreDomNode";if(domUtils.isBody(e)){e=e.firstChild}var a=1;while(e){n=f(e);o=l(n,i,t);a=0;if(o!=-1){return{node:e,index:o}}e=domUtils[r](e);while(e&&s[e.nodeName.toLowerCase()]){e=domUtils[r](e,true)}if(e){t=i.dir==-1?f(e).length:0}}}function h(e,t,i){var n=0,o=e.firstChild,r=0,a;while(o){if(o.nodeType==3){r=f(o).replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length;n+=r;if(n>=t){return{node:o,index:r-(n-t)}}}else if(!dtd.$empty[o.tagName]){r=f(o).replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length;n+=r;if(n>=t){a=h(o,r-(n-t),i);if(a){return a}}}o=domUtils.getNextDomNode(o)}}function a(e,t){var i=u||e.selection.getRange(),n,o=t.searchStr,r=e.document.createElement("span");r.innerHTML="$$ueditor_searchreplace_key$$";i.shrinkBoundary(true);if(!i.collapsed){i.select();var a=e.selection.getText();if(new RegExp("^"+t.searchStr+"$",t.casesensitive?"":"i").test(a)){if(t.replaceStr!=undefined){p(i,t.replaceStr);i.select();return true}else{i.collapse(t.dir==-1)}}}i.insertNode(r);i.enlargeToBlockElm(true);n=i.startContainer;var s=f(n).indexOf("$$ueditor_searchreplace_key$$");i.setStartBefore(r);domUtils.remove(r);var l=m(n,s,t);if(l){var d=h(l.node,l.index,o);var c=h(l.node,l.index+o.length,o);i.setStart(d.node,d.index).setEnd(c.node,c.index);if(t.replaceStr!==undefined){p(i,t.replaceStr)}i.select();return true}else{i.setCursor()}}function p(e,t){t=r.document.createTextNode(t);e.deleteContents().insertNode(t)}return{commands:{searchreplace:{execCommand:function(e,t){utils.extend(t,{all:false,casesensitive:false,dir:1},true);var i=0;if(t.all){u=null;var n=r.selection.getRange(),o=r.body.firstChild;if(o&&o.nodeType==1){n.setStart(o,0);n.shrinkBoundary(true)}else if(o.nodeType==3){n.setStartBefore(o)}n.collapse(true).select(true);if(t.replaceStr!==undefined){r.fireEvent("saveScene")}while(a(this,t)){i++;u=r.selection.getRange();u.collapse(t.dir==-1)}if(i){r.fireEvent("saveScene")}}else{if(t.replaceStr!==undefined){r.fireEvent("saveScene")}if(a(this,t)){i++;u=r.selection.getRange();u.collapse(t.dir==-1)}if(i){r.fireEvent("saveScene")}}return i},notNeedUndo:1}},bindEvents:{clearlastSearchResult:function(){u=null}}}});UE.plugins["customstyle"]=function(){var a=this;a.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]});a.commands["customstyle"]={execCommand:function(e,t){var i=this,n=t.tag,o=domUtils.findParent(i.selection.getStart(),function(e){return e.getAttribute("label")},true),r,a,s={};for(var l in t){if(t[l]!==undefined)s[l]=t[l]}delete s.tag;if(o&&o.getAttribute("label")==t.label){r=this.selection.getRange();a=r.createBookmark();if(r.collapsed){if(dtd.$block[o.tagName]){var d=i.document.createElement("p");domUtils.moveChild(o,d);o.parentNode.insertBefore(d,o);domUtils.remove(o)}else{domUtils.remove(o,true)}}else{var c=domUtils.getCommonAncestor(a.start,a.end),u=domUtils.getElementsByTagName(c,n);if(new RegExp(n,"i").test(c.tagName)){u.push(c)}for(var f=0,m;m=u[f++];){if(m.getAttribute("label")==t.label){var h=domUtils.getPosition(m,a.start),p=domUtils.getPosition(m,a.end);if((h&domUtils.POSITION_FOLLOWING||h&domUtils.POSITION_CONTAINS)&&(p&domUtils.POSITION_PRECEDING||p&domUtils.POSITION_CONTAINS))if(dtd.$block[n]){var d=i.document.createElement("p");domUtils.moveChild(m,d);m.parentNode.insertBefore(d,m)}domUtils.remove(m,true)}}o=domUtils.findParent(c,function(e){return e.getAttribute("label")==t.label},true);if(o){domUtils.remove(o,true)}}r.moveToBookmark(a).select()}else{if(dtd.$block[n]){this.execCommand("paragraph",n,s,"customstyle");r=i.selection.getRange();if(!r.collapsed){r.collapse();o=domUtils.findParent(i.selection.getStart(),function(e){return e.getAttribute("label")==t.label},true);var g=i.document.createElement("p");domUtils.insertAfter(o,g);domUtils.fillNode(i.document,g);r.setStart(g,0).setCursor()}}else{r=i.selection.getRange();if(r.collapsed){o=i.document.createElement(n);domUtils.setAttributes(o,s);r.insertNode(o).setStart(o,0).setCursor();return}a=r.createBookmark();r.applyInlineStyle(n,s).moveToBookmark(a).select()}}},queryCommandValue:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),function(e){return e.getAttribute("label")});return e?e.getAttribute("label"):""}};a.addListener("keyup",function(e,t){var i=t.keyCode||t.which;if(i==32||i==13){var n=a.selection.getRange();if(n.collapsed){var o=domUtils.findParent(a.selection.getStart(),function(e){return e.getAttribute("label")},true);if(o&&dtd.$block[o.tagName]&&domUtils.isEmptyNode(o)){var r=a.document.createElement("p");domUtils.insertAfter(o,r);domUtils.fillNode(a.document,r);domUtils.remove(o);n.setStart(r,0).setCursor()}}}})};UE.plugins["catchremoteimage"]=function(){var me=this,ajax=UE.ajax;if(me.options.catchRemoteImageEnable===false)return;me.setOpt({catchRemoteImageEnable:false});me.addListener("afterpaste",function(){me.fireEvent("catchRemoteImage")});me.addListener("catchRemoteImage",function(){var catcherLocalDomain=me.getOpt("catcherLocalDomain"),catcherActionUrl=me.getActionUrl(me.getOpt("catcherActionName")),catcherUrlPrefix=me.getOpt("catcherUrlPrefix"),catcherFieldName=me.getOpt("catcherFieldName");var remoteImages=[],loadingIMG=me.options.themePath+me.options.theme+"/images/spacer.gif",imgs=me.document.querySelectorAll('[style*="url"],img'),test=function(e,t){if(e.indexOf(location.host)!=-1||/(^\.)|(^\/)/.test(e)){return true}if(t){for(var i=0,n;n=t[i++];){if(e.indexOf(n)!==-1){return true}}}return false};for(var i=0,ci;ci=imgs[i++];){if(ci.getAttribute("word_img")){continue}if(ci.nodeName=="IMG"){var src=ci.getAttribute("_src")||ci.src||"";if(/^(https?|ftp):/i.test(src)&&!test(src,catcherLocalDomain)){remoteImages.push(src);domUtils.setAttributes(ci,{class:"loadingclass",_src:src,src:loadingIMG})}}else{var backgroundImageurl=ci.style.cssText.replace(/.*\s?url\([\'\"]?/,"").replace(/[\'\"]?\).*/,"");if(/^(https?|ftp):/i.test(backgroundImageurl)&&!test(backgroundImageurl,catcherLocalDomain)){remoteImages.push(backgroundImageurl);ci.style.cssText=ci.style.cssText.replace(backgroundImageurl,loadingIMG);domUtils.setAttributes(ci,{"data-background":backgroundImageurl})}}}if(remoteImages.length){catchremoteimage(remoteImages,{success:function(r){try{var info=r.state!==undefined?r:eval("("+r.responseText+")")}catch(e){return}var i,j,ci,cj,oldSrc,newSrc,list=info.list;var catchFailList=[];var catchSuccessList=[];var failIMG=me.options.themePath+me.options.theme+"/images/img-cracked.png";for(i=0;ci=imgs[i++];){oldSrc=ci.getAttribute("_src")||ci.src||"";oldBgIMG=ci.getAttribute("data-background")||"";for(j=0;cj=list[j++];){if(oldSrc==cj.source&&cj.state=="SUCCESS"){newSrc=catcherUrlPrefix+cj.url;domUtils.removeClasses(ci,"loadingclass");domUtils.setAttributes(ci,{src:newSrc,_src:newSrc,"data-catchResult":"img_catchSuccess"});catchSuccessList.push(ci);break}else if(oldSrc==cj.source&&cj.state=="FAIL"){domUtils.removeClasses(ci,"loadingclass");domUtils.setAttributes(ci,{src:failIMG,_src:failIMG,"data-catchResult":"img_catchFail"});catchFailList.push(ci);break}else if(oldBgIMG==cj.source&&cj.state=="SUCCESS"){newBgIMG=catcherUrlPrefix+cj.url;ci.style.cssText=ci.style.cssText.replace(loadingIMG,newBgIMG);domUtils.removeAttributes(ci,"data-background");domUtils.setAttributes(ci,{"data-catchResult":"img_catchSuccess"});catchSuccessList.push(ci);break}else if(oldBgIMG==cj.source&&cj.state=="FAIL"){ci.style.cssText=ci.style.cssText.replace(loadingIMG,failIMG);domUtils.removeAttributes(ci,"data-background");domUtils.setAttributes(ci,{"data-catchResult":"img_catchFail"});catchFailList.push(ci);break}}}me.fireEvent("catchremotesuccess",catchSuccessList,catchFailList)},error:function(){me.fireEvent("catchremoteerror")}})}function catchremoteimage(e,t){var i=utils.serializeParam(me.queryCommandValue("serverparam"))||"",n=utils.formatUrl(catcherActionUrl+(catcherActionUrl.indexOf("?")==-1?"?":"&")+i),o=utils.isCrossDomainUrl(n),r={method:"POST",dataType:o?"jsonp":"",timeout:6e4,onsuccess:t["success"],onerror:t["error"]};r[catcherFieldName]=e;ajax.request(n,r)}})};UE.plugin.register("snapscreen",function(){var me=this;var snapplugin;function getLocation(e){var t,i=document.createElement("a"),n=utils.serializeParam(me.queryCommandValue("serverparam"))||"";i.href=e;if(browser.ie){i.href=i.href}t=i.search;if(n){t=t+(t.indexOf("?")==-1?"?":"&")+n;t=t.replace(/[&]+/gi,"&")}return{port:i.port,hostname:i.hostname,path:i.pathname+t||+i.hash}}return{commands:{snapscreen:{execCommand:function(cmd){var url,local,res;var lang=me.getLang("snapScreen_plugin");if(!snapplugin){var container=me.container;var doc=me.container.ownerDocument||me.container.document;snapplugin=doc.createElement("object");try{snapplugin.type="application/x-pluginbaidusnap"}catch(e){return}snapplugin.style.cssText="position:absolute;left:-9999px;width:0;height:0;";snapplugin.setAttribute("width","0");snapplugin.setAttribute("height","0");container.appendChild(snapplugin)}function onSuccess(rs){try{rs=eval("("+rs+")");if(rs.state=="SUCCESS"){var opt=me.options;me.execCommand("insertimage",{src:opt.snapscreenUrlPrefix+rs.url,_src:opt.snapscreenUrlPrefix+rs.url,alt:rs.title||"",floatStyle:opt.snapscreenImgAlign})}else{alert(rs.state)}}catch(e){alert(lang.callBackErrorMsg)}}url=me.getActionUrl(me.getOpt("snapscreenActionName"));local=getLocation(url);setTimeout(function(){try{res=snapplugin.saveSnapshot(local.hostname,local.path,local.port)}catch(e){me.ui._dialogs["snapscreenDialog"].open();return}onSuccess(res)},50)},queryCommandState:function(){return navigator.userAgent.indexOf("Windows",0)!=-1?0:-1}}}}});UE.commands["insertparagraph"]={execCommand:function(e,t){var i=this,n=i.selection.getRange(),o=n.startContainer,r;while(o){if(domUtils.isBody(o)){break}r=o;o=o.parentNode}if(r){var a=i.document.createElement("p");if(t){r.parentNode.insertBefore(a,r)}else{r.parentNode.insertBefore(a,r.nextSibling)}domUtils.fillNode(i.document,a);n.setStart(a,0).setCursor(false,true)}}};UE.plugin.register("webapp",function(){var i=this;function o(e,t){return!t?'<img title="'+e.title+'" width="'+e.width+'" height="'+e.height+'"'+' src="'+i.options.UEDITOR_HOME_URL+'themes/notadd/images/spacer.gif" _logo_url="'+e.logo+'" style="background:url('+e.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+e.url+'" '+(e.align&&!e.cssfloat?'align="'+e.align+'"':"")+(e.cssfloat?'style="float:'+e.cssfloat+'"':"")+"/>":'<iframe class="edui-faked-webapp" title="'+e.title+'" '+(e.align&&!e.cssfloat?'align="'+e.align+'"':"")+(e.cssfloat?'style="float:'+e.cssfloat+'"':"")+'width="'+e.width+'" height="'+e.height+'"  scrolling="no" frameborder="0" src="'+e.url+'" logo_url = "'+e.logo+'"></iframe>'}return{outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){var t;if(e.getAttr("class")=="edui-faked-webapp"){t=o({title:e.getAttr("title"),width:e.getAttr("width"),height:e.getAttr("height"),align:e.getAttr("align"),cssfloat:e.getStyle("float"),url:e.getAttr("_url"),logo:e.getAttr("_logo_url")},true);var i=UE.uNode.createElement(t);e.parentNode.replaceChild(i,e)}})},inputRule:function(e){utils.each(e.getNodesByTagName("iframe"),function(e){if(e.getAttr("class")=="edui-faked-webapp"){var t=UE.uNode.createElement(o({title:e.getAttr("title"),width:e.getAttr("width"),height:e.getAttr("height"),align:e.getAttr("align"),cssfloat:e.getStyle("float"),url:e.getAttr("src"),logo:e.getAttr("logo_url")}));e.parentNode.replaceChild(t,e)}})},commands:{webapp:{execCommand:function(e,t){var i=this,n=o(utils.extend(t,{align:"none"}),false);i.execCommand("inserthtml",n)},queryCommandState:function(){var e=this,t=e.selection.getRange().getClosedNode(),i=t&&t.className=="edui-faked-webapp";return i?1:0}}}}});UE.plugins["template"]=function(){UE.commands["template"]={execCommand:function(e,t){t.html&&this.execCommand("inserthtml",t.html)}};this.addListener("click",function(e,t){var i=t.target||t.srcElement,n=this.selection.getRange();var o=domUtils.findParent(i,function(e){if(e.className&&domUtils.hasClass(e,"ue_t")){return e}},true);o&&n.selectNode(o).shrinkBoundary().select()});this.addListener("keydown",function(e,t){var i=this.selection.getRange();if(!i.collapsed){if(!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){var n=domUtils.findParent(i.startContainer,function(e){if(e.className&&domUtils.hasClass(e,"ue_t")){return e}},true);if(n){domUtils.removeClasses(n,["ue_t"])}}}})};UE.plugin.register("music",function(){var a=this;function r(e,t,i,n,o,r){return!r?"<img "+(n&&!o?'align="'+n+'"':"")+(o?'style="float:'+o+'"':"")+' width="'+t+'" height="'+i+'" _url="'+e+'" class="edui-faked-music"'+' src="'+a.options.langPath+a.options.lang+'/images/music.png" />':'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer"'+' src="'+e+'" width="'+t+'" height="'+i+'" '+(n&&!o?'align="'+n+'"':"")+(o?'style="float:'+o+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >'}return{outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){var t;if(e.getAttr("class")=="edui-faked-music"){var i=e.getStyle("float");var n=e.getAttr("align");t=r(e.getAttr("_url"),e.getAttr("width"),e.getAttr("height"),n,i,true);var o=UE.uNode.createElement(t);e.parentNode.replaceChild(o,e)}})},inputRule:function(e){utils.each(e.getNodesByTagName("embed"),function(e){if(e.getAttr("class")=="edui-faked-music"){var t=e.getStyle("float");var i=e.getAttr("align");html=r(e.getAttr("src"),e.getAttr("width"),e.getAttr("height"),i,t,false);var n=UE.uNode.createElement(html);e.parentNode.replaceChild(n,e)}})},commands:{music:{execCommand:function(e,t){var i=this,n=r(t.url,t.width||400,t.height||95,"none",false);i.execCommand("inserthtml",n)},queryCommandState:function(){var e=this,t=e.selection.getRange().getClosedNode(),i=t&&t.className=="edui-faked-music";return i?1:0}}}}});UE.plugin.register("autoupload",function(){function a(e,t){var r=t;var i,a,n,o,s,l,d,c,u=/image\/\w+/i.test(e.type)?"image":"file",f="loading_"+(+new Date).toString(36);i=r.getOpt(u+"FieldName");a=r.getOpt(u+"UrlPrefix");n=r.getOpt(u+"MaxSize");o=r.getOpt(u+"AllowFiles");s=r.getActionUrl(r.getOpt(u+"ActionName"));d=function(e){var t=r.document.getElementById(f);t&&domUtils.remove(t);r.fireEvent("showmessage",{id:f,content:e,type:"error",timeout:4e3})};if(u=="image"){l='<img class="loadingclass" id="'+f+'" src="'+r.options.themePath+r.options.theme+'/images/spacer.gif">';c=function(e){var t=a+e.url,i=r.document.getElementById(f);if(i){domUtils.removeClasses(i,"loadingclass");i.setAttribute("src",t);i.setAttribute("_src",t);i.setAttribute("alt",e.original||"");i.removeAttribute("id");r.trigger("contentchange",i)}}}else{l="<p>"+'<img class="loadingclass" id="'+f+'" src="'+r.options.themePath+r.options.theme+'/images/spacer.gif">'+"</p>";c=function(e){var t=a+e.url,i=r.document.getElementById(f);var n=r.selection.getRange(),o=n.createBookmark();n.selectNode(i).select();r.execCommand("insertfile",{url:t});n.moveToBookmark(o).select()}}r.execCommand("inserthtml",l);if(!r.getOpt(u+"ActionName")){d(r.getLang("autoupload.errorLoadConfig"));return}if(e.size>n){d(r.getLang("autoupload.exceedSizeError"));return}var m=e.name?e.name.substr(e.name.lastIndexOf(".")):"";if(m&&u!="image"||o&&(o.join("")+".").indexOf(m.toLowerCase()+".")==-1){d(r.getLang("autoupload.exceedTypeError"));return}var h=new XMLHttpRequest,p=new FormData,g=utils.serializeParam(r.queryCommandValue("serverparam"))||"",v=utils.formatUrl(s+(s.indexOf("?")==-1?"?":"&")+g);p.append(i,e,e.name||"blob."+e.type.substr("image/".length));p.append("type","ajax");h.open("post",v,true);h.setRequestHeader("X-Requested-With","XMLHttpRequest");h.addEventListener("load",function(e){try{var t=new Function("return "+utils.trim(e.target.response))();if(t.state=="SUCCESS"&&t.url){c(t)}else{d(t.state)}}catch(e){d(r.getLang("autoupload.loadError"))}});h.send(p)}function s(e){return e.clipboardData&&e.clipboardData.items&&e.clipboardData.items.length==1&&/^image\//.test(e.clipboardData.items[0].type)?e.clipboardData.items:null}function l(e){return e.dataTransfer&&e.dataTransfer.files?e.dataTransfer.files:null}return{outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){if(/\b(loaderrorclass)|(bloaderrorclass)\b/.test(e.getAttr("class"))){e.parentNode.removeChild(e)}});utils.each(e.getNodesByTagName("p"),function(e){if(/\bloadpara\b/.test(e.getAttr("class"))){e.parentNode.removeChild(e)}})},bindEvents:{defaultOptions:{enableDragUpload:true,enablePasteUpload:true},ready:function(e){var r=this;if(window.FormData&&window.FileReader){var t=function(e){var t=false,i;i=e.type=="paste"?s(e):l(e);if(i){var n=i.length,o;while(n--){o=i[n];if(o.getAsFile)o=o.getAsFile();if(o&&o.size>0){a(o,r);t=true}}t&&e.preventDefault()}};if(r.getOpt("enablePasteUpload")!==false){domUtils.on(r.body,"paste ",t)}if(r.getOpt("enableDragUpload")!==false){domUtils.on(r.body,"drop",t);domUtils.on(r.body,"dragover",function(e){if(e.dataTransfer.types[0]=="Files"){e.preventDefault()}})}else{if(browser.gecko){domUtils.on(r.body,"drop",function(e){if(l(e)){e.preventDefault()}})}}utils.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n"+".loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;"+"}",this.document)}}}}});UE.plugin.register("autosave",function(){var i=this,n=new Date,o=20,r=null;function e(e){var t;if(new Date-n<o){return}if(!e.hasContents()){r&&i.removePreferences(r);return}n=new Date;e._saveFlag=null;t=i.body.innerHTML;if(e.fireEvent("beforeautosave",{content:t})===false){return}i.setPreferences(r,t);e.fireEvent("afterautosave",{content:t})}return{defaultOptions:{saveInterval:500,enableAutoSave:true},bindEvents:{ready:function(){var e="-drafts-data",t=null;if(i.key){t=i.key+e}else{t=(i.container.parentNode.id||"ue-common")+e}r=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+t},contentchange:function(){if(!i.getOpt("enableAutoSave")){return}if(!r){return}if(i._saveFlag){window.clearTimeout(i._saveFlag)}if(i.options.saveInterval>0){i._saveFlag=window.setTimeout(function(){e(i)},i.options.saveInterval)}else{e(i)}}},commands:{clearlocaldata:{execCommand:function(e,t){if(r&&i.getPreferences(r)){i.removePreferences(r)}},notNeedUndo:true,ignoreContentChange:true},getlocaldata:{execCommand:function(e,t){return r?i.getPreferences(r)||"":""},notNeedUndo:true,ignoreContentChange:true},drafts:{execCommand:function(e,t){if(r){i.body.innerHTML=i.getPreferences(r)||"<p>"+domUtils.fillHtml+"</p>";i.focus(true)}},queryCommandState:function(){return r?i.getPreferences(r)===null?-1:0:-1},notNeedUndo:true,ignoreContentChange:true}}}});UE.plugin.register("charts",function(){var a=this;return{bindEvents:{chartserror:function(){}},commands:{charts:{execCommand:function(e,t){var i=domUtils.findParentByTagName(this.selection.getRange().startContainer,"table",true),n=[],o={};if(!i){return false}if(!s(i)){a.fireEvent("chartserror");return false}o.title=t.title||"";o.subTitle=t.subTitle||"";o.xTitle=t.xTitle||"";o.yTitle=t.yTitle||"";o.suffix=t.suffix||"";o.tip=t.tip||"";o.dataFormat=t.tableDataFormat||"";o.chartType=t.chartType||0;for(var r in o){if(!o.hasOwnProperty(r)){continue}n.push(r+":"+o[r])}i.setAttribute("data-chart",n.join(";"));domUtils.addClass(i,"edui-charts-table")},queryCommandState:function(e,t){var i=domUtils.findParentByTagName(this.selection.getRange().startContainer,"table",true);return i&&s(i)?0:-1}}},inputRule:function(e){utils.each(e.getNodesByTagName("table"),function(e){if(e.getAttr("data-chart")!==undefined){e.setAttr("style")}})},outputRule:function(e){utils.each(e.getNodesByTagName("table"),function(e){if(e.getAttr("data-chart")!==undefined){e.setAttr("style","display: none;")}})}};function s(e){var t=null,i=0;if(e.rows.length<2){return false}if(e.rows[0].cells.length<2){return false}t=e.rows[0].cells;i=t.length;for(var n=0,o;o=t[n];n++){if(o.tagName.toLowerCase()!=="th"){return false}}for(var n=1,r;r=e.rows[n];n++){if(r.cells.length!=i){return false}if(r.cells[0].tagName.toLowerCase()!=="th"){return false}for(var a=1,o;o=r.cells[a];a++){var s=utils.trim(o.innerText||o.textContent||"");s=s.replace(new RegExp(UE.dom.domUtils.fillChar,"g"),"").replace(/^\s+|\s+$/g,"");if(!/^\d*\.?\d+$/.test(s)){return false}}}return true}});UE.plugin.register("section",function(){function i(e){this.tag="";this.level=-1,this.dom=null;this.nextSection=null;this.previousSection=null;this.parentSection=null;this.startAddress=[];this.endAddress=[];this.children=[]}function p(e){var t=new i;return utils.extend(t,e)}function f(e,t){var i=t;for(var n=0;n<e.length;n++){if(!i.childNodes)return null;i=i.childNodes[e[n]]}return i}var n=this;return{bindMultiEvents:{type:"aftersetcontent afterscencerestore",handler:function(){n.fireEvent("updateSections")}},bindEvents:{ready:function(){n.fireEvent("updateSections");domUtils.on(n.body,"drop paste",function(){n.fireEvent("updateSections")})},afterexeccommand:function(e,t){if(t=="paragraph"){n.fireEvent("updateSections")}},keyup:function(e,t){var i=this,n=i.selection.getRange();if(n.collapsed!=true){i.fireEvent("updateSections")}else{var o=t.keyCode||t.which;if(o==13||o==8||o==46){i.fireEvent("updateSections")}}}},commands:{getsections:{execCommand:function(e,t){var i=t||["h1","h2","h3","h4","h5","h6"];for(var n=0;n<i.length;n++){if(typeof i[n]=="string"){i[n]=function(t){return function(e){return e.tagName==t.toUpperCase()}}(i[n])}else if(typeof i[n]!="function"){i[n]=function(e){return null}}}function u(e){for(var t=0;t<i.length;t++){if(i[t](e))return t}return-1}var f=this,o=p({level:-1,title:"root"}),m=o;function h(e,t){var i,n=null,o,r,a=e.childNodes;for(var s=0,l=a.length;s<l;s++){r=a[s];i=u(r);if(i>=0){var d=f.selection.getRange().selectNode(r).createAddress(true).startAddress,c=p({tag:r.tagName,title:r.innerText||r.textContent||"",level:i,dom:r,startAddress:utils.clone(d,[]),endAddress:utils.clone(d,[]),children:[]});m.nextSection=c;c.previousSection=m;o=m;while(i<=o.level){o=o.parentSection}c.parentSection=o;o.children.push(c);n=m=c}else{r.nodeType===1&&h(r,t);n&&n.endAddress[n.endAddress.length-1]++}}}h(f.body,o);return o},notNeedUndo:true},movesection:{execCommand:function(e,t,i,n){var o=this,r,a;if(!t||!i||i.level==-1)return;r=n?i.endAddress:i.startAddress;a=f(r,o.body);if(!r||!a||u(t.startAddress,t.endAddress,r))return;var s=f(t.startAddress,o.body),l=f(t.endAddress,o.body),d,c;if(n){d=l;while(d&&!(domUtils.getPosition(s,d)&domUtils.POSITION_FOLLOWING)){c=d.previousSibling;domUtils.insertAfter(a,d);if(d==s)break;d=c}}else{d=s;while(d&&!(domUtils.getPosition(d,l)&domUtils.POSITION_FOLLOWING)){c=d.nextSibling;a.parentNode.insertBefore(d,a);if(d==l)break;d=c}}o.fireEvent("updateSections");function u(e,t,i){var n=false,o=false;for(var r=0;r<e.length;r++){if(r>=i.length)break;if(i[r]>e[r]){n=true;break}else if(i[r]<e[r]){break}}for(var r=0;r<t.length;r++){if(r>=i.length)break;if(i[r]<e[r]){o=true;break}else if(i[r]>e[r]){break}}return n&&o}}},deletesection:{execCommand:function(e,t,i){var n=this;if(!t)return;function o(e){var t=n.body;for(var i=0;i<e.length;i++){if(!t.childNodes)return null;t=t.childNodes[e[i]]}return t}var r=o(t.startAddress),a=o(t.endAddress),s=r,l;if(!i){while(s&&domUtils.inDoc(a,n.document)&&!(domUtils.getPosition(s,a)&domUtils.POSITION_FOLLOWING)){l=s.nextSibling;domUtils.remove(s);s=l}}else{domUtils.remove(s)}n.fireEvent("updateSections")}},selectsection:{execCommand:function(e,t){if(!t&&!t.dom)return false;var i=this,n=i.selection.getRange(),o={startAddress:utils.clone(t.startAddress,[]),endAddress:utils.clone(t.endAddress,[])};o.endAddress[o.endAddress.length-1]++;n.moveToAddress(o).select().scrollToView();return true},notNeedUndo:true},scrolltosection:{execCommand:function(e,t){if(!t&&!t.dom)return false;var i=this,n=i.selection.getRange(),o={startAddress:t.startAddress,endAddress:t.endAddress};o.endAddress[o.endAddress.length-1]++;n.moveToAddress(o).scrollToView();return true},notNeedUndo:true}}}});UE.plugin.register("simpleupload",function(){var f=this,m=false,i;function n(){var r=i.offsetWidth||20,a=i.offsetHeight||20,s=document.createElement("iframe"),u="display:block;width:"+r+"px;height:"+a+"px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";domUtils.on(s,"load",function(){var e=(+new Date).toString(36),t,i,n;i=s.contentDocument||s.contentWindow.document;n=i.body;t=i.createElement("div");t.innerHTML='<form id="edui_form_'+e+'" target="edui_iframe_'+e+'" method="POST" enctype="multipart/form-data" action="'+f.getOpt("serverUrl")+'" '+'style="'+u+'">'+'<input id="edui_input_'+e+'" type="file" accept="image/*" name="'+f.options.imageFieldName+'" '+'style="'+u+'">'+"</form>"+'<iframe id="edui_iframe_'+e+'" name="edui_iframe_'+e+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>';t.className="edui-"+f.options.theme;t.id=f.ui.id+"_iframeupload";n.style.cssText=u;n.style.width=r+"px";n.style.height=a+"px";n.appendChild(t);if(n.parentNode){n.parentNode.style.width=r+"px";n.parentNode.style.height=r+"px"}var l=i.getElementById("edui_form_"+e);var d=i.getElementById("edui_input_"+e);var c=i.getElementById("edui_iframe_"+e);domUtils.on(d,"change",function(){if(!d.value)return;var r="loading_"+(+new Date).toString(36);var e=utils.serializeParam(f.queryCommandValue("serverparam"))||"";var t=f.getActionUrl(f.getOpt("imageActionName"));var i=f.getOpt("imageAllowFiles");f.focus();f.execCommand("inserthtml",'<img class="loadingclass" id="'+r+'" src="'+f.options.themePath+f.options.theme+'/images/spacer.gif">');function a(){try{var e,t,i,n=(c.contentDocument||c.contentWindow.document).body,o=n.innerText||n.textContent||"";t=new Function("return "+o)();e=f.options.imageUrlPrefix+t.url;if(t.state=="SUCCESS"&&t.url){i=f.document.getElementById(r);domUtils.removeClasses(i,"loadingclass");domUtils.on(i,"load",function(){f.fireEvent("contentchange")});i.setAttribute("src",e);i.setAttribute("_src",e);i.setAttribute("alt",t.original||"");i.removeAttribute("id")}else{s&&s(t.state)}}catch(e){s&&s(f.getLang("simpleupload.loadError"))}l.reset();domUtils.un(c,"load",a)}function s(e){if(r){var t=f.document.getElementById(r);t&&domUtils.remove(t);f.fireEvent("showmessage",{id:r,content:e,type:"error",timeout:4e3})}}if(!f.getOpt("imageActionName")){errorHandler(f.getLang("autoupload.errorLoadConfig"));return}var n=d.value,o=n?n.substr(n.lastIndexOf(".")):"";if(!o||i&&(i.join("")+".").indexOf(o.toLowerCase()+".")==-1){s(f.getLang("simpleupload.exceedTypeError"));return}domUtils.on(c,"load",a);l.action=utils.formatUrl(t+(t.indexOf("?")==-1?"?":"&")+e);l.submit()});var o;f.addListener("selectionchange",function(){clearTimeout(o);o=setTimeout(function(){var e=f.queryCommandState("simpleupload");if(e==-1){d.disabled="disabled"}else{d.disabled=false}},400)});m=true});s.style.cssText=u;i.appendChild(s)}return{bindEvents:{ready:function(){utils.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n"+".loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;"+"}",this.document)},simpleuploadbtnready:function(e,t){i=t;f.afterConfigReady(n)}},outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){if(/\b(loaderrorclass)|(bloaderrorclass)\b/.test(e.getAttr("class"))){e.parentNode.removeChild(e)}})},commands:{simpleupload:{queryCommandState:function(){return m?0:-1}}}}});UE.plugin.register("serverparam",function(){var e=this,n={};return{commands:{serverparam:{execCommand:function(e,t,i){if(t===undefined||t===null){n={}}else if(utils.isString(t)){if(i===undefined||i===null){delete n[t]}else{n[t]=i}}else if(utils.isObject(t)){utils.extend(n,t,false)}else if(utils.isFunction(t)){utils.extend(n,t(),false)}},queryCommandValue:function(){return n||{}}}}}});UE.plugin.register("insertfile",function(){var d=this;function c(e){var t=e.substr(e.lastIndexOf(".")+1).toLowerCase(),i={rar:"icon_rar.gif",zip:"icon_rar.gif",tar:"icon_rar.gif",gz:"icon_rar.gif",bz2:"icon_rar.gif",doc:"icon_doc.gif",docx:"icon_doc.gif",pdf:"icon_pdf.gif",mp3:"icon_mp3.gif",xls:"icon_xls.gif",chm:"icon_chm.gif",ppt:"icon_ppt.gif",pptx:"icon_ppt.gif",avi:"icon_mv.gif",rmvb:"icon_mv.gif",wmv:"icon_mv.gif",flv:"icon_mv.gif",swf:"icon_mv.gif",rm:"icon_mv.gif",exe:"icon_exe.gif",psd:"icon_psd.gif",txt:"icon_txt.gif",jpg:"icon_jpg.gif",png:"icon_jpg.gif",jpeg:"icon_jpg.gif",gif:"icon_jpg.gif",ico:"icon_jpg.gif",bmp:"icon_jpg.gif"};return i[t]?i[t]:i["txt"]}return{commands:{insertfile:{execCommand:function(e,t){t=utils.isArray(t)?t:[t];if(d.fireEvent("beforeinsertfile",t)===true){return}var i,n,o,r,a="",s=d.getOpt("UEDITOR_HOME_URL"),l=s+(s.substr(s.length-1)=="/"?"":"/")+"dialogs/attachment/fileTypeImages/";for(i=0;i<t.length;i++){n=t[i];o=l+c(n.url);r=n.title||n.url.substr(n.url.lastIndexOf("/")+1);a+='<p style="line-height: 16px;">'+'<img style="vertical-align: middle; margin-right: 2px;" src="'+o+'" _src="'+o+'" />'+'<a style="font-size:12px; color:#0066cc;" href="'+n.url+'" title="'+r+'">'+r+"</a>"+"</p>"}d.execCommand("insertHtml",a);d.fireEvent("afterinsertfile",t)}}}}});UE.plugins.xssFilter=function(){var e=UEDITOR_CONFIG;var o=e.whitList;function n(i){var n=i.tagName;var e=i.attrs;if(!o.hasOwnProperty(n)){i.parentNode.removeChild(i);return false}UE.utils.each(e,function(e,t){if(o[n].indexOf(t)===-1){i.setAttr(t)}})}if(o&&e.xssFilterRules){this.options.filterRules=function(){var i={};UE.utils.each(o,function(e,t){i[t]=function(e){return n(e)}});return i}()}var i=[];UE.utils.each(o,function(e,t){i.push(t)});if(o&&e.inputXssFilter){this.addInputRule(function(e){e.traversal(function(e){if(e.type!=="element"){return false}n(e)})})}if(o&&e.outputXssFilter){this.addOutputRule(function(e){e.traversal(function(e){if(e.type!=="element"){return false}n(e)})})}};var baidu=baidu||{};baidu.editor=baidu.editor||{};UE.ui=baidu.editor.ui={};(function(){var r=baidu.editor.browser,a=baidu.editor.dom.domUtils;var i="$EDITORUI";var n=window[i]={};var t="ID"+i;var o=0;var s=baidu.editor.ui.uiUtils={uid:function(e){return e?e[t]||(e[t]=++o):++o},hook:function(o,e){var r;if(o&&o._callbacks){r=o}else{r=function(){var e;if(o){e=o.apply(this,arguments)}var t=r._callbacks;var i=t.length;while(i--){var n=t[i].apply(this,arguments);if(e===undefined){e=n}}return e};r._callbacks=[]}r._callbacks.push(e);return r},createElementByHtml:function(e){var t=document.createElement("div");t.innerHTML=e;t=t.firstChild;t.parentNode.removeChild(t);return t},getViewportElement:function(){return r.ie&&r.quirks?document.body:document.documentElement},getClientRect:function(e){var t;try{t=e.getBoundingClientRect()}catch(e){t={left:0,top:0,height:0,width:0}}var i={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};var n;while((n=e.ownerDocument)!==document&&(e=a.getWindow(n).frameElement)){t=e.getBoundingClientRect();i.left+=t.left;i.top+=t.top}i.bottom=i.top+i.height;i.right=i.left+i.width;return i},getViewportRect:function(){var e=s.getViewportElement();var t=(window.innerWidth||e.clientWidth)|0;var i=(window.innerHeight||e.clientHeight)|0;return{left:0,top:0,height:i,width:t,bottom:i,right:t}},setViewportOffset:function(e,t){var i;var n=s.getFixedLayer();if(e.parentNode===n){e.style.left=t.left+"px";e.style.top=t.top+"px"}else{a.setViewportOffset(e,t)}},getEventOffset:function(e){var t=e.target||e.srcElement;var i=s.getClientRect(t);var n=s.getViewportOffsetByEvent(e);return{left:n.left-i.left,top:n.top-i.top}},getViewportOffsetByEvent:function(e){var t=e.target||e.srcElement;var i=a.getWindow(t).frameElement;var n={left:e.clientX,top:e.clientY};if(i&&t.ownerDocument!==document){var o=s.getClientRect(i);n.left+=o.left;n.top+=o.top}return n},setGlobal:function(e,t){n[e]=t;return i+'["'+e+'"]'},unsetGlobal:function(e){delete n[e]},copyAttributes:function(e,t){var i=t.attributes;var n=i.length;while(n--){var o=i[n];if(o.nodeName!="style"&&o.nodeName!="class"&&(!r.ie||o.specified)){e.setAttribute(o.nodeName,o.nodeValue)}}if(t.className){a.addClass(e,t.className)}if(t.style.cssText){e.style.cssText+=";"+t.style.cssText}},removeStyle:function(e,t){if(e.style.removeProperty){e.style.removeProperty(t)}else if(e.style.removeAttribute){e.style.removeAttribute(t)}else throw""},contains:function(e,t){return e&&t&&(e===t?false:e.contains?e.contains(t):e.compareDocumentPosition(t)&16)},startDrag:function(e,n,t){var t=t||document;var o=e.clientX;var r=e.clientY;function i(e){var t=e.clientX-o;var i=e.clientY-r;n.ondragmove(t,i,e);if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}}if(t.addEventListener){function a(e){t.removeEventListener("mousemove",i,true);t.removeEventListener("mouseup",a,true);window.removeEventListener("mouseup",a,true);n.ondragstop()}t.addEventListener("mousemove",i,true);t.addEventListener("mouseup",a,true);window.addEventListener("mouseup",a,true);e.preventDefault()}else{var s=e.srcElement;s.setCapture();function l(){s.releaseCapture();s.detachEvent("onmousemove",i);s.detachEvent("onmouseup",l);s.detachEvent("onlosecaptrue",l);n.ondragstop()}s.attachEvent("onmousemove",i);s.attachEvent("onmouseup",l);s.attachEvent("onlosecaptrue",l);e.returnValue=false}n.ondragstart()},getFixedLayer:function(){var e=document.getElementById("edui_fixedlayer");if(e==null){e=document.createElement("div");e.id="edui_fixedlayer";document.body.appendChild(e);if(r.ie&&r.version<=8){e.style.position="absolute";d();setTimeout(l)}else{e.style.position="fixed"}e.style.left="0";e.style.top="0";e.style.width="0";e.style.height="0"}return e},makeUnselectable:function(e){if(r.opera||r.ie&&r.version<9){e.unselectable="on";if(e.hasChildNodes()){for(var t=0;t<e.childNodes.length;t++){if(e.childNodes[t].nodeType==1){s.makeUnselectable(e.childNodes[t])}}}}else{if(e.style.MozUserSelect!==undefined){e.style.MozUserSelect="none"}else if(e.style.WebkitUserSelect!==undefined){e.style.WebkitUserSelect="none"}else if(e.style.KhtmlUserSelect!==undefined){e.style.KhtmlUserSelect="none"}}}};function l(){var e=document.getElementById("edui_fixedlayer");s.setViewportOffset(e,{left:0,top:0})}function d(e){a.on(window,"scroll",l);a.on(window,"resize",baidu.editor.utils.defer(l,0,true))}})();(function(){var e=baidu.editor.utils,d=baidu.editor.ui.uiUtils,t=baidu.editor.EventBase,i=baidu.editor.ui.UIBase=function(){};i.prototype={className:"",uiName:"",initOptions:function(e){var t=this;for(var i in e){t[i]=e[i]}this.id=this.id||"edui"+d.uid()},initUIBase:function(){this._globalKey=e.unhtml(d.setGlobal(this.id,this))},render:function(e){var t=this.renderHtml();var i=d.createElementByHtml(t);var n=domUtils.getElementsByTagName(i,"*");var o="edui-"+(this.theme||this.editor.options.theme);var r=document.getElementById("edui_fixedlayer");for(var a=0,s;s=n[a++];){domUtils.addClass(s,o)}domUtils.addClass(i,o);if(r){r.className="";domUtils.addClass(r,o)}var l=this.getDom();if(l!=null){l.parentNode.replaceChild(i,l);d.copyAttributes(i,l)}else{if(typeof e=="string"){e=document.getElementById(e)}e=e||d.getFixedLayer();domUtils.addClass(e,o);e.appendChild(i)}this.postRender()},getDom:function(e){if(!e){return document.getElementById(this.id)}else{return document.getElementById(this.id+"_"+e)}},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var t="edui-"+this.uiName;return e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();if(e)baidu.editor.dom.domUtils.remove(e);d.unsetGlobal(this.id)}};e.inherits(i,t)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.Separator=function(e){this.initOptions(e);this.initSeparator()};i.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};e.inherits(i,t)})();(function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,i=baidu.editor.ui.UIBase,n=baidu.editor.ui.uiUtils;var o=baidu.editor.ui.Mask=function(e){this.initOptions(e);this.initUIBase()};o.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var e=this;t.on(window,"resize",function(){setTimeout(function(){if(!e.isHidden()){e._fill()}})})},show:function(e){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=e},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_onClick:function(e,t){this.fireEvent("click",e,t)},_fill:function(){var e=this.getDom();var t=n.getViewportRect();e.style.width=t.width+"px";e.style.height=t.height+"px"}};e.inherits(o,i)})();(function(){var e=baidu.editor.utils,c=baidu.editor.ui.uiUtils,u=baidu.editor.dom.domUtils,a=baidu.editor.ui.UIBase,t=baidu.editor.ui.Popup=function(e){this.initOptions(e);this.initPopup()};var o=[];function i(e,t){for(var i=0;i<o.length;i++){var n=o[i];if(!n.isHidden()){if(n.queryAutoHide(t)!==false){if(e&&/scroll/gi.test(e.type)&&n.className=="edui-wordpastepop")return;n.hide()}}}if(o.length)n.editor.fireEvent("afterhidepop")}t.postHide=i;var f=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];t.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,canSideUp:true,initPopup:function(){this.initUIBase();o.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;">'+' <div id="##_body" class="edui-popup-body">'+' <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe>'+' <div class="edui-shadow"></div>'+' <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div>"+" </div>"+"</div>"},getContentHtmlTpl:function(){if(this.content){if(typeof this.content=="string"){return this.content}return this.content.renderHtml()}else{return""}},_UIBase_postRender:a.prototype.postRender,postRender:function(){if(this.content instanceof a){this.content.postRender()}if(this.captureWheel&&!this.captured){this.captured=true;var e=(document.documentElement.clientHeight||document.body.clientHeight)-80,t=this.getDom().offsetHeight,i=c.getClientRect(this.combox.getDom()).top,n=this.getDom("content"),o=this.getDom("body").getElementsByTagName("iframe"),r=this;o.length&&(o=o[0]);while(i+t>e){t-=30}n.style.height=t+"px";o&&(o.style.height=t+"px");if(window.XMLHttpRequest){u.on(n,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}if(e.wheelDelta){n.scrollTop-=e.wheelDelta/120*60}else{n.scrollTop-=e.detail/-3*60}})}else{u.on(this.getDom(),"mousewheel",function(e){e.returnValue=false;r.getDom("content").scrollTop-=e.wheelDelta/120*60})}}this.fireEvent("postRenderAfter");this.hide(true);this._UIBase_postRender()},_doAutoRender:function(){if(!this.getDom()&&this.autoRender){this.render()}},mesureSize:function(){var e=this.getDom("content");return c.getClientRect(e)},fitSize:function(){if(this.captureWheel&&this.sized){return this.__size}this.sized=true;var e=this.getDom("body");e.style.width="";e.style.height="";var t=this.mesureSize();if(this.captureWheel){e.style.width=-(-20-t.width)+"px";var i=parseInt(this.getDom("content").style.height,10);!window.isNaN(i)&&(t.height=i)}else{e.style.width=t.width+"px"}e.style.height=t.height+"px";this.__size=t;this.captureWheel&&(this.getDom("content").style.overflow="auto");return t},showAnchor:function(e,t){this.showAnchorRect(c.getClientRect(e),t)},showAnchorRect:function(e,t,i){this._doAutoRender();var n=c.getViewportRect();this.getDom().style.visibility="hidden";this._show();var o=this.fitSize();var r,a,s,l;if(t){r=this.canSideLeft&&(e.right+o.width>n.right&&e.left>o.width);a=this.canSideUp&&(e.top+o.height>n.bottom&&e.bottom>o.height);s=r?e.left-o.width:e.right;l=a?e.bottom-o.height:e.top}else{r=this.canSideLeft&&(e.right+o.width>n.right&&e.left>o.width);a=this.canSideUp&&(e.top+o.height>n.bottom&&e.bottom>o.height);s=r?e.right-o.width:e.left;l=a?e.top-o.height:e.bottom}var d=this.getDom();c.setViewportOffset(d,{left:s,top:l});u.removeClasses(d,f);d.className+=" "+f[(a?1:0)*2+(r?1:0)];if(this.editor){d.style.zIndex=this.editor.container.style.zIndex*1+10;baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=d.style.zIndex-1}this.getDom().style.visibility="visible"},showAt:function(e){var t=e.left;var i=e.top;var n={left:t,top:i,right:t,bottom:i,height:0,width:0};this.showAnchorRect(n,false,true)},_show:function(){if(this._hidden){var e=this.getDom();e.style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(e){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=true;if(!e){this.fireEvent("hide")}}},queryAutoHide:function(e){return!e||!c.contains(this.getDom(),e)}};e.inherits(t,a);u.on(document,"mousedown",function(e){var t=e.target||e.srcElement;i(e,t)});u.on(window,"scroll",function(e,t){i(e,t)})})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.ColorPicker=function(e){this.initOptions(e);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase()};i.prototype={getHtmlTpl:function(){return n(this.noColorText,this.editor)},_onTableClick:function(e){var t=e.target||e.srcElement;var i=t.getAttribute("data-color");if(i){this.fireEvent("pickcolor",i)}},_onTableOver:function(e){var t=e.target||e.srcElement;var i=t.getAttribute("data-color");if(i){this.getDom("preview").style.backgroundColor=i}},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};e.inherits(i,t);var o=("ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,"+"f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,"+"d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,"+"bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,"+"a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,"+"7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,"+"c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,").split(",");function n(e,t){var i='<div id="##" class="edui-colorpicker %%">'+'<div class="edui-colorpicker-topbar edui-clearfix">'+'<div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div>'+'<div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+e+"</div>"+"</div>"+'<table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0">'+'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+t.getLang("themeColor")+"</td> </tr>"+'<tr class="edui-colorpicker-tablefirstrow" >';for(var n=0;n<o.length;n++){if(n&&n%10===0){i+="</tr>"+(n==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+t.getLang("standardColor")+"</td></tr>":"")+"<tr"+(n==60?' class="edui-colorpicker-tablefirstrow"':"")+">"}i+=n<70?'<td style="padding: 0 2px;"><a hidefocus title="'+o[n]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell"'+' data-color="#'+o[n]+'"'+' style="background-color:#'+o[n]+";border:solid #ccc;"+(n<10||n>=60?"border-width:1px;":n>=10&&n<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"'+"></a></td>":""}i+="</tr></table></div>";return i}})();(function(){var e=baidu.editor.utils,s=baidu.editor.ui.uiUtils,t=baidu.editor.ui.UIBase;var i=baidu.editor.ui.TablePicker=function(e){this.initOptions(e);this.initTablePicker()};i.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this;return'<div id="##" class="edui-tablepicker %%">'+'<div class="edui-tablepicker-body">'+'<div class="edui-infoarea">'+'<span id="##_label" class="edui-label"></span>'+"</div>"+'<div class="edui-pickarea"'+' onmousemove="$$._onMouseMove(event, this);"'+' onmouseover="$$._onMouseOver(event, this);"'+' onmouseout="$$._onMouseOut(event, this);"'+' onclick="$$._onClick(event, this);"'+">"+'<div id="##_overlay" class="edui-overlay"></div>'+"</div>"+"</div>"+"</div>"},_UIBase_render:t.prototype.render,render:function(e){this._UIBase_render(e);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(e,t){var i=this.getDom("overlay").style;var n=this.lengthOfCellSide;i.width=e*n+"px";i.height=t*n+"px";var o=this.getDom("label");o.innerHTML=e+this.editor.getLang("t_col")+" x "+t+this.editor.getLang("t_row");this.numCols=e;this.numRows=t},_onMouseOver:function(e,t){var i=e.relatedTarget||e.fromElement;if(!s.contains(t,i)&&t!==i){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility=""}},_onMouseOut:function(e,t){var i=e.relatedTarget||e.toElement;if(!s.contains(t,i)&&t!==i){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(e,t){var i=this.getDom("overlay").style;var n=s.getEventOffset(e);var o=this.lengthOfCellSide;var r=Math.ceil(n.left/o);var a=Math.ceil(n.top/o);this._track(r,a)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}};e.inherits(i,t)})();(function(){var e=baidu.editor.browser,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils;var i='onmousedown="$$.Stateful_onMouseDown(event, this);"'+' onmouseup="$$.Stateful_onMouseUp(event, this);"'+(e.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);"'+' onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);"'+' onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:false,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return i})},Stateful_onMouseEnter:function(e,t){this.target=t;if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(e,t){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(e,t){var i=e.relatedTarget;if(!n.contains(t,i)&&t!==i){this.Stateful_onMouseEnter(e,t)}},Stateful_onMouseOut:function(e,t){var i=e.relatedTarget;if(!n.contains(t,i)&&t!==i){this.Stateful_onMouseLeave(e,t)}},Stateful_onMouseDown:function(e,t){if(!this.isDisabled()){this.addState("active")}},Stateful_onMouseUp:function(e,t){if(!this.isDisabled()){this.removeState("active")}},Stateful_postRender:function(){if(this.disabled&&!this.hasState("disabled")){this.addState("disabled")}},hasState:function(e){return t.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){if(!this.hasState(e)){this.getStateDom().className+=" edui-state-"+e}},removeState:function(e){if(this.hasState(e)){t.removeClasses(this.getStateDom(),["edui-state-"+e])}},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){if(!this.isDisabled()&&e){this.addState("checked")}else{this.removeState("checked")}},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){if(e){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else{this.removeState("disabled")}}}})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.Stateful,n=baidu.editor.ui.Button=function(e){if(e.name){var t=e.name;var i=e.cssRules;if(!e.className){e.className="edui-for-"+t}e.cssRules=".edui-"+(e.theme||"default")+" .edui-toolbar .edui-button.edui-for-"+t+" .edui-icon {"+i+"}"}this.initOptions(e);this.initButton()};n.prototype={uiName:"button",label:"",title:"",showIcon:true,showText:true,cssRules:"",initButton:function(){this.initUIBase();this.Stateful_init();if(this.cssRules){e.cssRule("edui-customize-"+this.name+"-style",this.cssRules)}},getHtmlTpl:function(){return'<div id="##" class="edui-box %%">'+'<div id="##_state" stateful>'+'<div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"><svg class="edui-iconfont"><use xlink:href="#'+this.className+'"></use></svg></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div>"+"</div>"+"</div></div>"},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled)},_onMouseDown:function(e){var t=e.target||e.srcElement,i=t&&t.tagName&&t.tagName.toLowerCase();if(i=="input"||i=="object"||i=="object"){return false}},_onClick:function(){if(!this.isDisabled()){this.fireEvent("click")}},setTitle:function(e){var t=this.getDom("label");t.innerHTML=e}};e.inherits(n,t);e.extend(n.prototype,i)})();(function(){var t=baidu.editor.utils,i=baidu.editor.ui.uiUtils,e=baidu.editor.dom.domUtils,n=baidu.editor.ui.UIBase,o=baidu.editor.ui.Stateful,r=baidu.editor.ui.SplitButton=function(e){this.initOptions(e);this.initSplitButton()};r.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var e=this;if(this.popup!=null){var t=this.popup;this.popup=null;this.setPopup(t)}},_UIBase_postRender:n.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},setPopup:function(e){if(this.popup===e)return;if(this.popup!=null){this.popup.dispose()}e.addListener("show",t.bind(this._onPopupShow,this));e.addListener("hide",t.bind(this._onPopupHide,this));e.addListener("postrender",t.bind(function(){e.getDom("body").appendChild(i.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(i.getClientRect(this.getDom()).width+20)+'px"></div>'));e.getDom().className+=" "+this.className},this));this.popup=e},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%">'+"<div "+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body">'+'<div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);">'+'<div class="edui-box edui-icon"><svg class="edui-iconfont"><use xlink:href="#'+this.className+'"></use></svg></div>'+"</div>"+'<div class="edui-box edui-splitborder"></div>'+'<div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div>'+"</div></div></div>"},showPopup:function(){var e=i.getClientRect(this.getDom());e.top-=this.popup.SHADOW_RADIUS;e.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(e)},_onArrowClick:function(e,t){if(!this.isDisabled()){this.showPopup()}},_onButtonClick:function(){if(!this.isDisabled()){this.fireEvent("buttonclick")}}};t.inherits(r,n);t.extend(r.prototype,o,true)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.ColorPicker,o=baidu.editor.ui.Popup,i=baidu.editor.ui.SplitButton,r=baidu.editor.ui.ColorButton=function(e){this.initOptions(e);this.initColorButton()};r.prototype={initColorButton:function(){var i=this;this.popup=new o({content:new n({noColorText:i.editor.getLang("clearColor"),editor:i.editor,onpickcolor:function(e,t){i._onPickColor(t)},onpicknocolor:function(e,t){i._onPickNoColor(t)}}),editor:i.editor});this.initSplitButton()},_SplitButton_postRender:i.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(t.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(e){this.getDom("colorlump").style.backgroundColor=e;this.color=e},_onPickColor:function(e){if(this.fireEvent("pickcolor",e)!==false){this.setColor(e);this.popup.hide()}},_onPickNoColor:function(e){if(this.fireEvent("picknocolor")!==false){this.popup.hide()}}};e.inherits(r,i)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,i=baidu.editor.ui.TablePicker,n=baidu.editor.ui.SplitButton,o=baidu.editor.ui.TableButton=function(e){this.initOptions(e);this.initTableButton()};o.prototype={initTableButton:function(){var n=this;this.popup=new t({content:new i({editor:n.editor,onpicktable:function(e,t,i){n._onPickTable(t,i)}}),editor:n.editor});this.initSplitButton()},_onPickTable:function(e,t){if(this.fireEvent("picktable",e,t)!==false){this.popup.hide()}}};e.inherits(o,n)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase;var i=baidu.editor.ui.AutoTypeSetPicker=function(e){this.initOptions(e);this.initAutoTypeSetPicker()};i.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,t=e.options.autotypeset,i=e.getLang("autoTypeSet");var n="textAlignValue"+e.uid,o="imageBlockLineValue"+e.uid,r="symbolConverValue"+e.uid;return'<div id="##" class="edui-autotypesetpicker %%">'+'<div class="edui-autotypesetpicker-body">'+"<table >"+'<tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(t["mergeEmptyline"]?"checked":"")+">"+i.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(t["removeEmptyline"]?"checked":"")+">"+i.delLine+"</td></tr>"+'<tr><td nowrap><input type="checkbox" name="removeClass" '+(t["removeClass"]?"checked":"")+">"+i.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(t["indent"]?"checked":"")+">"+i.indent+"</td></tr>"+"<tr>"+'<td nowrap><input type="checkbox" name="textAlign" '+(t["textAlign"]?"checked":"")+">"+i.alignment+"</td>"+'<td colspan="2" id="'+n+'">'+'<input type="radio" name="'+n+'" value="left" '+(t["textAlign"]&&t["textAlign"]=="left"?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+n+'" value="center" '+(t["textAlign"]&&t["textAlign"]=="center"?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+n+'" value="right" '+(t["textAlign"]&&t["textAlign"]=="right"?"checked":"")+">"+e.getLang("justifyright")+"</td>"+"</tr>"+"<tr>"+'<td nowrap><input type="checkbox" name="imageBlockLine" '+(t["imageBlockLine"]?"checked":"")+">"+i.imageFloat+"</td>"+'<td nowrap id="'+o+'">'+'<input type="radio" name="'+o+'" value="none" '+(t["imageBlockLine"]&&t["imageBlockLine"]=="none"?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="'+o+'" value="left" '+(t["imageBlockLine"]&&t["imageBlockLine"]=="left"?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+o+'" value="center" '+(t["imageBlockLine"]&&t["imageBlockLine"]=="center"?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+o+'" value="right" '+(t["imageBlockLine"]&&t["imageBlockLine"]=="right"?"checked":"")+">"+e.getLang("justifyright")+"</td>"+"</tr>"+'<tr><td nowrap><input type="checkbox" name="clearFontSize" '+(t["clearFontSize"]?"checked":"")+">"+i.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(t["clearFontFamily"]?"checked":"")+">"+i.removeFontFamily+"</td></tr>"+'<tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(t["removeEmptyNode"]?"checked":"")+">"+i.removeHtml+"</td></tr>"+'<tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(t["pasteFilter"]?"checked":"")+">"+i.pasteFilter+"</td></tr>"+"<tr>"+'<td nowrap><input type="checkbox" name="symbolConver" '+(t["bdc2sb"]||t["tobdc"]?"checked":"")+">"+i.symbol+"</td>"+'<td id="'+r+'">'+'<input type="radio" name="bdc" value="bdc2sb" '+(t["bdc2sb"]?"checked":"")+">"+i.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(t["tobdc"]?"checked":"")+">"+i.tobdc+""+"</td>"+'<td nowrap align="right"><button >'+i.run+"</button></td>"+"</tr>"+"</table>"+"</div>"+"</div>"},_UIBase_render:t.prototype.render};e.inherits(i,t)})();(function(){var g=baidu.editor.utils,e=baidu.editor.ui.Popup,t=baidu.editor.ui.AutoTypeSetPicker,i=baidu.editor.ui.SplitButton,n=baidu.editor.ui.AutoTypeSetButton=function(e){this.initOptions(e);this.initAutoTypeSetButton()};function u(e){var t={},i=e.getDom(),n=e.editor.uid,o=null,r=null,a=domUtils.getElementsByTagName(i,"input");for(var s=a.length-1,l;l=a[s--];){o=l.getAttribute("type");if(o=="checkbox"){r=l.getAttribute("name");t[r]&&delete t[r];if(l.checked){var d=document.getElementById(r+"Value"+n);if(d){if(/input/gi.test(d.tagName)){t[r]=d.value}else{var c=d.getElementsByTagName("input");for(var u=c.length-1,f;f=c[u--];){if(f.checked){t[r]=f.value;break}}}}else{t[r]=true}}else{t[r]=false}}else{t[l.getAttribute("value")]=l.checked}}var m=domUtils.getElementsByTagName(i,"select");for(var s=0,h;h=m[s++];){var p=h.getAttribute("name");t[p]=t[p]?h.value:""}g.extend(e.editor.options.autotypeset,t);e.editor.setPreferences("autotypeset",t)}n.prototype={initAutoTypeSetButton:function(){var c=this;this.popup=new e({content:new t({editor:c.editor}),editor:c.editor,hide:function(){if(!this._hidden&&this.getDom()){u(this);this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide")}}});var i=0;this.popup.addListener("postRenderAfter",function(){var d=this;if(i)return;var e=this.getDom(),t=e.getElementsByTagName("button")[0];t.onclick=function(){u(d);c.editor.execCommand("autotypeset");d.hide()};domUtils.on(e,"click",function(e){var t=e.target||e.srcElement,i=c.editor.uid;if(t&&t.tagName=="INPUT"){if(t.name=="imageBlockLine"||t.name=="textAlign"||t.name=="symbolConver"){var n=t.checked,o=document.getElementById(t.name+"Value"+i),r=o.getElementsByTagName("input"),a={imageBlockLine:"none",textAlign:"left",symbolConver:"tobdc"};for(var s=0;s<r.length;s++){if(n){if(r[s].value==a[t.name]){r[s].checked="checked"}}else{r[s].checked=false}}}if(t.name=="imageBlockLineValue"+i||t.name=="textAlignValue"+i||t.name=="bdc"){var l=t.parentNode.previousSibling.getElementsByTagName("input");l&&(l[0].checked=true)}u(d)}});i=1});this.initSplitButton()}};g.inherits(n,i)})();(function(){var e=baidu.editor.utils,i=baidu.editor.ui.Popup,t=baidu.editor.ui.Stateful,n=baidu.editor.ui.UIBase;var o=baidu.editor.ui.CellAlignPicker=function(e){this.initOptions(e);this.initSelected();this.initCellAlignPicker()};o.prototype={initSelected:function(){var e={valign:{top:0,middle:1,bottom:2},align:{left:0,center:1,right:2},count:3},t=-1;if(this.selected){this.selectedIndex=e.valign[this.selected.valign]*e.count+e.align[this.selected.align]}},initCellAlignPicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){var e=["left","center","right"],t=9,i=null,n=-1,o=[];for(var r=0;r<t;r++){i=this.selectedIndex===r?' class="edui-cellalign-selected" ':"";n=r%3;n===0&&o.push("<tr>");o.push('<td index="'+r+'" '+i+' stateful><div class="edui-icon edui-'+e[n]+'"></div></td>');n===2&&o.push("</tr>")}return'<div id="##" class="edui-cellalignpicker %%">'+'<div class="edui-cellalignpicker-body">'+'<table onclick="$$._onClick(event);">'+o.join("")+"</table>"+"</div>"+"</div>"},getStateDom:function(){return this.target},_onClick:function(e){var t=e.target||e.srcElement;if(/icon/.test(t.className)){this.items[t.parentNode.getAttribute("index")].onclick();i.postHide(e)}},_UIBase_render:n.prototype.render};e.inherits(o,n);e.extend(o.prototype,t,true)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.Stateful,o=baidu.editor.ui.uiUtils,i=baidu.editor.ui.UIBase;var n=baidu.editor.ui.PastePicker=function(e){this.initOptions(e);this.initPastePicker()};n.prototype={initPastePicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div>'+'<div class="edui-pastecontainer">'+'<div class="edui-title">'+this.editor.getLang("pasteOpt")+"</div>"+'<div class="edui-button">'+'<div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful>'+'<div class="edui-richtxticon"></div></div>'+'<div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful>'+'<div class="edui-tagicon"></div></div>'+'<div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful>'+'<div class="edui-plaintxticon"></div></div>'+"</div>"+"</div>"+"</div>"},getStateDom:function(){return this.target},format:function(e){this.editor.ui._isTransfer=true;this.editor.fireEvent("pasteTransfer",e)},_onClick:function(e){var t=domUtils.getNextDomNode(e),i=o.getViewportRect().height,n=o.getClientRect(t);if(n.top+n.height>i)t.style.top=-n.height-e.offsetHeight+"px";else t.style.top="";if(/hidden/gi.test(domUtils.getComputedStyle(t,"visibility"))){t.style.visibility="visible";domUtils.addClass(e,"edui-state-opened")}else{t.style.visibility="hidden";domUtils.removeClasses(e,"edui-state-opened")}},_UIBase_render:i.prototype.render};e.inherits(n,i);e.extend(n.prototype,t,true)})();(function(){var e=baidu.editor.utils,i=baidu.editor.ui.uiUtils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Toolbar=function(e){this.initOptions(e);this.initToolbar()};n.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(e,t){if(t===undefined){this.items.push(e)}else{this.items.splice(t,0,e)}},getHtmlTpl:function(){var e=[];for(var t=0;t<this.items.length;t++){e[t]=this.items[t].renderHtml()}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+e.join("")+"</div>"},postRender:function(){var e=this.getDom();for(var t=0;t<this.items.length;t++){this.items[t].postRender()}i.makeUnselectable(e)},_onMouseDown:function(e){var t=e.target||e.srcElement,i=t&&t.tagName&&t.tagName.toLowerCase();if(i=="input"||i=="object"||i=="object"){return false}}};e.inherits(n,t)})();(function(){var e=baidu.editor.utils,i=baidu.editor.dom.domUtils,o=baidu.editor.ui.uiUtils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Popup,r=baidu.editor.ui.Stateful,a=baidu.editor.ui.CellAlignPicker,s=baidu.editor.ui.Menu=function(e){this.initOptions(e);this.initMenu()};var l={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return true}};s.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];if(t=="-"){this.items[e]=this.getSeparator()}else if(!(t instanceof d)){t.editor=this.editor;t.theme=this.editor.options.theme;this.items[e]=this.createItem(t)}}},getSeparator:function(){return l},createItem:function(e){e.menu=this;return new d(e)},_Popup_getContentHtmlTpl:n.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0){return this._Popup_getContentHtmlTpl()}var e=[];for(var t=0;t<this.items.length;t++){var i=this.items[t];e[t]=i.renderHtml()}return'<div class="%%-body">'+e.join("")+"</div>"},_Popup_postRender:n.prototype.postRender,postRender:function(){var n=this;for(var e=0;e<this.items.length;e++){var t=this.items[e];t.ownerMenu=this;t.postRender()}i.on(this.getDom(),"mouseover",function(e){e=e||event;var t=e.relatedTarget||e.fromElement;var i=n.getDom();if(!o.contains(i,t)&&i!==t){n.fireEvent("over")}});this._Popup_postRender()},queryAutoHide:function(e){if(e){if(o.contains(this.getDom(),e)){return false}for(var t=0;t<this.items.length;t++){var i=this.items[t];if(i.queryAutoHide(e)===false){return false}}}},clearItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];clearTimeout(t._showingTimer);clearTimeout(t._closingTimer);if(t.subMenu){t.subMenu.destroy()}}this.items=[]},destroy:function(){if(this.getDom()){i.remove(this.getDom())}this.clearItems()},dispose:function(){this.destroy()}};e.inherits(s,n);var d=baidu.editor.ui.MenuItem=function(e){this.initOptions(e);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof s)){if(e.className&&e.className.indexOf("aligntd")!=-1){var t=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment");this.subMenu=new n({content:new a(this.subMenu),parentMenu:t,editor:t.editor,destroy:function(){if(this.getDom()){i.remove(this.getDom())}}});this.subMenu.addListener("postRenderAfter",function(){i.on(this.getDom(),"mouseover",function(){t.addState("opened")})})}else{this.subMenu=new s(this.subMenu)}}};d.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);">'+'<div class="%%-body">'+this.renderLabelHtml()+"</div>"+"</div>"},postRender:function(){var i=this;this.addListener("over",function(){i.ownerMenu.fireEvent("submenuover",i);if(i.subMenu){i.delayShowSubMenu()}});if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){i.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(i._closingTimer);i._closingTimer=null;i.addState("opened")});this.ownerMenu.addListener("hide",function(){i.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(e,t){if(t!==i){i.delayHideSubMenu()}});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(e){if(e&&o.contains(i.getDom(),e)){return false}return this._bakQueryAutoHide(e)}}this.getDom().style.tabIndex="-1";o.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var e=this;if(!e.isDisabled()){e.addState("opened");clearTimeout(e._showingTimer);clearTimeout(e._closingTimer);e._closingTimer=null;e._showingTimer=setTimeout(function(){e.showSubMenu()},250)}},delayHideSubMenu:function(){var e=this;if(!e.isDisabled()){e.removeState("opened");clearTimeout(e._showingTimer);if(!e._closingTimer){e._closingTimer=setTimeout(function(){if(!e.hasState("opened")){e.hideSubMenu()}e._closingTimer=null},400)}}},renderLabelHtml:function(){return'<div class="edui-arrow"></div>'+'<div class="edui-box edui-icon"></div>'+'<div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(e){if(this.subMenu&&this.hasState("opened")){return this.subMenu.queryAutoHide(e)}},_onClick:function(e,t){if(this.hasState("disabled"))return;if(this.fireEvent("click",e,t)!==false){if(this.subMenu){this.showSubMenu()}else{n.postHide(e)}}},showSubMenu:function(){var e=o.getClientRect(this.getDom());e.right-=5;e.left+=2;e.width-=7;e.top-=4;e.bottom+=4;e.height+=8;this.subMenu.showAnchorRect(e,true,true)},hideSubMenu:function(){this.subMenu.hide()}};e.inherits(d,t);e.extend(d.prototype,r,true)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.Menu,i=baidu.editor.ui.SplitButton,o=baidu.editor.ui.Combox=function(e){this.initOptions(e);this.initCombox()};o.prototype={uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var e=this;this.items=this.items||[];for(var t=0;t<this.items.length;t++){var i=this.items[t];i.uiName="listitem";i.index=t;i.onclick=function(){e.selectByIndex(this.index)}}this.popup=new n({items:this.items,uiName:"list",editor:this.editor,captureWheel:true,combox:this});this.initSplitButton()},_SplitButton_postRender:i.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var e=t.getClientRect(this.getDom());e.top+=1;e.bottom-=1;e.height-=2;this.popup.showAnchorRect(e)},getValue:function(){return this.value},setValue:function(e){var t=this.indexByValue(e);if(t!=-1){this.selectedIndex=t;this.setLabel(this.items[t].label);this.value=this.items[t].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(e));this.value=e}},setLabel:function(e){this.getDom("button_body").innerHTML=e;this.label=e},getLabelForUnknowValue:function(e){return e},indexByValue:function(e){for(var t=0;t<this.items.length;t++){if(e==this.items[t].value){return t}}return-1},getItem:function(e){return this.items[e]},selectByIndex:function(e){if(e<this.items.length&&this.fireEvent("select",e)!==false){this.selectedIndex=e;this.value=this.items[e].value;this.setLabel(this.items[e].label)}}};e.inherits(o,i)})();(function(){var n=baidu.editor.utils,c=baidu.editor.dom.domUtils,u=baidu.editor.ui.uiUtils,o=baidu.editor.ui.Mask,e=baidu.editor.ui.UIBase,r=baidu.editor.ui.Button,t=baidu.editor.ui.Dialog=function(e){if(e.name){var t=e.name;var i=e.cssRules;if(!e.className){e.className="edui-for-"+t}if(i){e.cssRules=".edui-for-"+t+" .edui-dialog-content  {"+i+"}"}}this.initOptions(n.extend({autoReset:true,draggable:true,onok:function(){},oncancel:function(){},onclose:function(e,t){return t?this.onok():this.oncancel()},holdScroll:false},e));this.initDialog()};var a;var s;var l;t.prototype={draggable:false,uiName:"dialog",initDialog:function(){var e=this,t=this.editor.options.theme;if(this.cssRules){this.cssRules=".edui-"+t+" "+this.cssRules;n.cssRule("edui-customize-"+this.name+"-style",this.cssRules)}this.initUIBase();this.modalMask=a||(a=new o({className:"edui-dialog-modalmask",theme:t,onclick:function(){l&&l.close(false)}}));this.dragMask=s||(s=new o({className:"edui-dialog-dragmask",theme:t}));this.closeButton=new r({className:"edui-dialog-closebutton",title:e.closeDialog,theme:t,onclick:function(){e.close(false)}});this.fullscreen&&this.initResizeEvent();if(this.buttons){for(var i=0;i<this.buttons.length;i++){if(!(this.buttons[i]instanceof r)){this.buttons[i]=new r(n.extend(this.buttons[i],{editor:this.editor},true))}}}},initResizeEvent:function(){var r=this;c.on(window,"resize",function(){if(r._hidden||r._hidden===undefined){return}if(r.__resizeTimer){window.clearTimeout(r.__resizeTimer)}r.__resizeTimer=window.setTimeout(function(){r.__resizeTimer=null;var e=r.getDom(),t=r.getDom("content"),i=UE.ui.uiUtils.getClientRect(e),n=UE.ui.uiUtils.getClientRect(t),o=u.getViewportRect();t.style.width=o.width-i.width+n.width+"px";t.style.height=o.height-i.height+n.height+"px";e.style.width=o.width+"px";e.style.height=o.height+"px";r.fireEvent("resize")},100)})},fitSize:function(){var e=this.getDom("body");var t=this.mesureSize();e.style.width=t.width+"px";e.style.height=t.height+"px";return t},safeSetOffset:function(e){var t=this;var i=t.getDom();var n=u.getViewportRect();var o=u.getClientRect(i);var r=e.left;if(r+o.width>n.right){r=n.right-o.width}var a=e.top;if(a+o.height>n.bottom){a=n.bottom-o.height}i.style.left=Math.max(r,0)+"px";i.style.top=Math.max(a,0)+"px"},showAtCenter:function(){var e=u.getViewportRect();if(!this.fullscreen){this.getDom().style.display="";var t=this.fitSize();var i=this.getDom("titlebar").offsetHeight|0;var n=e.width/2-t.width/2;var o=e.height/2-(t.height-i)/2-i;var r=this.getDom();this.safeSetOffset({left:Math.max(n|0,0),top:Math.max(o|0,0)});if(!c.hasClass(r,"edui-state-centered")){r.className+=" edui-state-centered"}}else{var a=this.getDom(),s=this.getDom("content");a.style.display="block";var l=UE.ui.uiUtils.getClientRect(a),d=UE.ui.uiUtils.getClientRect(s);a.style.left="-100000px";s.style.width=e.width-l.width+d.width+"px";s.style.height=e.height-l.height+d.height+"px";a.style.width=e.width+"px";a.style.height=e.height+"px";a.style.left=0;this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}};document.documentElement.style.overflowX="hidden";document.documentElement.style.overflowY="hidden";document.body.style.overflowX="hidden";document.body.style.overflowY="hidden"}this._show()},getContentHtml:function(){var e="";if(typeof this.content=="string"){e=this.content}else if(this.iframeUrl){e='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'}return e},getHtmlTpl:function(){var e="";if(this.buttons){var t=[];for(var i=0;i<this.buttons.length;i++){t[i]=this.buttons[i].renderHtml()}e='<div class="%%-foot">'+'<div id="##_buttons" class="%%-buttons">'+t.join("")+"</div>"+"</div>"}return'<div id="##" class="%%"><div '+(!this.fullscreen?'class="%%"':'class="%%-wrap edui-dialog-fullscreen-flag"')+'><div id="##_body" class="%%-body">'+'<div class="%%-shadow"></div>'+'<div id="##_titlebar" class="%%-titlebar">'+'<div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);">'+'<span class="%%-caption">'+(this.title||"")+"</span>"+"</div>"+this.closeButton.renderHtml()+"</div>"+'<div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+e+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var e=this;this.addListener("show",function(){e.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){e.modalMask.hide()});if(this.buttons){for(var t=0;t<this.buttons.length;t++){this.buttons[t].postRender()}}c.on(window,"resize",function(){setTimeout(function(){if(!e.isHidden()){e.safeSetOffset(u.getClientRect(e.getDom()))}})});this._hide()},mesureSize:function(){var e=this.getDom("body");var t=u.getClientRect(this.getDom("content")).width;var i=e.style;i.width=t;return u.getClientRect(e)},_onTitlebarMouseDown:function(e,t){if(this.draggable){var o;var i=u.getViewportRect();var r=this;u.startDrag(e,{ondragstart:function(){o=u.getClientRect(r.getDom());r.getDom("contmask").style.visibility="visible";r.dragMask.show(r.getDom().style.zIndex-1)},ondragmove:function(e,t){var i=o.left+e;var n=o.top+t;r.safeSetOffset({left:i,top:n})},ondragstop:function(){r.getDom("contmask").style.visibility="hidden";c.removeClasses(r.getDom(),["edui-state-centered"]);r.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml();this.fireEvent("dialogafterreset")},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent("show");baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var e=this.getDom();e.style.display="none";e.style.zIndex="";e.style.width="";e.style.height="";this._hidden=true;this.fireEvent("hide")}},open:function(){if(this.autoReset){try{this.reset()}catch(e){this.render();this.open()}}this.showAtCenter();if(this.iframeUrl){try{this.getDom("iframe").focus()}catch(e){}}l=this},_onCloseButtonClick:function(e,t){this.close(false)},close:function(e){if(this.fireEvent("close",e)!==false){if(this.fullscreen){document.documentElement.style.overflowX=this._originalContext.html.overflowX;document.documentElement.style.overflowY=this._originalContext.html.overflowY;document.body.style.overflowX=this._originalContext.body.overflowX;document.body.style.overflowY=this._originalContext.body.overflowY;delete this._originalContext}this._hide();var t=this.getDom("content");var i=this.getDom("iframe");if(t&&i){var n=i.contentDocument||i.contentWindow.document;n&&(n.body.innerHTML="");c.remove(t)}}}};n.inherits(t,e)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.Menu,i=baidu.editor.ui.SplitButton,n=baidu.editor.ui.MenuButton=function(e){this.initOptions(e);this.initMenuButton()};n.prototype={initMenuButton:function(){var i=this;this.uiName="menubutton";this.popup=new t({items:i.items,className:i.className,editor:i.editor});this.popup.addListener("show",function(){var e=this;for(var t=0;t<e.items.length;t++){e.items[t].removeState("checked");if(e.items[t].value==i._value){e.items[t].addState("checked");this.value=i._value}}});this.initSplitButton()},setValue:function(e){this._value=e}};e.inherits(n,i)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,i=baidu.editor.ui.SplitButton,n=baidu.editor.ui.MultiMenuPop=function(e){this.initOptions(e);this.initMultiMenu()};n.prototype={initMultiMenu:function(){var e=this;this.popup=new t({content:"",editor:e.editor,iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>';e.editor.container.style.zIndex&&(this.getDom().style.zIndex=e.editor.container.style.zIndex*1+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};e.inherits(n,i)})();(function(){var n=baidu.editor.ui,e=n.UIBase,d=n.uiUtils,o=baidu.editor.utils,c=baidu.editor.dom.domUtils;var r=[],u,a=false;var t=n.ShortCutMenu=function(e){this.initOptions(e);this.initShortCutMenu()};t.postHide=i;t.prototype={isHidden:true,SPACE:5,initShortCutMenu:function(){this.items=this.items||[];this.initUIBase();this.initItems();this.initEvent();r.push(this)},initEvent:function(){var d=this,e=d.editor.document;c.on(e,"mousemove",function(e){if(d.isHidden===false){if(d.getSubMenuMark()||d.eventType=="contextmenu")return;var t=true,i=d.getDom(),n=i.offsetWidth,o=i.offsetHeight,r=n/2+d.SPACE,a=o/2,s=Math.abs(e.screenX-d.left),l=Math.abs(e.screenY-d.top);clearTimeout(u);u=setTimeout(function(){if(l>0&&l<a){d.setOpacity(i,"1")}else if(l>a&&l<a+70){d.setOpacity(i,"0.5");t=false}else if(l>a+70&&l<a+140){d.hide()}if(t&&s>0&&s<r){d.setOpacity(i,"1")}else if(s>r&&s<r+70){d.setOpacity(i,"0.5")}else if(s>r+70&&s<r+140){d.hide()}})}});if(browser.chrome){c.on(e,"mouseout",function(e){var t=e.relatedTarget||e.toElement;if(t==null||t.tagName=="HTML"){d.hide()}})}d.editor.addListener("afterhidepop",function(){if(!d.isHidden){a=true}})},initItems:function(){if(o.isArray(this.items)){for(var e=0,t=this.items.length;e<t;e++){var i=this.items[e].toLowerCase();if(n[i]){this.items[e]=new n[i](this.editor);this.items[e].className+=" edui-shortcutsubmenu "}}}},setOpacity:function(e,t){if(browser.ie&&browser.version<9){e.style.filter="alpha(opacity = "+parseFloat(t)*100+");"}else{e.style.opacity=t}},getSubMenuMark:function(){a=false;var e=d.getFixedLayer();var t=c.getElementsByTagName(e,"div",function(e){return c.hasClass(e,"edui-shortcutsubmenu edui-popup")});for(var i=0,n;n=t[i++];){if(n.style.display!="none"){a=true}}return a},show:function(e,t){var i=this,n={},o=this.getDom(),r=d.getFixedLayer();function a(e){if(e.left<0){e.left=0}if(e.top<0){e.top=0}o.style.cssText="position:absolute;left:"+e.left+"px;top:"+e.top+"px;"}function s(e){if(!e.tagName){e=e.getDom()}n.left=parseInt(e.style.left);n.top=parseInt(e.style.top);n.top-=o.offsetHeight+15;a(n)}i.eventType=e.type;o.style.cssText="display:block;left:-9999px";if(e.type=="contextmenu"&&t){var l=c.getElementsByTagName(r,"div","edui-contextmenu")[0];if(l){s(l)}else{i.editor.addListener("aftershowcontextmenu",function(e,t){s(t)})}}else{n=d.getViewportOffsetByEvent(e);n.top-=o.offsetHeight+i.SPACE;n.left+=i.SPACE+20;a(n);i.setOpacity(o,.2)}i.isHidden=false;i.left=e.screenX+o.offsetWidth/2-i.SPACE;i.top=e.screenY-o.offsetHeight/2-i.SPACE;if(i.editor){o.style.zIndex=i.editor.container.style.zIndex*1+10;r.style.zIndex=o.style.zIndex-1}},hide:function(){if(this.getDom()){this.getDom().style.display="none"}this.isHidden=true},postRender:function(){if(o.isArray(this.items)){for(var e=0,t;t=this.items[e++];){t.postRender()}}},getHtmlTpl:function(){var e;if(o.isArray(this.items)){e=[];for(var t=0;t<this.items.length;t++){e[t]=this.items[t].renderHtml()}e=e.join("")}else{e=this.items}return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+e+"</div>"}};o.inherits(t,e);function i(e){var t=e.target||e.srcElement,i=c.findParent(t,function(e){return c.hasClass(e,"edui-shortcutmenu")||c.hasClass(e,"edui-popup")},true);if(!i){for(var n=0,o;o=r[n++];){o.hide()}}}c.on(document,"mousedown",function(e){i(e)});c.on(window,"scroll",function(e){i(e)})})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.Breakline=function(e){this.initOptions(e);this.initSeparator()};i.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}};e.inherits(i,t)})();(function(){var e=baidu.editor.utils,i=baidu.editor.dom.domUtils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Message=function(e){this.initOptions(e);this.initMessage()};n.prototype={initMessage:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-message %%">'+' <div id="##_closer" class="edui-message-closer">×</div>'+' <div id="##_body" class="edui-message-body edui-message-type-info">'+' <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe>'+' <div class="edui-shadow"></div>'+' <div id="##_content" class="edui-message-content">'+"  </div>"+" </div>"+"</div>"},reset:function(e){var t=this;if(!e.keepshow){clearTimeout(this.timer);t.timer=setTimeout(function(){t.hide()},e.timeout||4e3)}e.content!==undefined&&t.setContent(e.content);e.type!==undefined&&t.setType(e.type);t.show()},postRender:function(){var e=this,t=this.getDom("closer");t&&i.on(t,"click",function(){e.hide()})},setContent:function(e){this.getDom("content").innerHTML=e},setType:function(e){e=e||"info";var t=this.getDom("body");t.className=t.className.replace(/edui-message-type-[\w-]+/,"edui-message-type-"+e)},getContent:function(){return this.getDom("content").innerHTML},getType:function(){var e=this.getDom("body").match(/edui-message-type-([\w-]+)/);return e?e[1]:""},show:function(){this.getDom().style.display="block"},hide:function(){var e=this.getDom();if(e){e.style.display="none";e.parentNode&&e.parentNode.removeChild(e)}}};e.inherits(n,t)})();(function(n){var i='<svg><symbol id="edui-for-close" viewBox="0 0 1024 1024"><path d="M960 153.6L870.4 64 512 422.4 153.6 64 64 153.6 422.4 512 64 870.4 153.6 960 512 601.6l358.4 358.4 89.6-89.6L601.6 512 960 153.6z" fill="#666666" ></path></symbol><symbol id="edui-for-italic" viewBox="0 0 1024 1024"><path d="M384 64v64h128L384 896H256v64h384v-64H512l128-768h128V64z" fill="#666666" ></path></symbol><symbol id="edui-for-insertcaption" viewBox="0 0 1024 1024"><path d="M576 0v448h448V0z m384 256h-128v128h-64V256h-128V192h128V64h64v128h128z" fill="#1C7C59" ></path><path d="M997.12 448H0v576h1024V448zM60.16 960v-256H320v256z m481.92 0H384v-256h256v256z m421.76 0H704v-256h259.84zM448 0H0v64h192v384h64V64h192V0z" fill="#666666" ></path></symbol><symbol id="edui-for-insertparagraph" viewBox="0 0 1024 1024"><path d="M997.12 0H0v576h1024V0zM60.16 512V256H320v256z m481.92 0H384V256h256v256z m421.76 0H704V256h259.84zM448 576H0v64h192v384h64v-384h192V576z" fill="#666666" ></path></symbol><symbol id="edui-for-inserttitlecol" viewBox="0 0 1024 1024"><path d="M64 960v-128H0v192h192v-64H64zM448 1024h576V0H448z m512-320v256h-192v-256z m-256 0v256H512v-256z m256-320v256h-192V384z m-256 0v256H512V384z m256-320v256h-192V64z m-256 0v256H512V64zM64 512h128V448H0v192h64V512zM384 512v128h64V448H256v64h128zM384 960H256v64h192v-192H384v128z" fill="#666666" ></path><path d="M64 960v-128H0v192h192v-64H64zM448 1024h576V0H448z m512-320v256h-192v-256z m-256 0v256H512v-256z m256-320v256h-192V384z m-256 0v256H512V384z m256-320v256h-192V64z m-256 0v256H512V64zM64 512h128V448H0v192h64V512zM384 512v128h64V448H256v64h128zM384 960H256v64h192v-192H384v128z" fill="#666666" ></path><path d="M0 448h448V0H0z m256-384v128h128v64H256v128H192V256H64V192h128V64z" fill="#1C7C59" ></path></symbol><symbol id="edui-for-insertimage" viewBox="0 0 1024 1024"><path d="M350.08 535.04l128 192 263.68-430.08 156.16 256V576h64V117.12a53.12 53.12 0 0 0-55.04-53.12H53.12a53.12 53.12 0 0 0-53.12 53.12v727.04a51.84 51.84 0 0 0 51.84 51.84H640v-64H154.88z m-53.12-350.72a119.04 119.04 0 1 1-118.4 118.4 119.04 119.04 0 0 1 118.4-118.4z" fill="#666666" ></path><path d="M1024 704h-192V512h-64v192H576v64h192v192h64v-192h192v-64z" fill="#666666" ></path></symbol><symbol id="edui-for-previousstep" viewBox="0 0 1024 1024"><path d="M483.84 896a53.76 53.76 0 0 1-24.96-6.4h-3.84L87.04 556.8A55.04 55.04 0 0 1 64 517.76a56.96 56.96 0 0 1 22.4-48.64l371.2-328.32a46.08 46.08 0 0 1 30.72-12.8 40.96 40.96 0 0 1 35.84 21.12 60.16 60.16 0 0 1 7.04 28.16v192h29.44a400 400 0 0 1 97.28 12.16 363.52 363.52 0 0 1 120.32 54.4A384 384 0 0 1 889.6 556.8 602.88 602.88 0 0 1 960 768a60.16 60.16 0 0 1-10.24 53.12 39.68 39.68 0 0 1-29.44 13.44 55.04 55.04 0 0 1-42.24-26.24 229.12 229.12 0 0 0-64-68.48 314.24 314.24 0 0 0-89.6-47.36 437.76 437.76 0 0 0-141.44-21.76h-48.64V832a68.48 68.48 0 0 1-12.8 51.2 43.52 43.52 0 0 1-37.76 12.8zM145.28 512l312.96 281.6v-148.48a64 64 0 0 1 68.48-48h53.12a507.52 507.52 0 0 1 167.68 26.88 384 384 0 0 1 110.72 60.16l9.6 7.68a354.56 354.56 0 0 0-128-197.76 312.32 312.32 0 0 0-176-53.12 240 240 0 0 0-33.92 0h-12.8a56.96 56.96 0 0 1-49.28-24.96 55.04 55.04 0 0 1-8.96-26.24V234.88z" fill="#666666" ></path></symbol><symbol id="edui-for-nextstep" viewBox="0 0 1024 1024"><path d="M506.88 880.64a68.48 68.48 0 0 1-12.8-51.2v-160h-48.64a437.76 437.76 0 0 0-141.44 21.76 314.24 314.24 0 0 0-89.6 47.36 229.12 229.12 0 0 0-64 68.48 55.04 55.04 0 0 1-42.24 26.24 39.68 39.68 0 0 1-29.44-13.44A60.16 60.16 0 0 1 64 768a602.88 602.88 0 0 1 70.4-211.2 384 384 0 0 1 111.36-124.16 363.52 363.52 0 0 1 120.32-54.4 400 400 0 0 1 97.28-12.16h29.44v-192a60.16 60.16 0 0 1 7.04-28.16 40.96 40.96 0 0 1 35.84-17.92 46.08 46.08 0 0 1 30.72 12.8l370.56 328.32a56.96 56.96 0 0 1 22.4 48.64 55.04 55.04 0 0 1-22.4 39.68l-368 330.24h-3.84a53.76 53.76 0 0 1-24.96 6.4 43.52 43.52 0 0 1-33.28-13.44z m58.24-645.76v154.24a55.04 55.04 0 0 1-8.96 26.24 56.96 56.96 0 0 1-49.28 24.96h-9.6a240 240 0 0 0-33.92 0 312.32 312.32 0 0 0-176 53.12 354.56 354.56 0 0 0-128 197.76l9.6-7.68a384 384 0 0 1 110.72-60.16 507.52 507.52 0 0 1 163.84-28.16h53.12a64 64 0 0 1 68.48 48v150.4l313.6-281.6z" fill="#666666" ></path></symbol><symbol id="edui-for-scaleboard" viewBox="0 0 1024 1024"><path d="M374.935252 651.624033a35.190169 35.190169 0 0 0-26.872492-11.516783H39.029096a40.308739 40.308739 0 0 0-39.029096 39.668918V704.089375a41.588381 41.588381 0 0 0 43.507845 37.749454h163.154419L19.834459 932.505561a53.105164 53.105164 0 0 0 0 74.859087 51.825521 51.825521 0 0 0 73.579443 0l186.827805-188.107448v165.073883a37.749454 37.749454 0 0 0 37.109633 39.029096h26.872492a36.469811 36.469811 0 0 0 39.668918-33.910526v-309.673485a36.469811 36.469811 0 0 0-8.957498-26.872493zM383.89275 325.955016V34.196526A35.82999 35.82999 0 0 0 343.584011 0.286h-28.152135a37.109632 37.109632 0 0 0-37.109632 39.029096v166.353525L94.053724 21.400101a51.1857 51.1857 0 0 0-72.939623 0 52.465342 52.465342 0 0 0 0 73.579444l184.26852 184.26852H43.507845A42.228202 42.228202 0 0 0 0 320.196625v26.872493A40.308739 40.308739 0 0 0 38.389275 384.17875h310.313306a35.190169 35.190169 0 0 0 26.232671-10.876961A35.82999 35.82999 0 0 0 383.89275 345.789475v-19.194637zM648.778747 372.661968a35.190169 35.190169 0 0 0 26.872493 10.876961H984.684904a40.308739 40.308739 0 0 0 39.029096-39.029096V320.196625a41.588381 41.588381 0 0 0-43.507845-37.749454h-163.154419l186.827805-187.467626a53.105164 53.105164 0 0 0 0-74.859086 51.825521 51.825521 0 0 0-73.579444 0L743.472292 205.0288V39.954918a37.749454 37.749454 0 0 0-36.469811-39.668918h-26.872492a36.469811 36.469811 0 0 0-40.308739 34.550348v309.673485a36.469811 36.469811 0 0 0 8.957497 26.872492zM639.82125 698.330984v291.118669a35.82999 35.82999 0 0 0 38.389275 33.910526h28.152135a37.109632 37.109632 0 0 0 37.109632-39.029096v-166.353525l185.548163 184.26852a51.1857 51.1857 0 0 0 72.939622 0 52.465342 52.465342 0 0 0 0-73.579444l-183.628698-183.628699h161.874776A42.228202 42.228202 0 0 0 1023.714 704.089375v-26.872492a40.308739 40.308739 0 0 0-38.389275-39.029097h-309.673485a35.190169 35.190169 0 0 0-26.232671 10.876962 35.82999 35.82999 0 0 0-8.957498 26.872492v19.194638z" fill="#666666" ></path></symbol><symbol id="edui-for-brush" viewBox="0 0 1024 1024"><path d="M986.878764 284.789854L739.847564 35.198746a122.875623 122.875623 0 0 0-172.153867 0L92.830614 511.981761a87.676877 87.676877 0 0 0-32.638837 56.317993L0.03392 915.807374a119.675737 119.675737 0 0 0 28.158997 79.99715 94.076649 94.076649 0 0 0 69.757515 28.158997h14.079498l344.307734-63.99772a86.396922 86.396922 0 0 0 55.678017-30.078928l474.863083-475.50306a115.195896 115.195896 0 0 0 0-169.593959zM448.017961 868.449062l-348.787575 63.99772 60.797834-348.147598 347.50762-351.347483 288.629718 287.349763z m474.863083-479.982901l-63.997721 70.397492-291.189626-286.709786 63.99772-63.99772a34.558769 34.558769 0 0 1 41.598518 0l246.391223 249.591108a35.838723 35.838723 0 0 1 9.599658 18.559339c1.919932 2.559909-3.199886 7.679726-7.679727 12.159567z" fill="#666666" ></path></symbol><symbol id="edui-for-background" viewBox="0 0 1024 1024"><path d="M988.16 448H419.84a35.84 35.84 0 0 0-35.84 35.84v504.32a35.84 35.84 0 0 0 35.84 35.84h568.96a35.84 35.84 0 0 0 35.84-35.84V483.84a35.84 35.84 0 0 0-36.48-35.84z m-323.84 164.48a80 80 0 1 1-80-81.92 81.28 81.28 0 0 1 80 81.92zM929.28 960H461.44l131.2-205.44 85.12 133.12 177.28-298.24L960 768v163.2a30.72 30.72 0 0 1-30.72 28.8z" fill="#666666" ></path><path d="M320 832H224a32 32 0 0 0 0 64H320zM320 640H128a64 64 0 0 1-64-64V128a64 64 0 0 1 64-64h640a64 64 0 0 1 64 64v256h64V64a64 64 0 0 0-64-64H64a64 64 0 0 0-64 64v576a64 64 0 0 0 64 64h256z" fill="#666666" ></path></symbol><symbol id="edui-for-strikethrough" viewBox="0 0 1024 1024"><path d="M994.56 672a128 128 0 0 1-98.56 48.64c-74.24 0-122.88-57.6-128-150.4h236.8v-52.48H768c7.68-92.8 58.24-150.4 132.48-150.4a115.84 115.84 0 0 1 87.04 40.96l28.8-35.2A156.8 156.8 0 0 0 896 320c-100.48 0-176.64 74.24-186.88 197.76H608.64a96.64 96.64 0 0 0 44.16-83.84c0-76.16-59.52-105.6-146.56-105.6h-128v192H267.52l-64-192h-58.88l-64 192H22.4v52.48H64l-64 192h54.4l41.6-136.32h155.52l40.32 131.84h56.96l-64-192h95.36v192h135.68c95.36 0 161.28-41.6 161.28-128a103.04 103.04 0 0 0-19.84-64h52.48C719.36 694.4 794.24 768 896 768a163.84 163.84 0 0 0 128-64zM433.92 371.2h64c64 0 100.48 18.56 100.48 69.76S570.24 512 497.28 512h-64z m-261.76 0c14.08 49.92 26.88 96.64 42.88 145.28H128c17.28-47.36 31.36-93.44 44.16-144z m64 212.48h-128l4.48-14.72h120.96z m384 47.36c0 58.24-42.88 85.12-115.84 85.12h-70.4V570.24H588.8a64 64 0 0 1 35.2 61.44z" fill="#666666" ></path></symbol><symbol id="edui-for-spechars" viewBox="0 0 1024 1024"><path d="M954.24 1024l-158.72-160A434.56 434.56 0 0 1 512 965.76a421.12 421.12 0 0 1-283.52-101.76L69.76 1024 0 951.68l160.64-155.52A477.44 477.44 0 0 1 64 512a426.88 426.88 0 0 1 96.64-282.24L0 72.32 69.76 0l158.72 160A464 464 0 0 1 512 60.16a432 432 0 0 1 281.6 99.84L954.24 0 1024 72.32l-161.92 157.44A430.08 430.08 0 0 1 960 512a448 448 0 0 1-99.2 283.52L1024 951.68zM512 160a337.28 337.28 0 0 0-250.24 103.68A342.4 342.4 0 0 0 160.64 512a343.04 343.04 0 0 0 104.96 249.6 339.84 339.84 0 0 0 492.16 0A344.32 344.32 0 0 0 862.08 512a332.8 332.8 0 0 0-105.6-250.24A339.84 339.84 0 0 0 512 160z" fill="#666666" ></path></symbol><symbol id="edui-for-clearboard" viewBox="0 0 1024 1024"><path d="M704 128V0H320v128H0v64h64v832h896V192h64V128zM384 64h256v64H384zM320 960H128V384h192z m320 0H384V384h256z m256 0h-192V384h192z m0-640H128V192h768z" fill="#666666" ></path></symbol><symbol id="edui-for-bold" viewBox="0 0 1024 1024"><path d="M876.8 710.4c-6.4-51.2-25.6-102.4-57.6-140.8-32-38.4-83.2-70.4-128-76.8 44.8-12.8 76.8-38.4 102.4-76.8 32-38.4 38.4-83.2 38.4-134.4 0-57.6-25.6-121.6-70.4-166.4C710.4 76.8 640 64 576 64H192v896h384c76.8 6.4 140.8-12.8 211.2-51.2 57.6-44.8 96-121.6 89.6-198.4zM288 153.6h262.4c44.8 0 96 6.4 134.4 38.4 32 25.6 51.2 57.6 44.8 96 0 44.8-12.8 83.2-44.8 115.2-38.4 32-89.6 44.8-134.4 38.4H288V153.6zM768 704c0 51.2-25.6 102.4-70.4 134.4-44.8 25.6-89.6 38.4-140.8 38.4H288V544h275.2c51.2 0 102.4 6.4 147.2 38.4 44.8 25.6 64 76.8 57.6 121.6z" fill="#666666" ></path></symbol><symbol id="edui-for-fullscreen" viewBox="0 0 1024 1024"><path d="M960 0H64a64 64 0 0 0-64 64v704a64 64 0 0 0 64 64h320v128H288a32 32 0 0 0 0 64h448a32 32 0 0 0 0-64H640v-128h320a64 64 0 0 0 64-64V64a64 64 0 0 0-64-64zM576 960H448v-128h128z m384-256a64 64 0 0 1-64 64H128a64 64 0 0 1-64-64V128a64 64 0 0 1 64-64h768a64 64 0 0 1 64 64z" fill="#666666" ></path></symbol><symbol id="edui-for-formatmatch" viewBox="0 0 1024 1024"><path d="M128 448v448l108.8-300.8L396.8 896H896V448zM128 256h768v64H128zM384 128h256v128H384z" fill="#666666" ></path></symbol><symbol id="edui-for-underline" viewBox="0 0 1024 1024"><path d="M192 896h640v64H192zM704 64v384c0 102.4-83.2 192-192 192-102.4 0-192-83.2-192-192V64H192v384c0 179.2 147.2 320 320 320s320-147.2 320-320V64h-128z" fill="#666666" ></path></symbol><symbol id="edui-for-removeformat" viewBox="0 0 1024 1024"><path d="M682.88 64L0 768l170.88 192h398.08L1024 448zM528 832h-288L192 775.04l192-227.2 192 227.84z" fill="#666666" ></path></symbol><symbol id="edui-for-blockquote" viewBox="0 0 1024 1024"><path d="M401.92 894.272v-292.48H248.064c-7.36-187.392 65.92-344.96 219.648-472.448L401.856 61.888C218.88 189.44 127.36 384.384 127.36 646.72v247.552h274.56z m428.16 0v-292.48h-153.728c-7.36-187.392 65.92-344.96 219.648-472.448L830.08 61.888c-182.976 127.616-274.432 322.496-274.432 584.832v247.552h274.496z" fill="#666666" ></path></symbol><symbol id="edui-for-anchor" viewBox="0 0 1024 1024"><path d="M722.56 668.16l76.8 72.32A438.4 438.4 0 0 1 576 837.76V436.48a192 192 0 1 0-128 0v400a448 448 0 0 1-231.68-90.88l82.56-77.44L0 625.28l45.44 280.96L124.8 832a618.88 618.88 0 0 0 384 128 597.12 597.12 0 0 0 384-133.12l87.04 81.92 44.16-283.52zM384 256a128 128 0 1 1 128 128 128 128 0 0 1-128-128z" fill="#666666" ></path></symbol><symbol id="edui-for-help" viewBox="0 0 1024 1024"><path d="M512 0a512 512 0 1 0 512 512 512 512 0 0 0-512-512z m0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z" fill="#666666" ></path><path d="M512 640H448v-27.52a151.68 151.68 0 0 1 75.52-117.76q64-47.36 64-90.24a64 64 0 0 0-64-57.6q-76.8 0-95.36 87.68L320 414.08A192 192 0 0 1 536.96 256q153.6 7.68 167.04 135.68a156.16 156.16 0 0 1-90.24 140.8A544 544 0 0 0 512 620.16zM448 704h128v128H448z" fill="#666666" ></path></symbol><symbol id="edui-for-horizontal" viewBox="0 0 1024 1024"><path d="M0 448h1024v128H0z" fill="#666666" ></path></symbol><symbol id="edui-for-simpleupload" viewBox="0 0 1024 1024"><path d="M128 832l160-320L448 832H128zM514.56 832l254.72-512L1024 832H514.56z" fill="#666666" ></path><path d="M960 64H64a64 64 0 0 0-64 64v768a64 64 0 0 0 64 64h896a64 64 0 0 0 64-64V128a64 64 0 0 0-64-64z m0 768a64 64 0 0 1-64 64H128a64 64 0 0 1-64-64V192a64 64 0 0 1 64-64h768a64 64 0 0 1 64 64z" fill="#666666" ></path></symbol><symbol id="edui-for-indent" viewBox="0 0 1024 1024"><path d="M896 416L768 320v384l128-96L1024 512zM32 128h960c19.2 0 32-12.8 32-32s-12.8-32-32-32H32c-19.2 0-32 12.8-32 32s12.8 32 32 32zM32 960h960c19.2 0 32-12.8 32-32s-12.8-32-32-32H32c-19.2 0-32 12.8-32 32s12.8 32 32 32zM64 448h512c32 0 64-25.6 64-64 0-32-25.6-64-64-64H64c-38.4 0-64 25.6-64 64s25.6 64 64 64zM64 704h512c32 0 64-25.6 64-64 0-32-25.6-64-64-64H64c-32 0-64 25.6-64 64s25.6 64 64 64z" fill="#666666" ></path></symbol><symbol id="edui-for-justifycenter" viewBox="0 0 1024 1024"><path d="M992 64H32C12.8 64 0 51.2 0 32S12.8 0 32 0h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM800 256h-576c-19.2 0-32-12.8-32-32s12.8-32 32-32h576c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM800 640h-576c-19.2 0-32-12.8-32-32s12.8-32 32-32h576c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 832H32c-19.2 0-32-12.8-32-32s12.8-32 32-32h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM800 1024h-576c-19.2 0-32-12.8-32-32s12.8-32 32-32h576c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path><path d="M992 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM800 640h-576c-19.2 0-32-12.8-32-32s12.8-32 32-32h576c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path></symbol><symbol id="edui-for-justifyleft" viewBox="0 0 1024 1024"><path d="M992 64H32C12.8 64 0 51.2 0 32S12.8 0 32 0h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM608 256h-576C12.8 256 0 243.2 0 224S12.8 192 32 192h576c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 832H32c-19.2 0-32-12.8-32-32s12.8-32 32-32h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM608 1024h-576c-19.2 0-32-12.8-32-32s12.8-32 32-32h576c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path><path d="M992 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM608 640h-576c-19.2 0-32-12.8-32-32S12.8 576 32 576h576c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path></symbol><symbol id="edui-for-justifyjustify" viewBox="0 0 1024 1024"><path d="M992 64H32C12.8 64 0 51.2 0 32S12.8 0 32 0h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 256H32C12.8 256 0 243.2 0 224S12.8 192 32 192h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 832H32c-19.2 0-32-12.8-32-32s12.8-32 32-32h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 1024H32c-19.2 0-32-12.8-32-32s12.8-32 32-32h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path><path d="M992 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 640H32c-19.2 0-32-12.8-32-32S12.8 576 32 576h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path></symbol><symbol id="edui-for-justifyright" viewBox="0 0 1024 1024"><path d="M992 64H32C12.8 64 0 51.2 0 32S12.8 0 32 0h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 256h-576c-19.2 0-32-12.8-32-32s12.8-32 32-32h576c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 832H32c-19.2 0-32-12.8-32-32s12.8-32 32-32h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 1024h-576c-19.2 0-32-12.8-32-32s12.8-32 32-32h576c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path><path d="M992 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 640h-576c-19.2 0-32-12.8-32-32s12.8-32 32-32h576c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path></symbol><symbol id="edui-for-link" viewBox="0 0 1024 1024"><path d="M759.04 768v-124.16a132.48 132.48 0 1 0 0-264.96H608.64A135.04 135.04 0 0 0 472.32 512h-128a261.12 261.12 0 0 1 264.32-256h150.4A261.12 261.12 0 0 1 1024 512a261.12 261.12 0 0 1-264.96 256z" fill="#666666" ></path><path d="M415.36 768H264.96A261.12 261.12 0 0 1 0 512a261.12 261.12 0 0 1 264.96-256v124.16a132.48 132.48 0 1 0 0 264.96h150.4A135.04 135.04 0 0 0 552.32 512h128a261.12 261.12 0 0 1-264.96 256z" fill="#666666" ></path></symbol><symbol id="edui-for-cleardoc" viewBox="0 0 1024 1024"><path d="M895.909541 256.060626h-191.95477V56.427664A63.984924 63.984924 0 0 0 639.969847 0.120932H137.688197A69.743567 69.743567 0 0 0 64.105535 64.105855v895.78893a69.743567 69.743567 0 0 0 73.582662 63.984923h748.623606A69.743567 69.743567 0 0 0 959.894465 959.894785V313.007208A63.984924 63.984924 0 0 0 895.909541 256.060626z m0 695.516119a8.31804 8.31804 0 0 1-8.31804 8.31804H137.688197a9.597739 9.597739 0 0 1-9.597738-9.597739V72.423895A8.31804 8.31804 0 0 1 136.408499 64.105855h491.404213a11.517286 11.517286 0 0 1 12.157135 10.877437v191.954771A60.145828 60.145828 0 0 0 703.954771 320.045549h180.437484a11.517286 11.517286 0 0 1 12.157136 10.877437v620.653759z" fill="#666666" ></path></symbol><symbol id="edui-for-drafts" viewBox="0 0 1024 1024"><path d="M832 320V160a32 32 0 0 0-32-32H576V64a64 64 0 0 0-64-64H384a64 64 0 0 0-64 64v64H96a32 32 0 0 0-32 32v640a32 32 0 0 0 32 32H384v192h448l192-192V320zM384 64h128v64H384zM192 192h512v64H192z m640 741.76V832h101.76zM960 768h-192v192H448V384h512z" fill="#666666" ></path></symbol><symbol id="edui-for-subscript" viewBox="0 0 1024 1024"><path d="M716.8 819.2v-29.696c0-99.328 160.256-135.68 160.256-179.2 0-16.896-10.752-27.136-32.768-27.136a116.736 116.736 0 0 0-74.24 35.84l-47.104-51.2A170.496 170.496 0 0 1 852.992 512c76.288 0 119.808 40.448 119.808 93.184 0 74.752-95.232 94.72-142.848 141.312H972.8V819.2zM72.192 720.384l494.592-494.592a56.832 56.832 0 0 1 78.848-8.704l7.68 7.68a56.832 56.832 0 0 1-8.704 78.848l-494.592 494.592a56.832 56.832 0 0 1-78.848 8.704l-7.68-7.68a56.832 56.832 0 0 1 8.704-78.848z" fill="#666666" ></path><path d="M566.784 798.208L72.192 303.616a56.832 56.832 0 0 1-8.704-78.848l7.68-7.68a56.832 56.832 0 0 1 78.848 8.704l494.592 494.592a56.832 56.832 0 0 1 8.704 78.848l-7.68 7.68a56.832 56.832 0 0 1-78.848-8.704z" fill="#666666" ></path></symbol><symbol id="edui-for-unlink" viewBox="0 0 1024 1024"><path d="M539.416837 448.012238V320.036713A95.341766 95.341766 0 0 0 639.877623 233.653234v-19.196329A95.341766 95.341766 0 0 0 539.416837 128.073426H228.436312A95.341766 95.341766 0 0 0 127.975525 214.456905v18.556451A95.341766 95.341766 0 0 0 228.436312 320.036713v127.975525A222.037535 222.037535 0 0 1 0 233.653234v-19.196329A222.037535 222.037535 0 0 1 228.436312 0.097901h310.980525A222.037535 222.037535 0 0 1 767.853148 214.456905v18.556451A222.037535 222.037535 0 0 1 539.416837 448.012238zM795.367886 1023.902099H484.387361A222.037535 222.037535 0 0 1 255.951049 809.543095v-18.556451A222.037535 222.037535 0 0 1 484.387361 575.987762v127.975525A95.341766 95.341766 0 0 0 383.926574 790.346766v18.556451A95.341766 95.341766 0 0 0 484.387361 895.926574h311.620403A95.341766 95.341766 0 0 0 895.828673 809.543095v-18.556451A95.341766 95.341766 0 0 0 795.367886 703.963287V575.987762A222.037535 222.037535 0 0 1 1023.804197 790.346766v18.556451A222.037535 222.037535 0 0 1 795.367886 1023.902099z" fill="#666666" ></path></symbol><symbol id="edui-for-superscript" viewBox="0 0 1024 1024"><path d="M716.8 512v-29.696c0-99.328 160.256-135.68 160.256-179.2 0-16.896-10.752-27.136-32.768-27.136a116.736 116.736 0 0 0-74.24 35.84l-47.104-51.2A170.496 170.496 0 0 1 852.992 204.8C929.28 204.8 972.8 245.248 972.8 297.984c0 74.752-95.232 94.72-142.848 141.312H972.8V512zM72.192 720.384l494.592-494.592a56.832 56.832 0 0 1 78.848-8.704l7.68 7.68a56.832 56.832 0 0 1-8.704 78.848l-494.592 494.592a56.832 56.832 0 0 1-78.848 8.704l-7.68-7.68a56.832 56.832 0 0 1 8.704-78.848z" fill="#666666" ></path><path d="M566.784 798.208L72.192 303.616a56.832 56.832 0 0 1-8.704-78.848l7.68-7.68a56.832 56.832 0 0 1 78.848 8.704l494.592 494.592a56.832 56.832 0 0 1 8.704 78.848l-7.68 7.68a56.832 56.832 0 0 1-78.848-8.704z" fill="#666666" ></path></symbol><symbol id="edui-for-forecolor" viewBox="0 0 1024 1024"><path d="M588.8 64H428.8L192 768h108.8l57.6-166.4h275.2l57.6 166.4H832L588.8 64zM390.4 499.2l102.4-313.6 102.4 313.6H390.4zM192 896h640v64H192z" fill="#666666" ></path></symbol><symbol id="edui-for-backcolor" viewBox="0 0 1024 1024"><path d="M910.593777 663.461622s-105.39199 190.467451-105.39199 246.972795a105.39199 105.39199 0 1 0 210.149088 0c0.634892-59.04491-104.757098-246.972795-104.757098-246.972795zM412.838838 100.947749L388.712961 126.978301 266.813792 0 169.675392 100.312858l121.899168 126.978301L0.15936 526.325057 412.838838 952.337256 825.518316 526.325057z m-274.27313 425.377308l275.542913-283.796502 274.908021 283.796502z" fill="#666666" ></path></symbol><symbol id="edui-for-touppercase" viewBox="0 0 1024 1024"><path d="M295.68 128L0 896h113.28l74.24-192h328.96l71.04 192H704L408.32 128z m-53.12 448l92.16-250.88A245.76 245.76 0 0 0 353.28 256a225.92 225.92 0 0 0 16 69.12L461.44 576zM996.48 812.16v-115.84Q998.4 576 865.28 576t-152.32 92.16l67.84 17.92q8.32-55.68 82.56-51.84t64 53.76a224.64 224.64 0 0 1-97.28 19.84q-122.88 12.16-128 101.76T820.48 896a139.52 139.52 0 0 0 114.56-44.16 48.64 48.64 0 0 0 19.2 37.76H1024a102.4 102.4 0 0 1-27.52-77.44zM926.72 768q-6.4 64-95.36 71.68-56.96 0-55.04-32t67.84-44.16a149.76 149.76 0 0 0 82.56-23.68zM949.76 384H1024c-15.36-106.88-232.32-128-311.04-128V128L512 288 712.32 448V327.04a488.96 488.96 0 0 1 237.44 56.96z" fill="#666666" ></path></symbol><symbol id="edui-for-tolowercase" viewBox="0 0 1024 1024"><path d="M295.68 128L0 896h113.28l74.24-192h328.96l71.04 192H704L408.32 128z m-53.12 448l92.16-250.88A245.76 245.76 0 0 0 353.28 256a225.92 225.92 0 0 0 16 69.12L461.44 576zM996.48 812.16v-115.84Q998.4 576 865.28 576t-152.32 92.16l67.84 17.92q8.32-55.68 82.56-51.84t64 53.76a224.64 224.64 0 0 1-97.28 19.84q-122.88 12.16-128 101.76T820.48 896a139.52 139.52 0 0 0 114.56-44.16 48.64 48.64 0 0 0 19.2 37.76H1024a102.4 102.4 0 0 1-27.52-77.44zM926.72 768q-6.4 64-95.36 71.68-56.96 0-55.04-32t67.84-44.16a149.76 149.76 0 0 0 82.56-23.68zM586.24 384H512c15.36-106.88 232.32-128 311.04-128V128L1024 288 823.04 448V327.04a488.96 488.96 0 0 0-236.8 56.96z" fill="#666666" ></path></symbol><symbol id="edui-for-insertvideo" viewBox="0 0 1024 1024"><path d="M384 768l256-256-256-256v512z" fill="#666666" ></path><path d="M960 64H64a64 64 0 0 0-64 64v768a64 64 0 0 0 64 64h896a64 64 0 0 0 64-64V128a64 64 0 0 0-64-64z m0 832H64V128h896z" fill="#666666" ></path></symbol><symbol id="edui-for-emotion" viewBox="0 0 1024 1024"><path d="M512 0a512 512 0 1 0 512 512 512 512 0 0 0-512-512z m0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z" fill="#666666" ></path><path d="M320 384m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#666666" ></path><path d="M704 384m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#666666" ></path><path d="M512 832a256 256 0 0 0 256-256H256a256 256 0 0 0 256 256z" fill="#666666" ></path></symbol><symbol id="edui-for-pasteplain" viewBox="0 0 1024 1024"><path d="M640 256V128H576V64a64 64 0 0 0-64-64H320a64 64 0 0 0-64 64v64H192v128zM320 64h192v64H320z" fill="#666666" ></path><path d="M832 384V160a33.28 33.28 0 0 0-33.92-32H704v64h64v64h-64v64H128V128H33.92a33.28 33.28 0 0 0-33.92 32V896h384v128h640V384z m-384 576V448h512v512z" fill="#666666" ></path><path d="M576 576h320v64H576zM704 640h64v256h-64zM704 192h64v128h-64z" fill="#666666" ></path></symbol><symbol id="edui-for-preview" viewBox="0 0 1024 1024"><path d="M895.909541 256.060626h-191.95477V56.427664A63.984924 63.984924 0 0 0 639.969847 0.120932H137.688197A69.743567 69.743567 0 0 0 64.105535 64.105855v895.78893a69.743567 69.743567 0 0 0 73.582662 63.984923h748.623606A69.743567 69.743567 0 0 0 959.894465 959.894785V313.007208A63.984924 63.984924 0 0 0 895.909541 256.060626z m0 695.516119a8.31804 8.31804 0 0 1-8.31804 8.31804H137.688197a9.597739 9.597739 0 0 1-9.597738-9.597739V72.423895A8.31804 8.31804 0 0 1 136.408499 64.105855h491.404213a11.517286 11.517286 0 0 1 12.157135 10.877437v191.954771A60.145828 60.145828 0 0 0 703.954771 320.045549h180.437484a11.517286 11.517286 0 0 1 12.157136 10.877437v620.653759z" fill="#666666" ></path><path d="M767.939694 850.480566l-173.399143-172.759294a225.86678 225.86678 0 1 0-45.429295 45.429296l173.399142 172.759293zM256.060306 543.992782A159.962309 159.962309 0 1 1 416.022615 703.955091 159.962309 159.962309 0 0 1 256.060306 543.992782z" fill="#666666" ></path></symbol><symbol id="edui-for-print" viewBox="0 0 1024 1024"><path d="M320.00576 448h384v64H320.00576zM320.00576 576h384v64H320.00576z" fill="#666666" ></path><path d="M988.80576 179.2H832.00576V0H192.00576v179.2H35.20576a35.2 35.2 0 0 0-35.2 35.84v443.52h192V704l256 256h384v-301.44h192V346.88a36.48 36.48 0 0 0 0-3.84v-128a35.2 35.2 0 0 0-35.2-35.84zM256.00576 64h512v115.2H256.00576z m640 512h-56.96V455.68H768.00576V896H471.04576v-199.04H256.00576V455.68H187.52576V576H128.00576V384h768z m32-274.56a32.64 32.64 0 1 1 32-32.64 32 32 0 0 1-32 32.64z" fill="#666666" ></path></symbol><symbol id="edui-for-searchreplace" viewBox="0 0 1024 1024"><path d="M855.04 0H0v1024h1024V343.04zM512 128h128v256H512z m256 832H256v-320h512z m192-512v512h-128V576H192v384H64V64h128v384h512V64h64l192 320z" fill="#666666" ></path></symbol><symbol id="edui-for-selectall" viewBox="0 0 1024 1024"><path d="M184.32 113.92L298.24 0h-40.32L144 113.92h40.32zM113.92 144L0 257.92v40.32l113.92-113.92v-40.32zM144 0L0 144v40.32L184.32 0h-40.32zM30.72 0L0 30.72v40.32L71.04 0H30.72zM527.36 113.92L641.28 0h-40.32L487.68 113.92h39.68zM113.92 487.68L0 600.96v40.32l113.92-113.92v-39.68zM113.92 373.76L0 487.68v39.68l113.92-113.28v-40.32zM414.08 113.92L527.36 0h-39.68L373.76 113.92h40.32zM300.16 113.92L414.08 0h-40.32L259.84 113.92h40.32zM113.92 259.84L0 373.76v40.32l113.92-113.92v-40.32zM113.92 835.2L0 948.48v40.32l113.92-113.28v-40.32zM875.52 113.92L988.8 0h-40.32l-113.28 113.92h40.32zM113.92 721.28L0 835.2v40.32l113.92-113.92v-40.32zM761.6 113.92L875.52 0h-40.32l-113.92 113.92h40.32zM113.92 607.36L0 721.28v40.32l113.92-113.92v-40.32zM647.68 113.92L761.6 0h-40.32L607.36 113.92h40.32zM910.08 419.2L1024 305.28v-40.32l-113.92 113.92v40.32zM378.88 910.08L264.96 1024h40.32l113.92-113.92h-40.32zM910.08 305.28L1024 192v-40.32l-113.92 113.28v40.32zM264.96 910.08L151.68 1024H192l113.28-113.92h-40.32zM151.68 910.08L37.76 1024h40.32L192 910.08h-40.32zM910.08 151.68V192L1024 78.08V37.76l-113.92 113.92zM910.08 759.04L1024 645.12v-40.32l-113.92 113.92v40.32zM718.72 910.08L604.8 1024h40.32l113.92-113.92h-40.32zM910.08 645.12L1024 531.2v-40.32l-113.92 113.92v40.32zM604.8 910.08L490.88 1024h40.32l113.92-113.92h-40.32zM490.88 910.08L376.96 1024h40.32l113.92-113.92h-40.32zM910.08 531.2L1024 417.28v-40.32l-113.92 113.92v40.32zM988.16 1024l35.84-35.84v-40.32L947.84 1024h40.32zM874.24 1024L1024 874.24v-40.32L833.92 1024h40.32zM833.92 910.08L720.64 1024h39.68l113.92-113.92h-40.32zM910.08 874.24L1024 760.32v-39.68l-113.92 113.28v40.32zM256 630.4Q263.04 768 442.24 768a223.36 223.36 0 0 0 183.04-70.4 77.44 77.44 0 0 0 30.72 60.8H768a163.84 163.84 0 0 1-44.16-124.8V448Q727.04 256 512 256T269.44 403.2l108.8 28.8q13.44-89.6 133.76-83.2 112-6.4 101.76 86.4a359.68 359.68 0 0 1-156.16 32Q259.2 486.4 256 630.4zM611.84 518.4v44.8q-10.24 105.6-152.32 115.2-91.52 0-88.32-51.2-6.4-60.8 108.8-70.4a240 240 0 0 0 131.84-38.4z" fill="#666666" ></path></symbol><symbol id="edui-for-mergecells" viewBox="0 0 1024 1024"><path d="M0 0v1024h1024V0z m320 960H64v-256h256z m0-320H64V384h256z m0-320H64V64h256z m64-256h256v256H384z m576 896H384V384h576z m0-640h-256V64h256z" fill="#666666" ></path></symbol><symbol id="edui-for-deletecol" viewBox="0 0 1024 1024"><path d="M1024 307.84V0h-256v576h256zM832 256V64h128v192z m0 256V320h128v192zM448 307.84V0H0v576h448zM64 256V64h128v192z m192 0V64h128v192zM64 512V320h128v192z m192 0V320h128v192zM640 704V635.52L570.24 704H640zM593.28 708.48z" fill="#666666" ></path><path d="M640 512v136.32l64-34.56V256H512v352l64 32V512zM576 448V320h64v128z" fill="#666666" ></path><path d="M734.72 1024l96.64-92.8L704 808.96l128-122.88-96-92.16-32 19.84V768H512V608l-32-14.08L384 686.08l128 122.88-127.36 122.24L480.64 1024l127.36-122.24L734.72 1024z" fill="#666666" ></path><path d="M512 704h76.8L512 629.76V704z" fill="#666666" ></path></symbol><symbol id="edui-for-deleterow" viewBox="0 0 1024 1024"><path d="M307.84 0H0v256h576V0zM256 192H64V64h192z m256 0H320V64h192zM307.84 576H0v448h576V576zM256 960H64v-128h192z m0-192H64v-128h192z m256 192H320v-128h192z m0-192H320v-128h192zM716.8 360.32h-68.48l68.48 70.4v-70.4zM708.48 430.72zM520.96 344.96h128l-34.56-35.84H256v219.52h352l32-35.84H520.96zM448 448H316.16V384H448z" fill="#666666" ></path><path d="M1024 288.64l-92.8-96L808.96 320l-122.88-128-92.16 96 19.84 21.12h137.6V528.64H608l-14.08 15.36 92.16 96 122.88-128 122.24 127.36L1024 542.72 901.76 416 1024 288.64z" fill="#666666" ></path><path d="M716.8 492.8V416l-74.24 76.8h74.24z" fill="#666666" ></path></symbol><symbol id="edui-for-attachment" viewBox="0 0 1024 1024"><path d="M972.16 372.48l-520.32 512a222.72 222.72 0 0 1-312.32 0A216.32 216.32 0 0 1 138.88 576l468.48-460.8a148.48 148.48 0 0 1 208 0 144.64 144.64 0 0 1 0 206.08l-467.84 463.36a74.24 74.24 0 0 1-104.32 0 72.32 72.32 0 0 1 0-103.04l416.64-411.52-51.84-51.2L192 630.4a144.64 144.64 0 0 0 0 206.08 148.48 148.48 0 0 0 208 0l468.48-463.36a216.96 216.96 0 0 0 0-308.48A222.72 222.72 0 0 0 555.52 64L64 552.96a291.2 291.2 0 0 0 26.24 384 296.96 296.96 0 0 0 385.28 23.04L1024 424.32l-51.84-51.2z" fill="#666666" ></path></symbol><symbol id="edui-for-music" viewBox="0 0 1024 1024"><path d="M991.140186 0.88755h-7.673343a36.448381 36.448381 0 0 0-15.986133 0L219.969177 135.810504a31.972264 31.972264 0 0 0-28.135593 30.693374 30.053928 30.053928 0 0 0 0 3.197226v616.425251A127.889056 127.889056 0 0 0 127.889056 768.221888a127.889056 127.889056 0 1 0 127.889056 127.889056V384.554719a36.448381 36.448381 0 0 0 17.904468 0L959.167922 260.502334v457.203376a127.889056 127.889056 0 0 0-63.944528-17.904468A127.889056 127.889056 0 1 0 1023.11245 832.166416V32.859814a31.972264 31.972264 0 0 0-31.972264-31.972264z" fill="#666666" ></path></symbol><symbol id="edui-for-gmap" viewBox="0 0 1024 1024"><path d="M543.36 572.16h128v144.64a170.24 170.24 0 0 1-103.68 30.08c-135.68 0-208-89.6-208-236.8s83.84-233.6 206.08-233.6a183.04 183.04 0 0 1 138.24 55.68l56.32-64A270.72 270.72 0 0 0 562.56 192 298.24 298.24 0 0 0 256 512c0 202.24 128 320 304 320A306.56 306.56 0 0 0 768 759.68V492.16H543.36z" fill="#1C7C59" ></path><path d="M896 0H128a64 64 0 0 0-64 64v896a64 64 0 0 0 64 64h768a64 64 0 0 0 64-64V64a64 64 0 0 0-64-64z m0 896a64 64 0 0 1-64 64H192a64 64 0 0 1-64-64V128a64 64 0 0 1 64-64h640a64 64 0 0 1 64 64z" fill="#1C7C59" ></path></symbol><symbol id="edui-for-insertframe" viewBox="0 0 1024 1024"><path d="M448 384a256 256 0 1 0 256 256 256 256 0 0 0-256-256z m195.84 170.88a213.76 213.76 0 0 1 0 170.88H547.2a504.32 504.32 0 0 0 0-170.88zM384 640a527.36 527.36 0 0 1 6.4-85.12h115.2A527.36 527.36 0 0 1 512 640a527.36 527.36 0 0 1-6.4 85.12H390.4A527.36 527.36 0 0 1 384 640z m234.88-128H537.6a218.88 218.88 0 0 0-39.68-79.36A213.76 213.76 0 0 1 618.88 512zM448 448c19.2 0 35.84 24.96 48 64h-96c12.16-39.04 28.8-64 48-64z m-49.92-15.36A218.88 218.88 0 0 0 358.4 512H277.12a213.76 213.76 0 0 1 120.96-79.36zM252.16 554.88h96a504.32 504.32 0 0 0 0 170.88h-96a213.76 213.76 0 0 1 0-170.88zM277.12 768H358.4a218.88 218.88 0 0 0 39.68 79.36A213.76 213.76 0 0 1 277.12 768zM448 832c-19.2 0-35.84-24.96-48-64h96c-12.16 39.04-28.8 64-48 64z m49.92 15.36A218.88 218.88 0 0 0 537.6 768h81.28a213.76 213.76 0 0 1-120.96 79.36z" fill="#666666" ></path><path d="M597.76 0H64v1024h896V330.24zM896 355.84V960H128V64h448v256h320z" fill="#666666" ></path></symbol><symbol id="edui-for-pdfformat" viewBox="0 0 1024 1024"><path d="M597.76 0H64v1024h896V330.24zM896 960H128V64h448v291.2h320z" fill="#EF4848" ></path><path d="M213.76 615.68H166.4v133.12h49.28c58.24 0 85.76-21.76 85.76-69.76s-30.72-63.36-87.68-63.36zM486.4 622.08h-32.64v268.8h32.64c77.44 0 119.04-45.44 119.04-135.68S564.48 622.08 486.4 622.08z" fill="#EF4848" ></path><path d="M64 448v576h874.24V448z m175.36 352.64h-54.4v136.96H128V576h109.44c82.56 0 138.24 27.52 138.24 108.8S320 800.64 239.36 800.64z m256 136.96H396.8V576h93.44a159.36 159.36 0 0 1 174.72 179.2 160.64 160.64 0 0 1-171.52 182.4z m411.52-313.6h-158.72v110.72h133.76v48h-133.76v155.52h-56.96V576h214.4z" fill="#EF4848" ></path></symbol><symbol id="edui-for-word" viewBox="0 0 1024 1024"><path d="M718.08 545.92c-12.16 60.16-21.12 117.76-32 177.28h-3.84c-12.8-58.88-23.68-117.12-36.48-177.28L567.68 208H461.44L384 545.92c-12.8 58.88-23.68 117.76-35.84 177.28H345.6c-9.6-58.88-18.56-117.12-29.44-177.28L243.2 208H128L275.84 832h131.84l64-307.2c14.08-58.88 23.68-117.12 34.56-181.76H512c12.16 64 21.76 121.6 34.56 180.48L618.24 832h136.96L896 208h-106.88z" fill="#4972AD" ></path><path d="M960 0H64a64 64 0 0 0-64 64v896a64 64 0 0 0 64 64h896a64 64 0 0 0 64-64V64a64 64 0 0 0-64-64z m0 896a64 64 0 0 1-64 64H128a64 64 0 0 1-64-64V128a64 64 0 0 1 64-64h768a64 64 0 0 1 64 64z" fill="#4972AD" ></path></symbol><symbol id="edui-for-excel" viewBox="0 0 1024 1024"><path d="M960 0H64a64 64 0 0 0-64 64v896a64 64 0 0 0 64 64h896a64 64 0 0 0 64-64V64a64 64 0 0 0-64-64z m0 896a64 64 0 0 1-64 64H128a64 64 0 0 1-64-64V128a64 64 0 0 1 64-64h768a64 64 0 0 1 64 64z" fill="#60BF6B" ></path><path d="M816.64 128h-155.52L586.24 282.88c-19.2 41.6-40.32 85.12-59.52 128h-5.12c-23.04-43.52-46.72-86.4-67.2-128L369.28 128H208.64L422.4 495.36 192 896h156.16l82.56-161.92c21.76-47.36 44.16-93.44 64-136.96h6.4c25.6 43.52 50.56 90.88 73.6 136.96l96 161.92H832L602.88 512z" fill="#60BF6B" ></path></symbol><symbol id="edui-for-time" viewBox="0 0 1024 1024"><path d="M839.710352 230.607611l21.719276-21.719277 43.438553 43.438553 54.298191-53.659389-127.760449-127.760449-54.936993 54.298191 43.438552 43.438553-21.719276 21.719276A477.82408 477.82408 0 0 0 556.720957 74.739863a76.656269 76.656269 0 0 0-152.673737 0 472.713662 472.713662 0 0 0-87.515907 23.635683l51.104179 79.211478a383.281347 383.281347 0 0 1 112.429196-17.24766 383.281347 383.281347 0 1 1-383.281348 383.281347 383.281347 383.281347 0 0 1 47.271366-184.613849L64.843228 304.708671a472.07486 472.07486 0 0 0-63.880225 240.189645 479.101684 479.101684 0 0 0 958.203369 0 473.352464 473.352464 0 0 0-119.45602-314.290705z" fill="#666666" ></path><path d="M480.064688 255.520898a46.632564 46.632564 0 0 0-46.632564 45.993762v182.05864a76.017467 76.017467 0 0 0 0 122.650031v63.880225a46.632564 46.632564 0 0 0 92.626325 0v-63.880225a76.017467 76.017467 0 0 0 0-122.650031V298.959451A46.632564 46.632564 0 0 0 480.064688 255.520898zM252.651088 0L143.415904 251.049283l274.684966 5.110418-50.465378-77.933874-51.104179-79.850281-63.880225-98.375546z" fill="#666666" ></path></symbol><symbol id="edui-for-snapscreen" viewBox="0 0 1024 1024"><path d="M665.6 392.96L460.8 548.48 256 314.88V704h512V548.48l-102.4-155.52z" fill="#666666" ></path><path d="M1024 832h-128V128H192V0H128v128H0v64h128v704h704v128h64v-128h128zM192 832V192h640v640z" fill="#666666" ></path></symbol><symbol id="edui-for-wordimage" viewBox="0 0 1024 1024"><path d="M988.16 448H419.84a35.84 35.84 0 0 0-35.84 35.84v504.32a35.84 35.84 0 0 0 35.84 35.84h568.96a35.84 35.84 0 0 0 35.84-35.84V483.84a35.84 35.84 0 0 0-36.48-35.84z m-323.84 164.48a80 80 0 1 1-80-81.92 81.28 81.28 0 0 1 80 81.92zM929.28 960H461.44l131.2-205.44 85.12 133.12 177.28-298.24L960 768v163.2a30.72 30.72 0 0 1-30.72 28.8z" fill="#666666" ></path><path d="M960 0H64a64 64 0 0 0-64 64v896a64 64 0 0 0 64 64h256v-64H128a64 64 0 0 1-64-64V128a64 64 0 0 1 64-64h768a64 64 0 0 1 64 64v256h64V64a64 64 0 0 0-64-64z" fill="#4972AD" ></path><path d="M320 554.24L241.28 192H122.88l151.68 640H320V565.76zM858.88 384l43.52-192h-116.48l-40.32 192h113.28zM501.76 384c0-26.88 4.48-40.32 7.04-64H512c0 23.68 7.68 64 7.68 64h97.28l-44.8-192H456.32l-42.88 192z" fill="#4972AD" ></path></symbol><symbol id="edui-for-edittd" viewBox="0 0 1024 1024"><path d="M768 768m-192 0a192 192 0 1 0 384 0 192 192 0 1 0-384 0Z" fill="#666666" ></path><path d="M448 768a320 320 0 0 1 448-293.12V128H128v768h346.88A320 320 0 0 1 448 768z" fill="#666666" ></path><path d="M0 0v1024h576a320 320 0 0 1-64-64H64V64h896v448a320 320 0 0 1 64 64V0z" fill="#666666" ></path></symbol><symbol id="edui-for-lineheight" viewBox="0 0 1024 1024"><path d="M380.8 768H0l190.72 254.72L380.8 768z" fill="#666666" ></path><path d="M512 768l512 0 0 64-512 0 0-64Z" fill="#666666" ></path><path d="M512 576l512 0 0 64-512 0 0-64Z" fill="#666666" ></path><path d="M512 384l512 0 0 64-512 0 0-64Z" fill="#666666" ></path><path d="M512 192l512 0 0 64-512 0 0-64Z" fill="#666666" ></path><path d="M2.56 256h380.8L193.28 1.28 2.56 256z" fill="#666666" ></path></symbol><symbol id="edui-for-rowspacingbottom" viewBox="0 0 1024 1024"><path d="M704 768H320l192 256zM672 640H32c-19.2 0-32-12.8-32-32S12.8 576 32 576h640c19.2 0 32 12.8 32 32s-12.8 32-32 32zM864 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h832c19.2 0 32 12.8 32 32s-12.8 32-32 32zM480 256h-448C12.8 256 0 243.2 0 224S12.8 192 32 192h448c19.2 0 32 12.8 32 32s-12.8 32-32 32zM992 64H32C12.8 64 0 51.2 0 32S12.8 0 32 0h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path></symbol><symbol id="edui-for-rowspacingtop" viewBox="0 0 1024 1024"><path d="M320 256h384L512 0zM352 384h640c19.2 0 32 12.8 32 32s-12.8 32-32 32h-640c-19.2 0-32-12.8-32-32s12.8-32 32-32zM160 576h832c19.2 0 32 12.8 32 32s-12.8 32-32 32h-832c-19.2 0-32-12.8-32-32s12.8-32 32-32zM544 768h448c19.2 0 32 12.8 32 32s-12.8 32-32 32h-448c-19.2 0-32-12.8-32-32s12.8-32 32-32zM32 960h960c19.2 0 32 12.8 32 32s-12.8 32-32 32H32c-19.2 0-32-12.8-32-32s12.8-32 32-32z" fill="#666666" ></path></symbol><symbol id="edui-for-scrawl" viewBox="0 0 1024 1024"><path d="M1018.28352 277.12a20.48 20.48 0 0 0-15.36-6.4 68.48 68.48 0 0 0-40.96 23.68l-390.4 389.12a1234.56 1234.56 0 0 0-69.12 105.6l-8.32 14.08 14.08-8.96c3.84 0 90.24-56.96 104.96-71.04l390.4-389.12c16.64-14.08 29.44-41.6 14.72-56.96z m-243.84 120.96a56.96 56.96 0 1 1-56.96-58.88 58.24 58.24 0 0 1 56.96 58.88zM173.48352 603.52a58.88 58.88 0 1 1 56.96-58.88 58.24 58.24 0 0 1-56.96 58.88zM256.68352 398.08a56.96 56.96 0 1 1 56.96 58.88 58.24 58.24 0 0 1-56.96-58.88z m202.88-58.88a56.96 56.96 0 1 1 56.96 58.88 58.24 58.24 0 0 1-56.96-58.88z m442.88 199.04a415.36 415.36 0 0 1-402.56 352.64 335.36 335.36 0 0 1-122.88-23.68c-38.4-16-55.68-34.56-59.52-46.72s-3.84-13.44-5.12-20.48a250.24 250.24 0 0 0-23.04-64 81.28 81.28 0 0 0-72.96-43.52 114.56 114.56 0 0 0-26.24 0 187.52 187.52 0 0 1-42.24 5.12c-28.8 0-77.44-7.68-78.72-60.16-8.32-266.88 206.08-412.16 421.76-437.76a419.2 419.2 0 0 1 48.64 0 500.48 500.48 0 0 1 174.72 30.72c10.88 4.48 16.64 7.04 44.8 21.12a260.48 260.48 0 0 1 73.6 53.76l34.56-64a314.88 314.88 0 0 0-76.8-55.68c-28.8-14.08-36.48-17.92-49.92-23.68A570.24 570.24 0 0 0 539.56352 128a485.12 485.12 0 0 0-56.32 0 592 592 0 0 0-339.2 151.68A462.08 462.08 0 0 0 0.68352 640a122.88 122.88 0 0 0 46.72 97.28 159.36 159.36 0 0 0 99.84 30.72 256 256 0 0 0 57.6-7.04h10.88c13.44 0 19.2 11.52 30.72 57.6 0 7.68 3.84 15.36 5.76 23.04a154.88 154.88 0 0 0 99.2 91.52A403.84 403.84 0 0 0 499.88352 960a460.16 460.16 0 0 0 177.92-35.2A471.04 471.04 0 0 0 821.80352 832a496 496 0 0 0 100.48-135.04 476.8 476.8 0 0 0 48.64-158.72V519.04z" fill="#666666" ></path></symbol><symbol id="edui-for-redo" viewBox="0 0 1024 1024"><path d="M900.608 474.112c-51.2-51.2-260.608-261.632-291.84-292.352a68.096 68.096 0 0 0-91.648 3.072 73.216 73.216 0 0 0-14.336 76.288c12.288 18.432 187.904 199.68 187.904 199.68H169.984A61.952 61.952 0 0 0 102.4 525.312a71.168 71.168 0 0 0 68.096 67.584h517.632l-173.056 172.032a68.096 68.096 0 0 0 0 93.184 65.536 65.536 0 0 0 90.624 7.168c25.088-23.04 256-252.928 297.984-296.448s-3.072-94.72-3.072-94.72z" fill="#666666" ></path></symbol><symbol id="edui-for-undo" viewBox="0 0 1024 1024"><path d="M128.512 476.16c51.2-51.2 260.608-261.632 291.84-292.352a68.096 68.096 0 0 1 91.648 3.072 73.216 73.216 0 0 1 13.824 76.288C512 281.6 338.432 460.8 338.432 460.8h520.192a61.952 61.952 0 0 1 65.536 66.56 71.168 71.168 0 0 1-68.096 67.584H338.432L512 768a68.096 68.096 0 0 1 0 93.184 65.536 65.536 0 0 1-90.624 7.168c-25.088-23.04-256-252.928-297.984-296.448s5.12-95.744 5.12-95.744z" fill="#666666" ></path></symbol><symbol id="edui-for-inserttitle" viewBox="0 0 1024 1024"><path d="M512 516.096v-153.6H460.8v102.4H358.4v51.2H204.8v-51.2H102.4v-102.4H51.2v614.4h921.6v-460.8z m-173.056 409.6h-240.64V757.76h238.592z m0-219.136h-240.64v-139.264h238.592z m297.472 219.136H388.096V757.76h246.272z m0-219.136H388.096v-139.264h246.272z m283.136 219.136h-233.984V757.76h231.936z m0-219.136h-233.984v-139.264h231.936z" fill="#666666" ></path><path d="M512 465.408v51.2h460.8V51.2h-460.8v307.2z m51.2-204.8h153.6v-153.6h51.2v153.6h153.6v51.2h-153.6v153.6h-51.2v-153.6h-153.6z" fill="#1C7C59" ></path><path d="M99.328 108.032h102.4v-51.2h-153.6v153.6h51.2v-102.4zM512.512 104.96v-51.2h-153.6v51.2h102.4v102.4h51.2v-102.4z" fill="#666666" ></path></symbol><symbol id="edui-for-insertparagraphtrue" viewBox="0 0 1024 1024"><path d="M997.12 448H0v576h1024V448zM60.16 960v-256H320v256z m481.92 0H384v-256h256v256z m421.76 0H704v-256h259.84zM448 0H0v64h192v384h64V64h192V0z" fill="#666666" ></path></symbol><symbol id="edui-for-aligntable" viewBox="0 0 1024 1024"><path d="M992 64H32C12.8 64 0 51.2 0 32S12.8 0 32 0h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z m0 192H32C12.8 256 0 243.2 0 224S12.8 192 32 192h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z m0 192H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z m0 384H32c-19.2 0-32-12.8-32-32s12.8-32 32-32h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z m0 192H32c-19.2 0-32-12.8-32-32s12.8-32 32-32h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path><path d="M992 448H32C12.8 448 0 435.2 0 416S12.8 384 32 384h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z m0 192H32c-19.2 0-32-12.8-32-32S12.8 576 32 576h960c19.2 0 32 12.8 32 32s-12.8 32-32 32z" fill="#666666" ></path></symbol><symbol id="edui-for-table" viewBox="0 0 1024 1024"><path d="M0 0v1024h1024V0z m320 960H64v-256h256z m0-320H64V384h256z m320 320H384v-256h256z m0-320H384V384h256z m320 320h-256v-256h256z m0-320h-256V384h256z m0-320H64V64h896z" fill="#666666" ></path></symbol><symbol id="edui-for-tablealignment-left" viewBox="0 0 1024 1024"><path d="M51.2 102.4l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 256l614.4 0 0 51.2-614.4 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 409.6l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 563.2l614.4 0 0 51.2-614.4 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 716.8l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 870.4l614.4 0 0 51.2-614.4 0 0-51.2Z" fill="#666666" ></path></symbol><symbol id="edui-for-tablealignment-center" viewBox="0 0 1024 1024"><path d="M51.2 102.4l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 409.6l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 716.8l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 256l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 563.2l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 870.4l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 102.4l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 409.6l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 716.8l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path></symbol><symbol id="edui-for-tablealignment-right" viewBox="0 0 1024 1024"><path d="M51.2 102.4l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M358.4 256l614.4 0 0 51.2-614.4 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 409.6l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M358.4 563.2l614.4 0 0 51.2-614.4 0 0-51.2Z" fill="#666666" ></path><path d="M51.2 716.8l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M358.4 870.4l614.4 0 0 51.2-614.4 0 0-51.2Z" fill="#666666" ></path></symbol><symbol id="edui-for-paste" viewBox="0 0 1024 1024"><path d="M832 320V160a32 32 0 0 0-32-32H576V64a64 64 0 0 0-64-64H384a64 64 0 0 0-64 64v64H96a32 32 0 0 0-32 32v640a32 32 0 0 0 32 32H384v192h448l192-192V320zM384 64h128v64H384zM192 192h512v64H192z m640 741.76V832h101.76zM960 768h-192v192H448V384h512z" fill="#666666" ></path></symbol><symbol id="edui-for-map" viewBox="0 0 1024 1024"><path d="M375.424 331.824c-2.432 6.96-7.856 24.704-3.152 40.208 9.232 34.672 39.424 36.24 39.424 36.24h43.264V302.368h-46.4c-20.864 6.24-30.944 22.432-33.136 29.456z m129.072 119.072H397.008c-46.448-9.28-64.896-40.992-67.28-46.368-2.288-5.456-15.504-30.944-8.464-74.256 20.032-64.976 77.28-69.616 77.28-69.616h57.248v-70.368l48.704 0.8v259.808z m200.272-0.768H581.04c-47.92-12.368-50.176-46.496-50.176-46.496V266.816L581.04 266v123.024c3.008 13.024 19.376 15.44 19.376 15.44h50.912V266.768h53.456v183.36h-0.016z" fill="" ></path><path d="M512 1021.45c-11.203 0-21.563-6-27.172-15.688L208.375 527.726c-30.803-53.1-47.11-113.662-47.11-175.084 0-193.047 157.35-350.094 350.75-350.094 193.391 0 350.72 157.047 350.72 350.094 0 61.421-16.298 121.975-47.126 175.115l-276.437 478.007c-5.61 9.687-15.953 15.687-27.172 15.687z m0.016-956.138c-158.788 0-287.985 128.907-287.985 287.329 0 50.375 13.375 100.037 38.663 143.615l249.303 431.1 249.297-431.062c25.297-43.616 38.656-93.281 38.656-143.656 0-158.42-129.172-287.325-287.934-287.325z" fill="" ></path></symbol><symbol id="edui-for-directionalityrtl" viewBox="0 0 1024 1024"><path d="M960 833.92l-384-320 384-320.64v640.64zM64 192V128h448v64H320v640h192v64H64v-64h192V192H64z" fill="#666666" ></path></symbol><symbol id="edui-for-imagecenter" viewBox="0 0 1024 1024"><path d="M0 0h1024v64H0z" fill="#666666" ></path><path d="M128 192l768 0 0 448-768 0 0-448Z" fill="#66BBBF" ></path><path d="M0 768h1024v64H0zM0 960h1024v64H0z" fill="#666666" ></path></symbol><symbol id="edui-for-imagenone" viewBox="0 0 1024 1024"><path d="M52.736 107.008l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M52.736 260.608l409.6 0 0 512-409.6 0 0-512Z" fill="#66BBBF" ></path><path d="M564.736 721.408l409.6 0 0 51.2-409.6 0 0-51.2Z" fill="#666666" ></path><path d="M54.784 875.008l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M564.736 567.808l409.6 0 0 51.2-409.6 0 0-51.2Z" fill="#666666" ></path></symbol><symbol id="edui-for-fontborder" viewBox="0 0 1024 1024"><path d="M345.6 832l44.8-153.6h224l44.8 153.6H768L576 192H448L256 832h89.6z m153.6-531.2l83.2 288H416l83.2-288z" fill="#666666" ></path><path d="M896 64H64v896h896V64h-64z m0 832H128V128h768v768z" fill="#666666" ></path></symbol><symbol id="edui-for-edittable" viewBox="0 0 1024 1024"><path d="M993.92 848.64L849.92 704a240 240 0 0 0-320-300.8L512 410.24v2.56a12.16 12.16 0 0 0 0 17.28l134.4 134.4-81.92 80.64L432.64 512a14.08 14.08 0 0 0-23.68 5.12l-4.48 10.24a240 240 0 0 0 300.8 320l144 144a102.4 102.4 0 0 0 72.96 30.08 103.04 103.04 0 0 0 72.96-175.36zM960 960a56.96 56.96 0 0 1-40.32 16.64 56.96 56.96 0 0 1-40.32-16.64l-165.12-165.12-14.08 6.4a192 192 0 0 1-265.6-220.8L555.52 704a14.08 14.08 0 0 0 17.28 0l128-128a14.08 14.08 0 0 0 0-18.56L580.48 434.56A192 192 0 0 1 802.56 704l-6.4 14.08L960 880.64A56.96 56.96 0 0 1 960 960z" fill="#666666" ></path><path d="M832 0H0v832h320V320h512zM256 768H64V576h192z m0-256H64V320h192z m0-256H64V64h192z m256 0H320V64h192z m64 0V64h192v192z" fill="#666666" ></path></symbol><symbol id="edui-for-imageleft" viewBox="0 0 1024 1024"><path d="M50.688 101.376l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M50.688 254.976l409.6 0 0 512-409.6 0 0-512Z" fill="#66BBBF" ></path><path d="M562.688 715.776l409.6 0 0 51.2-409.6 0 0-51.2Z" fill="#666666" ></path><path d="M52.736 869.376l921.6 0 0 51.2-921.6 0 0-51.2Z" fill="#666666" ></path><path d="M562.688 562.176l409.6 0 0 51.2-409.6 0 0-51.2Z" fill="#666666" ></path><path d="M562.688 408.576l409.6 0 0 51.2-409.6 0 0-51.2Z" fill="#666666" ></path><path d="M562.688 254.976l409.6 0 0 51.2-409.6 0 0-51.2Z" fill="#666666" ></path></symbol><symbol id="edui-for-imageright" viewBox="0 0 1024 1024"><path d="M0 0h1024v64H0z" fill="#666666" ></path><path d="M512 192l512 0 0 640-512 0 0-640Z" fill="#66BBBF" ></path><path d="M0 768h448v64H0zM0 960h1024v64H0zM0 576h448v64H0zM0 384h448v64H0zM0 192h448v64H0z" fill="#666666" ></path></symbol><symbol id="edui-for-insertcol" viewBox="0 0 1024 1024"><path d="M256 256L0 512l256 256V256zM1024 1024V0H384v1024zM768 64h192v256h-192z m0 320h192v256h-192z m0 320h192v256h-192zM448 64h192v256H448z m0 320h192v256H448z m0 320h192v256H448z" fill="#666666" ></path></symbol><symbol id="edui-for-insertcolnext" viewBox="0 0 1024 1024"><path d="M768 768l256-256-256-256v512zM0 0v1024h640V0z m256 960H64v-256h192z m0-320H64V384h192z m0-320H64V64h192z m320 640H384v-256h192z m0-320H384V384h192z m0-320H384V64h192z" fill="#666666" ></path></symbol><symbol id="edui-for-insertorderedlist" viewBox="0 0 1024 1024"><path d="M319.955606 63.991121l703.902334 0 0 127.982243-703.902334 0 0-127.982243Z" fill="#666666" ></path><path d="M319.955606 447.937849l703.902334 0 0 127.982242-703.902334 0 0-127.982242Z" fill="#666666" ></path><path d="M319.955606 831.884576l703.902334 0 0 127.982242-703.902334 0 0-127.982242Z" fill="#666666" ></path><path d="M191.973364 0v255.964485H63.991121V0zM0 639.911212v-30.715738C0 505.529858 159.977803 467.775096 159.977803 422.3414c0-17.917514-10.878491-28.156093-33.275383-28.156093a114.544107 114.544107 0 0 0-74.229701 37.11485l-46.713518-54.392453a167.656738 167.656738 0 0 1 127.982242-56.952098C212.450522 319.955606 255.964485 362.189746 255.964485 417.22211c0 78.069168-95.346771 98.546327-142.7002 147.179579H255.964485V639.911212zM127.982242 1023.85794a165.737004 165.737004 0 0 1-127.982242-52.47272l48.633252-49.273163a106.865172 106.865172 0 0 0 69.750322 30.075827c28.156093 0 41.594229-14.078047 41.594229-33.275383 0-17.277603-12.158313-26.23636-36.474939-26.23636h-24.316626v-52.472719h24.956537c23.036804 0 36.474939-6.399112 36.474939-26.876271 0-19.837248-12.798224-31.355649-38.394672-31.35565a85.748102 85.748102 0 0 0-63.991122 31.35565l-47.993341-48.633252a158.058069 158.058069 0 0 1 127.982243-55.032365C211.1707 703.902334 255.964485 745.496562 255.964485 792.210081v5.11929a63.991121 63.991121 0 0 1-67.830589 63.991121c50.552986 7.039023 70.390233 33.275383 70.390234 67.190677v3.839467C255.964485 985.463267 204.131677 1023.85794 127.982242 1023.85794z" fill="#666666" ></path></symbol><symbol id="edui-for-insertparagraphbeforetable" viewBox="0 0 1024 1024"><path d="M256 384v640h768V384z m256 576H320V448h192z m448 0H576v-128h384z m0-192H576v-128h384z m0-192H576V448h384z" fill="#666666" ></path><path d="M384 576h64v256H384zM0 0v64h128v384h64V64h128V0H0z" fill="#666666" ></path></symbol><symbol id="edui-for-insertrow" viewBox="0 0 1024 1024"><path d="M768 256L512 0 256 256h512zM0 1024h1024V384H0z m960-256v192h-256v-192z m-320 0v192H384v-192z m-320 0v192H64v-192z m640-320v192h-256V448z m-320 0v192H384V448zM320 448v192H64V448z" fill="#666666" ></path></symbol><symbol id="edui-for-insertrownext" viewBox="0 0 1024 1024"><path d="M256 768l256 256 256-256H256zM1024 0H0v640h1024zM64 256V64h256v192z m320 0V64h256v192z m320 0V64h256v192zM64 576V384h256v192z m320 0V384h256v192z m320 0V384h256v192z" fill="#666666" ></path></symbol><symbol id="edui-for-insertunorderedlist" viewBox="0 0 1024 1024"><path d="M960 192H256c-38.4 0-64-25.6-64-64s25.6-64 64-64h704c38.4 0 64 25.6 64 64s-25.6 64-64 64zM64 192c-38.4 0-64-25.6-64-64s25.6-64 64-64 64 25.6 64 64-25.6 64-64 64zM960 576H256c-38.4 0-64-25.6-64-64s25.6-64 64-64h704c38.4 0 64 25.6 64 64s-25.6 64-64 64zM64 576c-38.4 0-64-25.6-64-64s25.6-64 64-64 64 25.6 64 64-25.6 64-64 64zM960 960H256c-38.4 0-64-25.6-64-64s25.6-64 64-64h704c38.4 0 64 25.6 64 64s-25.6 64-64 64zM64 960c-38.4 0-64-25.6-64-64s25.6-64 64-64 64 25.6 64 64-25.6 64-64 64z" fill="#666666" ></path></symbol><symbol id="edui-for-mergeright" viewBox="0 0 1024 1024"><path d="M0 0v1024h1024V0z m384 64h256v256H384z m0 384h320V384l192 128-192 128V576H384z m-64 512H64v-256h256z m0-320H64V384h256z m0-320H64V64h256z m320 640H384v-256h256z m320 0h-256v-256h256z m0-640h-256V64h256z" fill="#666666" ></path></symbol><symbol id="edui-for-mergedown" viewBox="0 0 1024 1024"><path d="M0 0v1024h1024V0z m320 960H64v-256h256z m0-320H64V384h256z m0-320H64V64h256z m192 576l-128-192h64V384h128v320h64z m128-576H384V64h256z m320 640h-256v-256h256z m0-320h-256V384h256z m0-320h-256V64h256z" fill="#666666" ></path></symbol><symbol id="edui-for-inserttable" viewBox="0 0 1024 1024"><path d="M0 0v1024h1024V0z m320 960H64v-256h256z m0-320H64V384h256z m320 320H384v-256h256z m0-320H384V384h256z m320 320h-256v-256h256z m0-320h-256V384h256z m0-320H64V64h896z" fill="#666666" ></path></symbol><symbol id="edui-for-pagebreak" viewBox="0 0 1024 1024"><path d="M384 960h512v64H384zM0 320v384l256-192-256-192zM320 128h576v64H320zM384 832h256v64H384z" fill="#666666" ></path><path d="M192 704v320h64v-256h704v256h64v-320H192zM1022.72 0H960v256H256V0H192v320h832V0h-1.28z" fill="#666666" ></path></symbol><symbol id="edui-for-source" viewBox="0 0 1024 1024"><path d="M170.88 512H56.96V384H0v320h56.96V576h113.92v128h56.96V384h-56.96v128zM284.16 448h56.96v256h56.96V448h56.96V384H284.16v64zM738.56 385.28l-84.48 250.24L569.6 384l-2.56 1.28H512v316.8h56.96V561.92l47.36 140.8h72.96l2.56 1.28 48-140.8v139.52h56.32V385.92h-55.04l-2.56-0.64zM910.08 640V384h-56.96v320H1024v-64h-113.92z" fill="#666666" ></path></symbol><symbol id="edui-for-splittorows" viewBox="0 0 1024 1024"><path d="M0 0h1024v64H0z" fill="#666666" ></path><path d="M960 0v320h-128V0h-64v320H256V0H192v320H64V0H0v1024h1024V0z m-192 384v256H256V384zM64 384h128v256H64z m0 576v-256h128v256z m192 0v-256h512v256z m704 0h-128v-256h128z m0-320h-128V384h128z" fill="#666666" ></path></symbol><symbol id="edui-for-splittocols" viewBox="0 0 1024 1024"><path d="M1024 0H0v1024h1024z m-64 384v256h-128V384z m0-320v256h-128V64zM64 320V64h128v256z m0 320V384h128v256z m0 320v-256h128v256z m192 0V64h128v896z m192 0V64h128v896z m192 0V64h128v896z m192 0v-256h128v256z" fill="#666666" ></path></symbol><symbol id="edui-for-splittocells" viewBox="0 0 1024 1024"><path d="M0 0v1024h1024V0z m320 960H64V384h256z m320 0H384v-256h256z m0-320H384V384h256z m320 320h-256v-256h256z m0-320h-256V384h256z m0-320H384V64h576z" fill="#666666" ></path></symbol><symbol id="edui-for-arrow" viewBox="0 0 1024 1024"><path d="M513.024 665.6l204.8-204.8h-409.6l204.8 204.8z" fill="" ></path></symbol><symbol id="edui-for-aligntd" viewBox="0 0 1024 1024"><path d="M256.061265 767.939055l511.87747 0 0 63.984683-511.87747 0 0-63.984683Z" fill="#666666" ></path><path d="M256.061265 575.985004l511.87747 0 0 63.984683-511.87747 0 0-63.984683Z" fill="#666666" ></path><path d="M256.061265 384.030953l511.87747 0 0 63.984683-511.87747 0 0-63.984683Z" fill="#666666" ></path><path d="M256.061265 192.076902l511.87747 0 0 63.984683-511.87747 0 0-63.984683Z" fill="#666666" ></path><path d="M863.91576 1023.877789h-703.83152A91.498098 91.498098 0 0 1 64.107214 938.77816V85.22248A91.498098 91.498098 0 0 1 160.08424 0.122851h703.83152A91.498098 91.498098 0 0 1 959.892786 85.22248v853.55568A91.498098 91.498098 0 0 1 863.91576 1023.877789zM160.08424 64.107534a30.072801 30.072801 0 0 0-31.992342 28.153261v839.47905a30.072801 30.072801 0 0 0 31.992342 28.153261h703.83152a30.072801 30.072801 0 0 0 31.992342-28.153261V92.260795a30.072801 30.072801 0 0 0-31.992342-28.153261z" fill="#666666" ></path></symbol><symbol id="edui-for-autotypeset" viewBox="0 0 1024 1024"><path d="M192 192l384 0 0 320-384 0 0-320Z" fill="#66BBBF" ></path><path d="M640 192l192 0 0 64-192 0 0-64Z" fill="#666666" ></path><path d="M640 384l192 0 0 64-192 0 0-64Z" fill="#666666" ></path><path d="M192 576l640 0 0 64-640 0 0-64Z" fill="#666666" ></path><path d="M192 768l640 0 0 64-640 0 0-64Z" fill="#666666" ></path><path d="M960 0H64a64 64 0 0 0-64 64v896a64 64 0 0 0 64 64h896a64 64 0 0 0 64-64V64a64 64 0 0 0-64-64z m0 896a64 64 0 0 1-64 64H128a64 64 0 0 1-64-64V128a64 64 0 0 1 64-64h768a64 64 0 0 1 64 64z" fill="#666666" ></path></symbol><symbol id="edui-for-charts" viewBox="0 0 1024 1024"><path d="M0 64v896h1024V64z m960 832H64V128h896z" fill="#666666" ></path><path d="M704 256h128v512h-128zM448 576h128v192H448zM192 384h128v384H192z" fill="#666666" ></path></symbol><symbol id="edui-for-closeerror" viewBox="0 0 1024 1024"><path d="M512 0a512 512 0 1 0 512 512 512 512 0 0 0-512-512z m284.16 670.08l-128 128L512 640l-158.08 156.16-128-128L384 512 227.84 353.92l128-128L512 384l158.08-158.08 128 128L640 512z" fill="#EF4848" ></path></symbol><symbol id="edui-for-copy" viewBox="0 0 1024 1024"><path d="M256.060306 384.030473l511.879388 0 0 63.984923-511.879388 0 0-63.984923Z" fill="#666666" ></path><path d="M256.060306 575.985243l511.879388 0 0 63.984924-511.879388 0 0-63.984924Z" fill="#666666" ></path><path d="M256.060306 767.940014l511.879388 0 0 63.984924-511.879388 0 0-63.984924Z" fill="#666666" ></path><path d="M256.060306 192.075702l255.939694 0 0 63.984924-255.939694 0 0-63.984924Z" fill="#666666" ></path><path d="M895.909541 256.060626h-191.95477V56.427664A63.984924 63.984924 0 0 0 639.969847 0.120932H137.688197A69.743567 69.743567 0 0 0 64.105535 64.105855v895.78893a69.743567 69.743567 0 0 0 73.582662 63.984923h748.623606A69.743567 69.743567 0 0 0 959.894465 959.894785V313.007208A63.984924 63.984924 0 0 0 895.909541 256.060626z m0 695.516119a8.31804 8.31804 0 0 1-8.31804 8.31804H137.688197a9.597739 9.597739 0 0 1-9.597738-9.597739V72.423895A8.31804 8.31804 0 0 1 136.408499 64.105855h491.404213a11.517286 11.517286 0 0 1 12.157135 10.877437v191.954771A60.145828 60.145828 0 0 0 703.954771 320.045549h180.437484a11.517286 11.517286 0 0 1 12.157136 10.877437v620.653759z" fill="#666666" ></path></symbol><symbol id="edui-for-date" viewBox="0 0 1024 1024"><path d="M896 128v64h64v704H64V192h64V128H0v832h1024V128h-128z" fill="#666666" ></path><path d="M832 64h-192v255.36L832 320V64z" fill="#EF4848" ></path><path d="M576 704h256v64H576zM576 512h256v64H576zM448 128h128v64H448zM192 704h256v64H192zM192 512h256v64H192z" fill="#666666" ></path><path d="M384 64H192v256l192-0.64V64z" fill="#EF4848" ></path></symbol><symbol id="edui-for-deletetable" viewBox="0 0 1024 1024"><path d="M576 0v448h448V0z m427.52 337.28l-90.24 90.24-113.28-113.28-113.28 113.28-90.24-90.24 113.28-113.28-113.28-113.28L686.72 20.48l113.28 113.28L913.28 20.48l90.88 90.88-113.92 112.64z" fill="#EF4848" ></path><path d="M960 640h-256V448h-64v192H384V384h192V320H64V64h512V0H0v1024h1024V448h-64zM320 960H64v-256h256z m0-320H64V384h256z m320 320H384v-256h256z m320 0h-256v-256h256z" fill="#666666" ></path></symbol><symbol id="edui-for-directionalityltr" viewBox="0 0 1024 1024"><path d="M64 832l384-320-384-320v640zM960 192V128H512v64h192v640H512v64h448v-64h-192V192h192z" fill="#666666" ></path></symbol><symbol id="edui-for-arrowright" viewBox="0 0 1024 1024"><path d="M615.424 512l-204.8-204.8v409.6l204.8-204.8z" fill="" ></path></symbol><symbol id="edui-for-tableleft" viewBox="0 0 1024 1024"><path d="M960 64v896H64V64h896m64-64H0v1024h1024V0z" fill="" ></path><path d="M192 192h640v64H192zM192 384h640v64H192zM192 576h256v64H192z" fill="" ></path></symbol><symbol id="edui-for-tableright" viewBox="0 0 1024 1024"><path d="M960 64v896H64V64h896m64-64H0v1024h1024V0z" fill="" ></path><path d="M188.8 191.36h640v64h-640zM188.8 383.36h640v64h-640zM576 575.36h256v64H576z" fill="" ></path></symbol><symbol id="edui-for-tablecenter" viewBox="0 0 1024 1024"><path d="M960 64v896H64V64h896m64-64H0v1024h1024V0z" fill="" ></path><path d="M188.8 192.64h640v64h-640zM188.8 384.64h640v64h-640zM383.36 576.64h256v64h-256z" fill="" ></path></symbol><symbol id="edui-for-videoleft" viewBox="0 0 1024 1024"><path d="M96 96l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 192l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 800l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 896l399.36 0 0 32-399.36 0 0-32Z" fill="#3FBEE0" ></path><path d="M704 704l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M704 608l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M704 512l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M704 416l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M704 320l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M256 480m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#3FBEE0" ></path><path d="M640 320H128a32 32 0 0 0-32 32v352a32 32 0 0 0 32 32h512a32 32 0 0 0 32-32V352a32 32 0 0 0-32-32z m0 251.52L544 448l-162.24 208.64L304 563.2 186.56 704H160a32 32 0 0 1-32-32v-288a32 32 0 0 1 32-32h448a32 32 0 0 1 32 32z" fill="#3FBEE0" ></path><path d="M992 32v960H32V32h960m0-32H32a32 32 0 0 0-32 32v960a32 32 0 0 0 32 32h960a32 32 0 0 0 32-32V32a32 32 0 0 0-32-32z" fill="#3FBEE0" ></path></symbol><symbol id="edui-for-videocenter" viewBox="0 0 1024 1024"><path d="M96 96l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 192l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 800l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 896l399.36 0 0 32-399.36 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 704l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 608l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 512l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 416l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 320l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M832 608l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M832 704l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M832 512l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M832 416l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M832 320l96 0 0 32-96 0 0-32Z" fill="#3FBEE0" ></path><path d="M384 480m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#3FBEE0" ></path><path d="M768 320H256a32 32 0 0 0-32 32v352a32 32 0 0 0 32 32h512a32 32 0 0 0 32-32V352a32 32 0 0 0-32-32z m0 251.52L672 448l-162.24 208.64-77.76-93.44L314.56 704H288a32 32 0 0 1-32-32v-288a32 32 0 0 1 32-32h448a32 32 0 0 1 32 32z" fill="#3FBEE0" ></path><path d="M992 32v960H32V32h960m0-32H32a32 32 0 0 0-32 32v960a32 32 0 0 0 32 32h960a32 32 0 0 0 32-32V32a32 32 0 0 0-32-32z" fill="#3FBEE0" ></path></symbol><symbol id="edui-for-videonone" viewBox="0 0 1024 1024"><path d="M96 96l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 192l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 800l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 896l399.36 0 0 32-399.36 0 0-32Z" fill="#3FBEE0" ></path><path d="M704 704l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M704 608l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M256 480m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#3FBEE0" ></path><path d="M640 320H128a32 32 0 0 0-32 32v352a32 32 0 0 0 32 32h512a32 32 0 0 0 32-32V352a32 32 0 0 0-32-32z m0 251.52L544 448l-162.24 208.64L304 563.2 186.56 704H160a32 32 0 0 1-32-32v-288a32 32 0 0 1 32-32h448a32 32 0 0 1 32 32z" fill="#3FBEE0" ></path><path d="M992 32v960H32V32h960m0-32H32a32 32 0 0 0-32 32v960a32 32 0 0 0 32 32h960a32 32 0 0 0 32-32V32a32 32 0 0 0-32-32z" fill="#3FBEE0" ></path></symbol><symbol id="edui-for-videoright" viewBox="0 0 1024 1024"><path d="M96 96l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 192l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 800l832 0 0 32-832 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 896l399.36 0 0 32-399.36 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 704l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 608l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 512l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 416l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M96 320l224 0 0 32-224 0 0-32Z" fill="#3FBEE0" ></path><path d="M512 480m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#3FBEE0" ></path><path d="M896 320H384a32 32 0 0 0-32 32v352a32 32 0 0 0 32 32h512a32 32 0 0 0 32-32V352a32 32 0 0 0-32-32z m0 251.52L800 448l-162.24 208.64-77.76-93.44-117.44 140.8H416a32 32 0 0 1-32-32v-288a32 32 0 0 1 32-32h448a32 32 0 0 1 32 32z" fill="#3FBEE0" ></path><path d="M992 32v960H32V32h960m0-32H32a32 32 0 0 0-32 32v960a32 32 0 0 0 32 32h960a32 32 0 0 0 32-32V32a32 32 0 0 0-32-32z" fill="#3FBEE0" ></path></symbol><symbol id="edui-for-template" viewBox="0 0 1024 1024"><path d="M0 64v896h1024V64z m960 832H64V128h896z" fill="#666666" ></path><path d="M192 256h320v192H192zM640 256h192v512h-192zM192 576h320v192H192z" fill="#666666" ></path></symbol><symbol id="edui-for-addfile" viewBox="0 0 1024 1024"><path d="M1024 480H544V0h-64v480H0v64h480v480h64V544h480v-64z" fill="#E5E5E5" ></path></symbol><symbol id="edui-for-selected" viewBox="0 0 1024 1024"><path d="M914.24 617.28a32 32 0 0 0-45.12 0l-221.44 221.12-112.96-112.96a32 32 0 1 0-45.12 45.12l135.68 135.68a32 32 0 0 0 45.44 0l243.52-243.52a32 32 0 0 0 0-45.44z" fill="#FFFFFF" ></path><path d="M0 1024h1024V0z m914.24-361.28L672 906.24a32 32 0 0 1-45.44 0l-135.68-135.68a32 32 0 1 1 45.12-45.12l112.96 112.96 221.12-221.12a32 32 0 1 1 45.12 45.12z" fill="#1094FA" ></path></symbol><symbol id="edui-for-pickarea" viewBox="0 0 1024 1024"><path d="M977.454545 93.090909h-46.545454v791.272727a46.545455 46.545455 0 0 1-46.545455 46.545455H93.090909v46.545454a46.545455 46.545455 0 0 0 46.545455 46.545455h837.818181a46.545455 46.545455 0 0 0 46.545455-46.545455V139.636364a46.545455 46.545455 0 0 0-46.545455-46.545455z" fill="#E5E5E5" ></path><path d="M46.545455 46.545455l837.818181 0 0 837.818181-837.818181 0 0-837.818181Z" fill="#FFFFFF" ></path><path d="M884.363636 0H46.545455a46.545455 46.545455 0 0 0-46.545455 46.545455v837.818181a46.545455 46.545455 0 0 0 46.545455 46.545455h837.818181a46.545455 46.545455 0 0 0 46.545455-46.545455V46.545455a46.545455 46.545455 0 0 0-46.545455-46.545455z m0 837.818182a46.545455 46.545455 0 0 1-46.545454 46.545454H93.090909a46.545455 46.545455 0 0 1-46.545454-46.545454V93.090909a46.545455 46.545455 0 0 1 46.545454-46.545454h744.727273a46.545455 46.545455 0 0 1 46.545454 46.545454z" fill="#CCCCCC" ></path></symbol><symbol id="edui-for-overlay" viewBox="0 0 1024 1024"><path d="M977.454545 93.090909h-46.545454v791.272727a46.545455 46.545455 0 0 1-46.545455 46.545455H93.090909v46.545454a46.545455 46.545455 0 0 0 46.545455 46.545455h837.818181a46.545455 46.545455 0 0 0 46.545455-46.545455V139.636364a46.545455 46.545455 0 0 0-46.545455-46.545455z" fill="#E3F6FF" ></path><path d="M46.545455 46.545455l837.818181 0 0 837.818181-837.818181 0 0-837.818181Z" fill="#E3F6FF" ></path><path d="M884.363636 0H46.545455a46.545455 46.545455 0 0 0-46.545455 46.545455v837.818181a46.545455 46.545455 0 0 0 46.545455 46.545455h837.818181a46.545455 46.545455 0 0 0 46.545455-46.545455V46.545455a46.545455 46.545455 0 0 0-46.545455-46.545455z m0 837.818182a46.545455 46.545455 0 0 1-46.545454 46.545454H93.090909a46.545455 46.545455 0 0 1-46.545454-46.545454V93.090909a46.545455 46.545455 0 0 1 46.545454-46.545454h744.727273a46.545455 46.545455 0 0 1 46.545454 46.545454z" fill="#45A7EF" ></path></symbol><symbol id="edui-for-preitem" viewBox="0 0 1462 1024"><path d="M0 0v1024h1462.857143V0z m1433.6 994.742857H29.257143V29.257143h1404.342857z" fill="#CCCCCC" ></path><path d="M175.542857 131.657143h497.371429v58.514286H175.542857zM175.542857 512h438.857143v29.257143H175.542857zM175.542857 394.971429h906.971429v29.257142H175.542857zM175.542857 277.942857h234.057143v29.257143H175.542857zM175.542857 629.028571h1111.771429v29.257143H175.542857zM175.542857 746.057143h292.571429v29.257143H175.542857zM175.542857 863.085714h760.685714v29.257143H175.542857z" fill="#666666" ></path></symbol><symbol id="edui-for-preitem1" viewBox="0 0 1462 1024"><path d="M0 0v1024h1462.857143V0z m1433.6 994.742857H29.257143V29.257143h1404.342857z" fill="#CCCCCC" ></path><path d="M117.028571 175.542857h351.085715v29.257143H117.028571z" fill="#666666" ></path></symbol><symbol id="edui-for-preitem2" viewBox="0 0 1462 1024"><path d="M0 0v1024h1462.857143V0z m1433.6 994.742857H29.257143V29.257143h1404.342857z" fill="#CCCCCC" ></path><path d="M175.542857 117.028571h497.371429v58.514286H175.542857zM848.457143 555.885714h438.857143v29.257143H848.457143zM848.457143 438.857143h438.857143v29.257143H848.457143zM848.457143 321.828571h438.857143v29.257143H848.457143zM175.542857 672.914286h1111.771429v29.257143H175.542857zM175.542857 789.942857h702.171429v29.257143H175.542857zM175.542857 906.971429h702.171429v29.257142H175.542857zM731.428571 351.085714v204.8H204.8V351.085714h526.628571m29.257143-29.257143H175.542857v263.314286h585.142857V321.828571zM1258.057143 789.942857v117.028572H994.742857v-117.028572h263.314286m29.257143-29.257143H965.485714v175.542857h321.828572V760.685714z" fill="#666666" ></path></symbol><symbol id="edui-for-preitem3" viewBox="0 0 1462 1024"><path d="M0 0v1024h1462.857143V0z m1433.6 994.742857H29.257143V29.257143h1404.342857z" fill="#CCCCCC" ></path><path d="M482.742857 175.542857h497.371429v58.514286H482.742857zM643.657143 292.571429h175.542857v29.257142H643.657143zM175.542857 468.114286h1111.771429v29.257143H175.542857zM175.542857 585.142857h1111.771429v29.257143H175.542857zM175.542857 702.171429h1111.771429v29.257142H175.542857zM175.542857 819.2h1111.771429v29.257143H175.542857z" fill="#666666" ></path></symbol><symbol id="edui-for-preitem4" viewBox="0 0 1462 1024"><path d="M1258.057143 263.314286v204.8H204.8V263.314286h1053.257143m29.257143-29.257143H175.542857v263.314286h1111.771429V234.057143z" fill="#666666" ></path><path d="M0 0v1024h1462.857143V0z m1433.6 994.742857H29.257143V29.257143h1404.342857z" fill="#CCCCCC" ></path><path d="M175.542857 117.028571h497.371429v58.514286H175.542857zM175.542857 555.885714h351.085714v29.257143H175.542857zM175.542857 672.914286h1111.771429v29.257143H175.542857zM175.542857 789.942857h702.171429v29.257143H175.542857zM175.542857 906.971429h1111.771429v29.257142H175.542857z" fill="#666666" ></path></symbol></svg>';var e=function(){var e=document.getElementsByTagName("script");return e[e.length-1]}();var t=e.getAttribute("data-injectcss");var o=function(e){if(document.addEventListener){if(~["complete","loaded","interactive"].indexOf(document.readyState)){setTimeout(e,0)}else{var t=function(){document.removeEventListener("DOMContentLoaded",t,false);e()};document.addEventListener("DOMContentLoaded",t,false)}}else if(document.attachEvent){i(n,e)}function i(e,t){var i=e.document,n=false,o=function(){if(!n){n=true;t()}};var r=function(){try{i.documentElement.doScroll("left")}catch(e){setTimeout(r,50);return}o()};r();i.onreadystatechange=function(){if(i.readyState=="complete"){i.onreadystatechange=null;o()}}}};var r=function(e,t){t.parentNode.insertBefore(e,t)};var a=function(e,t){if(t.firstChild){r(e,t.firstChild)}else{t.appendChild(e)}};function s(){var e,t;e=document.createElement("div");e.innerHTML=i;i=null;t=e.getElementsByTagName("svg")[0];if(t){t.setAttribute("aria-hidden","true");t.style.position="absolute";t.style.width=0;t.style.height=0;t.style.overflow="hidden";a(t,document.body)}}if(t&&!n.__iconfont__svg__cssinject__){n.__iconfont__svg__cssinject__=true;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}o(s)})(window);(function(){var l=baidu.editor.utils;var d=baidu.editor.ui;var t=d.Dialog;d.buttons={};d.Dialog=function(e){var n=new t(e);n.addListener("hide",function(){if(n.editor){var e=n.editor;try{if(browser.gecko){var t=e.window.scrollY,i=e.window.scrollX;e.body.focus();e.window.scrollTo(i,t)}else{e.focus()}}catch(e){}}});return n};var s={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"};var e=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"];for(var i=0,n;n=e[i++];){n=n.toLowerCase();d[n]=function(a){return function(o){var r=new d.Button({className:"edui-for-"+a,title:o.options.labelMap[a]||o.getLang("labelMap."+a)||"",onclick:function(){o.execCommand(a)},theme:o.options.theme,showText:false});d.buttons[a]=r;o.addListener("selectionchange",function(e,t,i){var n=o.queryCommandState(a);if(n==-1){r.setDisabled(true);r.setChecked(false)}else{if(!i){r.setDisabled(false);r.setChecked(n)}}});return r}}(n)}d.cleardoc=function(e){var t=new d.Button({className:"edui-for-cleardoc",title:e.options.labelMap.cleardoc||e.getLang("labelMap.cleardoc")||"",theme:e.options.theme,onclick:function(){if(confirm(e.getLang("confirmClear"))){e.execCommand("cleardoc")}}});d.buttons["cleardoc"]=t;e.addListener("selectionchange",function(){t.setDisabled(e.queryCommandState("cleardoc")==-1)});return t};var o={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var r in o){(function(a,e){for(var t=0,i;i=e[t++];){(function(r){d[a.replace("float","")+r]=function(n){var o=new d.Button({className:"edui-for-"+a.replace("float","")+r,title:n.options.labelMap[a.replace("float","")+r]||n.getLang("labelMap."+a.replace("float","")+r)||"",theme:n.options.theme,onclick:function(){n.execCommand(a,r)}});d.buttons[a]=o;n.addListener("selectionchange",function(e,t,i){o.setDisabled(n.queryCommandState(a)==-1);o.setChecked(n.queryCommandValue(a)==r&&!i)});return o}})(i)}})(r,o[r])}for(var i=0,n;n=["backcolor","forecolor"][i++];){d[n]=function(n){return function(i){var e=new d.ColorButton({className:"edui-for-"+n,color:"default",title:i.options.labelMap[n]||i.getLang("labelMap."+n)||"",editor:i,onpickcolor:function(e,t){i.execCommand(n,t)},onpicknocolor:function(){i.execCommand(n,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){i.execCommand(n,this.color)}});d.buttons[n]=e;i.addListener("selectionchange",function(){e.setDisabled(i.queryCommandState(n)==-1)});return e}}(n)}var a={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(var r in a){(function(a,e){for(var t=0,i;i=e[t++];){if(browser.opera&&i==="searchreplace"){continue}(function(r){d[r]=function(i,e,t){e=e||(i.options.iframeUrlMap||{})[r]||s[r];t=i.options.labelMap[r]||i.getLang("labelMap."+r)||"";var n;if(e){n=new d.Dialog(l.extend({iframeUrl:i.ui.mapUrl(e),editor:i,className:"edui-for-"+r,title:t,holdScroll:r==="insertimage",fullscreen:/charts|preview/.test(r),closeDialog:i.getLang("closeDialog")},a=="ok"?{buttons:[{className:"edui-okbutton",label:i.getLang("ok"),editor:i,onclick:function(){n.close(true)}},{className:"edui-cancelbutton",label:i.getLang("cancel"),editor:i,onclick:function(){n.close(false)}}]}:{}));i.ui._dialogs[r+"Dialog"]=n}var o=new d.Button({className:"edui-for-"+r,title:t,onclick:function(){if(n){switch(r){case"wordimage":var e=i.execCommand("wordimage");if(e&&e.length){n.render();n.open()}break;case"scrawl":if(i.queryCommandState("scrawl")!=-1){n.render();n.open()}break;default:n.render();n.open()}}},theme:i.options.theme,disabled:r=="scrawl"&&i.queryCommandState("scrawl")==-1||r=="charts"});d.buttons[r]=o;i.addListener("selectionchange",function(){var e={edittable:1};if(r in e)return;var t=i.queryCommandState(r);if(o.getDom()){o.setDisabled(t==-1);o.setChecked(t)}});return o}})(i.toLowerCase())}})(r,a[r])}d.snapscreen=function(e,t,i){i=e.options.labelMap["snapscreen"]||e.getLang("labelMap.snapscreen")||"";var n=new d.Button({className:"edui-for-snapscreen",title:i,onclick:function(){e.execCommand("snapscreen")},theme:e.options.theme});d.buttons["snapscreen"]=n;t=t||(e.options.iframeUrlMap||{})["snapscreen"]||s["snapscreen"];if(t){var o=new d.Dialog({iframeUrl:e.ui.mapUrl(t),editor:e,className:"edui-for-snapscreen",title:i,buttons:[{className:"edui-okbutton",label:e.getLang("ok"),editor:e,onclick:function(){o.close(true)}},{className:"edui-cancelbutton",label:e.getLang("cancel"),editor:e,onclick:function(){o.close(false)}}]});o.render();e.ui._dialogs["snapscreenDialog"]=o}e.addListener("selectionchange",function(){n.setDisabled(e.queryCommandState("snapscreen")==-1)});return n};d.insertcode=function(r,e,a){e=r.options["insertcode"]||[];a=r.options.labelMap["insertcode"]||r.getLang("labelMap.insertcode")||"";var i=[];l.each(e,function(e,t){i.push({label:e,value:t,theme:r.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})});var s=new d.Combox({editor:r,items:i,onselect:function(e,t){r.execCommand("insertcode",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:a,initValue:a,className:"edui-for-insertcode",indexByValue:function(e){if(e){for(var t=0,i;i=this.items[t];t++){if(i.value.indexOf(e)!=-1)return t}}return-1}});d.buttons["insertcode"]=s;r.addListener("selectionchange",function(e,t,i){if(!i){var n=r.queryCommandState("insertcode");if(n==-1){s.setDisabled(true)}else{s.setDisabled(false);var o=r.queryCommandValue("insertcode");if(!o){s.setValue(a);return}o&&(o=o.replace(/['"]/g,"").split(",")[0]);s.setValue(o)}}});return s};d.fontfamily=function(r,e,t){e=r.options["fontfamily"]||[];t=r.options.labelMap["fontfamily"]||r.getLang("labelMap.fontfamily")||"";if(!e.length)return;for(var i=0,n,o=[];n=e[i];i++){var a=r.getLang("fontfamily")[n.name]||"";(function(e,t){o.push({label:e,value:t,theme:r.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+l.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})})(n.label||a,n.val)}var s=new d.Combox({editor:r,items:o,onselect:function(e,t){r.execCommand("FontFamily",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:t,initValue:t,className:"edui-for-fontfamily",indexByValue:function(e){if(e){for(var t=0,i;i=this.items[t];t++){if(i.value.indexOf(e)!=-1)return t}}return-1}});d.buttons["fontfamily"]=s;r.addListener("selectionchange",function(e,t,i){if(!i){var n=r.queryCommandState("FontFamily");if(n==-1){s.setDisabled(true)}else{s.setDisabled(false);var o=r.queryCommandValue("FontFamily");o&&(o=o.replace(/['"]/g,"").split(",")[0]);s.setValue(o)}}});return s};d.fontsize=function(o,e,t){t=o.options.labelMap["fontsize"]||o.getLang("labelMap.fontsize")||"";e=e||o.options["fontsize"]||[];if(!e.length)return;var i=[];for(var n=0;n<e.length;n++){var r=e[n]+"px";i.push({label:r,value:r,theme:o.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var a=new d.Combox({editor:o,items:i,title:t,initValue:t,onselect:function(e,t){o.execCommand("FontSize",this.items[t].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});d.buttons["fontsize"]=a;o.addListener("selectionchange",function(e,t,i){if(!i){var n=o.queryCommandState("FontSize");if(n==-1){a.setDisabled(true)}else{a.setDisabled(false);a.setValue(o.queryCommandValue("FontSize"))}}});return a};d.paragraph=function(a,e,t){t=a.options.labelMap["paragraph"]||a.getLang("labelMap.paragraph")||"";e=a.options["paragraph"]||[];if(l.isEmptyObject(e))return;var i=[];for(var n in e){i.push({value:n,label:e[n]||a.getLang("paragraph")[n],theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}var s=new d.Combox({editor:a,items:i,title:t,initValue:t,className:"edui-for-paragraph",onselect:function(e,t){a.execCommand("Paragraph",this.items[t].value)},onbuttonclick:function(){this.showPopup()}});d.buttons["paragraph"]=s;a.addListener("selectionchange",function(e,t,i){if(!i){var n=a.queryCommandState("Paragraph");if(n==-1){s.setDisabled(true)}else{s.setDisabled(false);var o=a.queryCommandValue("Paragraph");var r=s.indexByValue(o);if(r!=-1){s.setValue(o)}else{s.setValue(s.initValue)}}}});return s};d.customstyle=function(a){var e=a.options["customstyle"]||[],t=a.options.labelMap["customstyle"]||a.getLang("labelMap.customstyle")||"";if(!e.length)return;var i=a.getLang("customstyle");for(var n=0,o=[],r;r=e[n++];){(function(e){var t={};t.label=e.label?e.label:i[e.name];t.style=e.style;t.className=e.className;t.tag=e.tag;o.push({label:t.label,value:t,theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label">'+"<"+t.tag+" "+(t.className?' class="'+t.className+'"':"")+(t.style?' style="'+t.style+'"':"")+">"+t.label+"</"+t.tag+">"+"</div>"}})})(r)}var s=new d.Combox({editor:a,items:o,title:t,initValue:t,className:"edui-for-customstyle",onselect:function(e,t){a.execCommand("customstyle",this.items[t].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(e){for(var t=0,i;i=this.items[t++];){if(i.label==e){return t-1}}return-1}});d.buttons["customstyle"]=s;a.addListener("selectionchange",function(e,t,i){if(!i){var n=a.queryCommandState("customstyle");if(n==-1){s.setDisabled(true)}else{s.setDisabled(false);var o=a.queryCommandValue("customstyle");var r=s.indexByValue(o);if(r!=-1){s.setValue(o)}else{s.setValue(s.initValue)}}}});return s};d.inserttable=function(n,e,t){t=n.options.labelMap["inserttable"]||n.getLang("labelMap.inserttable")||"";var i=new d.TableButton({editor:n,title:t,className:"edui-for-inserttable",onpicktable:function(e,t,i){n.execCommand("InsertTable",{numRows:i,numCols:t,border:1})},onbuttonclick:function(){this.showPopup()}});d.buttons["inserttable"]=i;n.addListener("selectionchange",function(){i.setDisabled(n.queryCommandState("inserttable")==-1)});return i};d.lineheight=function(i){var e=i.options.lineheight||[];if(!e.length)return;for(var t=0,n,o=[];n=e[t++];){o.push({label:n,value:n,theme:i.options.theme,onclick:function(){i.execCommand("lineheight",this.value)}})}var r=new d.MenuButton({editor:i,className:"edui-for-lineheight",title:i.options.labelMap["lineheight"]||i.getLang("labelMap.lineheight")||"",items:o,onbuttonclick:function(){var e=i.queryCommandValue("LineHeight")||this.value;i.execCommand("LineHeight",e)}});d.buttons["lineheight"]=r;i.addListener("selectionchange",function(){var e=i.queryCommandState("LineHeight");if(e==-1){r.setDisabled(true)}else{r.setDisabled(false);var t=i.queryCommandValue("LineHeight");t&&r.setValue((t+"").replace(/cm/,""));r.setChecked(e)}});return r};var c=["top","bottom"];for(var u=0,f;f=c[u++];){(function(a){d["rowspacing"+a]=function(i){var e=i.options["rowspacing"+a]||[];if(!e.length)return null;for(var t=0,n,o=[];n=e[t++];){o.push({label:n,value:n,theme:i.options.theme,onclick:function(){i.execCommand("rowspacing",this.value,a)}})}var r=new d.MenuButton({editor:i,className:"edui-for-rowspacing"+a,title:i.options.labelMap["rowspacing"+a]||i.getLang("labelMap.rowspacing"+a)||"",items:o,onbuttonclick:function(){var e=i.queryCommandValue("rowspacing",a)||this.value;i.execCommand("rowspacing",e,a)}});d.buttons[a]=r;i.addListener("selectionchange",function(){var e=i.queryCommandState("rowspacing",a);if(e==-1){r.setDisabled(true)}else{r.setDisabled(false);var t=i.queryCommandValue("rowspacing",a);t&&r.setValue((t+"").replace(/%/,""));r.setChecked(e)}});return r}})(f)}var m=["insertorderedlist","insertunorderedlist"];for(var h=0,p;p=m[h++];){(function(a){d[a]=function(i){var e=i.options[a],t=function(){i.execCommand(a,this.value)},n=[];for(var o in e){n.push({label:e[o]||i.getLang()[a][o]||"",value:o,theme:i.options.theme,onclick:t})}var r=new d.MenuButton({editor:i,className:"edui-for-"+a,title:i.getLang("labelMap."+a)||"",items:n,onbuttonclick:function(){var e=i.queryCommandValue(a)||this.value;i.execCommand(a,e)}});d.buttons[a]=r;i.addListener("selectionchange",function(){var e=i.queryCommandState(a);if(e==-1){r.setDisabled(true)}else{r.setDisabled(false);var t=i.queryCommandValue(a);r.setValue(t);r.setChecked(e)}});return r}})(p)}d.fullscreen=function(t,e){e=t.options.labelMap["fullscreen"]||t.getLang("labelMap.fullscreen")||"";var i=new d.Button({className:"edui-for-fullscreen",title:e,theme:t.options.theme,onclick:function(){if(t.ui){t.ui.setFullScreen(!t.ui.isFullScreen())}this.setChecked(t.ui.isFullScreen())}});d.buttons["fullscreen"]=i;t.addListener("selectionchange",function(){var e=t.queryCommandState("fullscreen");i.setDisabled(e==-1);i.setChecked(t.ui.isFullScreen())});return i};d["emotion"]=function(e,t){var i="emotion";var n=new d.MultiMenuPop({title:e.options.labelMap[i]||e.getLang("labelMap."+i+"")||"",editor:e,className:"edui-for-"+i,iframeUrl:e.ui.mapUrl(t||(e.options.iframeUrlMap||{})[i]||s[i])});d.buttons[i]=n;e.addListener("selectionchange",function(){n.setDisabled(e.queryCommandState(i)==-1)});return n};d.autotypeset=function(e){var t=new d.AutoTypeSetButton({editor:e,title:e.options.labelMap["autotypeset"]||e.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){e.execCommand("autotypeset")}});d.buttons["autotypeset"]=t;e.addListener("selectionchange",function(){t.setDisabled(e.queryCommandState("autotypeset")==-1)});return t};d["simpleupload"]=function(o){var r="simpleupload",a=new d.Button({className:"edui-for-"+r,title:o.options.labelMap[r]||o.getLang("labelMap."+r)||"",onclick:function(){},theme:o.options.theme,showText:false});d.buttons[r]=a;o.addListener("ready",function(){var e=a.getDom("body"),t=e.children[0];o.fireEvent("simpleuploadbtnready",t)});o.addListener("selectionchange",function(e,t,i){var n=o.queryCommandState(r);if(n==-1){a.setDisabled(true);a.setChecked(false)}else{if(!i){a.setDisabled(false);a.setChecked(n)}}});return a}})();(function(){var f=baidu.editor.utils,t=baidu.editor.ui.uiUtils,r=baidu.editor.ui.UIBase,w=baidu.editor.dom.domUtils;var a=[];function u(e){this.initOptions(e);this.initEditorUI()}u.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var c=this.editor,t=this;c.addListener("ready",function(){c.getDialog=function(e){return c.ui._dialogs[e+"Dialog"]};w.on(c.window,"scroll",function(e){baidu.editor.ui.Popup.postHide(e)});c.ui._actualFrameWidth=c.options.initialFrameWidth;UE.browser.ie&&UE.browser.version===6&&c.container.ownerDocument.execCommand("BackgroundImageCache",false,true);if(c.options.elementPathEnabled){c.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+c.getLang("elementPathTip")+":</div>"}if(c.options.wordCount){function e(){i(c,t);w.un(c.document,"click",arguments.callee)}w.on(c.document,"click",e);c.ui.getDom("wordcount").innerHTML=c.getLang("wordCountTip")}c.ui._scale();if(c.options.scaleEnabled){if(c.autoHeightEnabled){c.disableAutoHeight()}t.enableScale()}else{t.disableScale()}if(!c.options.elementPathEnabled&&!c.options.wordCount&&!c.options.scaleEnabled){c.ui.getDom("elementpath").style.display="none";c.ui.getDom("wordcount").style.display="none";c.ui.getDom("scale").style.display="none"}if(!c.selection.isFocus())return;c.fireEvent("selectionchange",false,true)});c.addListener("mousedown",function(e,t){var i=t.target||t.srcElement;baidu.editor.ui.Popup.postHide(t,i);baidu.editor.ui.ShortCutMenu.postHide(t)});c.addListener("delcells",function(){if(UE.ui["edittip"]){new UE.ui["edittip"](c)}c.getDialog("edittip").open()});var n,o=false,e;c.addListener("afterpaste",function(){if(c.queryCommandState("pasteplain"))return;if(baidu.editor.ui.PastePicker){n=new baidu.editor.ui.Popup({content:new baidu.editor.ui.PastePicker({editor:c}),editor:c,className:"edui-wordpastepop"});n.render()}o=true});c.addListener("afterinserthtml",function(){clearTimeout(e);e=setTimeout(function(){if(n&&(o||c.ui._isTransfer)){if(n.isHidden()){var e=w.createElement(c.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),t=c.selection.getRange();t.insertNode(e);var i=getDomNode(e,"firstChild","previousSibling");i&&n.showAnchor(i.nodeType==3?i.parentNode:i);w.remove(e)}else{n.show()}delete c.ui._isTransfer;o=false}},200)});c.addListener("contextmenu",function(e,t){baidu.editor.ui.Popup.postHide(t)});c.addListener("keydown",function(e,t){if(n)n.dispose(t);var i=t.keyCode||t.which;if(t.altKey&&i==90){UE.ui.buttons["fullscreen"].onclick()}});c.addListener("wordcount",function(e){i(this,t)});function i(e,t){e.setOpt({wordCount:true,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});var i=e.options,n=i.maximumWords,o=i.wordCountMsg,r=i.wordOverFlowMsg,a=t.getDom("wordcount");if(!i.wordCount){return}var s=e.getContentLength(true);if(s>n){a.innerHTML=r;e.fireEvent("wordcountoverflow")}else{a.innerHTML=o.replace("{#leave}",n-s).replace("{#count}",s)}}c.addListener("selectionchange",function(){if(c.options.elementPathEnabled){t[(c.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]()}if(c.options.scaleEnabled){t[(c.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()}});var u=new baidu.editor.ui.Popup({editor:c,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();c.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(e){this.hide();c.ui._dialogs[e]&&c.ui._dialogs[e].open()},_onImgSetFloat:function(e){this.hide();c.execCommand("imagefloat",e)},_setIframeAlign:function(e){var t=u.anchorEl;var i=t.cloneNode(true);switch(e){case-2:i.setAttribute("align","");break;case-1:i.setAttribute("align","left");break;case 1:i.setAttribute("align","right");break}t.parentNode.insertBefore(i,t);w.remove(t);u.anchorEl=i;u.showAnchor(u.anchorEl)},_updateIframe:function(){var e=c._iframe=u.anchorEl;if(w.hasClass(e,"ueditor_baidumap")){c.selection.getRange().selectNode(e).select();c.ui._dialogs.mapDialog.open();u.hide()}else{c.ui._dialogs.insertframeDialog.open();u.hide()}},_onRemoveButtonClick:function(e){c.execCommand(e);this.hide()},queryAutoHide:function(e){if(e&&e.ownerDocument==c.document){if(e.tagName.toLowerCase()=="img"||w.findParentByTagName(e,"a",true)){return e!==u.anchorEl}}return baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,e)}});u.render();if(c.options.imagePopup){c.addListener("mouseover",function(e,t){t=t||window.event;var i=t.target||t.srcElement;if(c.ui._dialogs.insertframeDialog&&/iframe/gi.test(i.tagName)){var n=u.formatHtml("<nobr>"+c.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+c.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+c.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+c.getLang("justifyright")+"</span>&nbsp;&nbsp;"+' <span onclick="$$._updateIframe( this);" class="edui-clickable">'+c.getLang("modify")+"</span></nobr>");if(n){u.getDom("content").innerHTML=n;u.anchorEl=i;u.showAnchor(u.anchorEl)}else{u.hide()}}});c.addListener("selectionchange",function(e,t){if(!t)return;var i="",n="",o=c.selection.getRange().getClosedNode(),r=c.ui._dialogs;if(o&&o.tagName=="IMG"){var a="insertimageDialog";if(o.className.indexOf("edui-faked-video")!=-1||o.className.indexOf("edui-upload-video")!=-1){a="insertvideoDialog"}if(o.className.indexOf("edui-faked-webapp")!=-1){a="webappDialog"}if(o.src.indexOf("https://api.map.baidu.com")!=-1){a="mapDialog"}if(o.className.indexOf("edui-faked-music")!=-1){a="musicDialog"}if(o.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1){a="gmapDialog"}if(o.getAttribute("anchorname")){a="anchorDialog";i=u.formatHtml("<nobr>"+c.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+c.getLang("modify")+"</span>&nbsp;&nbsp;"+"<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+c.getLang("delete")+"</span></nobr>")}if(o.getAttribute("word_img")){c.word_img=[o.getAttribute("word_img")];a="wordimageDialog"}if(w.hasClass(o,"loadingclass")||w.hasClass(o,"loaderrorclass")){a=""}if(!r[a]){return}n="<nobr>"+c.getLang("property")+": "+'<span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+c.getLang("default")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+c.getLang("justifyleft")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+c.getLang("justifyright")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+c.getLang("justifycenter")+"</span>&nbsp;&nbsp;"+"<span onclick=\"$$._onImgEditButtonClick('"+a+'\');" class="edui-clickable">'+c.getLang("modify")+"</span></nobr>";!i&&(i=u.formatHtml(n))}if(c.ui._dialogs.linkDialog){var s=c.queryCommandValue("link");var l;if(s&&(l=s.getAttribute("_href")||s.getAttribute("href",2))){var d=l;if(l.length>30){d=l.substring(0,20)+"..."}if(i){i+='<div style="height:5px;"></div>'}i+=u.formatHtml("<nobr>"+c.getLang("anthorMsg")+': <a target="_blank" href="'+l+'" title="'+l+'" >'+d+"</a>"+' <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+c.getLang("modify")+"</span>"+' <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+c.getLang("clear")+"</span></nobr>");u.showAnchor(s)}}if(i){u.getDom("content").innerHTML=i;u.anchorEl=o||s;u.showAnchor(u.anchorEl)}else{u.hide()}})}},_initToolbars:function(){var e=this.editor;var t=this.toolbars||[];var i=[];var n=[];for(var o=0;o<t.length;o++){var r=t[o];var a=new baidu.editor.ui.Toolbar({theme:e.options.theme});for(var s=0;s<r.length;s++){var l=r[s];var d=null;if(typeof l=="string"){l=l.toLowerCase();if(l=="|"){l="Separator"}if(l=="||"){l="Breakline"}var c=baidu.editor.ui[l];if(c){if(f.isFunction(c)){d=new baidu.editor.ui[l](e)}else{if(c.id&&c.id!=e.key){continue}var u=c.execFn.call(e,e,l);if(u){if(c.index===undefined){a.add(u);continue}else{n.push({index:c.index,itemUI:u})}}}}if(l=="fullscreen"){if(i&&i[0]){i[0].items.splice(0,0,d)}else{d&&a.items.splice(0,0,d)}continue}}else{d=l}if(d&&d.id){a.add(d)}}i[o]=a}f.each(n,function(e){a.add(e.itemUI,e.index)});this.toolbars=i},getHtmlTpl:function(){return'<div id="##" class="%%">'+'<div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;">'+'<div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+"</div>"+'<div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div>'+'<div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div>'+'<div style="height:0;overflow:hidden;clear:both;"></div>'+"</div>"+'<div id="##_message_holder" class="%%-messageholder"></div>'+"</div>"+'<div id="##_iframeholder" class="%%-iframeholder">'+"</div>"+'<div id="##_bottombar" class="%%-bottomContainer"><table><tr>'+'<td id="##_elementpath" class="%%-bottombar"></td>'+'<td id="##_wordcount" class="%%-wordcount"></td>'+'<td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td>'+"</tr></table></div>"+'<div id="##_scalelayer"></div>'+"</div>"},showWordImageDialog:function(){this._dialogs["wordimageDialog"].open()},renderToolbarBoxHtml:function(){var e=[];for(var t=0;t<this.toolbars.length;t++){e.push(this.toolbars[t].renderHtml())}return e.join("")},setFullScreen:function(e){var t=this.editor,i=t.container.parentNode.parentNode;if(this._fullscreen!=e){this._fullscreen=e;this.editor.fireEvent("beforefullscreenchange",e);if(baidu.editor.browser.gecko){var n=t.selection.getRange().createBookmark()}if(e){while(i.tagName!="BODY"){var o=baidu.editor.dom.domUtils.getComputedStyle(i,"position");a.push(o);i.style.position="static";i=i.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);this._bakEditorContaninerWidth=t.iframe.parentNode.offsetWidth;if(this._bakAutoHeight){t.autoHeightEnabled=false;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";window.scrollTo(0,window.scrollY);this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;t.iframe.parentNode.style.width="";this._updateFullScreen()}else{while(i.tagName!="BODY"){i.style.position=a.shift();i=i.parentNode}this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){t.autoHeightEnabled=true;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;t.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px";window.scrollTo(0,this._bakScrollTop)}if(browser.gecko&&t.body.contentEditable==="true"){var r=document.createElement("input");document.body.appendChild(r);t.body.contentEditable=false;setTimeout(function(){r.focus();setTimeout(function(){t.body.contentEditable=true;t.fireEvent("fullscreenchanged",e);t.selection.getRange().moveToBookmark(n).select(true);baidu.editor.dom.domUtils.remove(r);e&&window.scroll(0,0)},0)},0)}if(t.body.contentEditable==="true"){this.editor.fireEvent("fullscreenchanged",e);this.triggerLayout()}}},_updateFullScreen:function(){if(this._fullscreen){var e=t.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);t.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),true);if(browser.gecko){try{window.onresize()}catch(e){}}}},_updateElementPath:function(){var e=this.getDom("elementpath"),t;if(this.elementPathEnabled&&(t=this.editor.queryCommandValue("elementpath"))){var i=[];for(var n=0,o;o=t[n];n++){i[n]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+n+'&quot;);">'+o+"</span>")}e.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+i.join(" &gt; ")+"</div>"}else{e.style.display="none"}},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="";e.style.display="none";this.elementPathEnabled=false},enableElementPath:function(){var e=this.getDom("elementpath");e.style.display="";this.elementPathEnabled=true;this._updateElementPath()},_scale:function(){var i=document,e=this.editor,t=e.container,n=e.document,o=this.getDom("toolbarbox"),r=this.getDom("bottombar"),a=this.getDom("scale"),s=this.getDom("scalelayer");var l=false,d=null,c=0,u=e.options.minFrameWidth,f=0,m=0,h=0,p=0;function g(){d=w.getXY(t);if(!c){c=e.options.minFrameHeight+o.offsetHeight+r.offsetHeight}s.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+t.offsetWidth+"px;height:"+t.offsetHeight+"px;z-index:"+(e.options.zIndex+1);w.on(i,"mousemove",b);w.on(n,"mouseup",y);w.on(i,"mouseup",y)}var v=this;this.editor.addListener("fullscreenchanged",function(e,t){if(t){v.disableScale()}else{if(v.editor.options.scaleEnabled){v.enableScale();var i=v.editor.document.createElement("span");v.editor.body.appendChild(i);v.editor.body.style.height=Math.max(w.getXY(i).y,v.editor.iframe.offsetHeight-20)+"px";w.remove(i)}}});function b(e){C();var t=e||window.event;f=t.pageX||i.documentElement.scrollLeft+t.clientX;m=t.pageY||i.documentElement.scrollTop+t.clientY;h=f-d.x;p=m-d.y;if(h>=u){l=true;s.style.width=h+"px"}if(p>=c){l=true;s.style.height=p+"px"}}function y(){if(l){l=false;e.ui._actualFrameWidth=s.offsetWidth-2;t.style.width=e.ui._actualFrameWidth+"px";e.setHeight(s.offsetHeight-r.offsetHeight-o.offsetHeight-2,true)}if(s){s.style.display="none"}C();w.un(i,"mousemove",b);w.un(n,"mouseup",y);w.un(i,"mouseup",y)}function C(){if(browser.ie)i.selection.clear();else window.getSelection().removeAllRanges()}this.enableScale=function(){if(e.queryCommandState("source")==1)return;a.style.display="";this.scaleEnabled=true;w.on(a,"mousedown",g)};this.disableScale=function(){a.style.display="none";this.scaleEnabled=false;w.un(a,"mousedown",g)}},isFullScreen:function(){return this._fullscreen},postRender:function(){r.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++){this.toolbars[e].postRender()}var t=this;var i,n=baidu.editor.dom.domUtils,o=function(){clearTimeout(i);i=setTimeout(function(){t._updateFullScreen()})};n.on(window,"resize",o);t.addListener("destroy",function(){n.un(window,"resize",o);clearTimeout(i)})},showToolbarMsg:function(e,t){this.getDom("toolbarmsg_label").innerHTML=e;this.getDom("toolbarmsg").style.display="";if(!t){var i=this.getDom("upload_dialog");i.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();if(e.style.zoom=="1"){e.style.zoom="100%"}else{e.style.zoom="1"}}};f.inherits(u,baidu.editor.ui.UIBase);var n={};UE.ui.Editor=function(e){var d=new UE.Editor(e);d.options.editor=d;f.loadFile(document,{href:d.options.themePath+d.options.theme+"/css/neditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var c=d.render;d.render=function(l){if(l.constructor===String){d.key=l;n[l]=d}f.domReady(function(){d.langIsReady?e():d.addListener("langReady",e);function e(){d.setOpt({labelMap:d.options.labelMap||d.getLang("labelMap")});new u(d.options);if(l){if(l.constructor===String){l=document.getElementById(l)}l&&l.getAttribute("name")&&(d.options.textarea=l.getAttribute("name"));if(l&&/script|textarea/gi.test(l.tagName)){var e=document.createElement("div");l.parentNode.insertBefore(e,l);var t=l.value||l.innerHTML;d.options.initialContent=/^[\t\r\n ]*$/.test(t)?d.options.initialContent:t.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");l.className&&(e.className=l.className);l.style.cssText&&(e.style.cssText=l.style.cssText);if(/textarea/i.test(l.tagName)){d.textarea=l;d.textarea.style.display="none"}else{l.parentNode.removeChild(l)}if(l.id){e.id=l.id;w.removeAttributes(l,"id")}l=e;l.innerHTML=""}}w.addClass(l,"edui-"+d.options.theme);d.ui.render(l);var i=d.options;d.container=d.ui.getDom();var n=w.findParents(l,true);var o=[];for(var r=0,a;a=n[r];r++){o[r]=a.style.display;a.style.display="block"}if(i.initialFrameWidth){i.minFrameWidth=i.initialFrameWidth}else{i.minFrameWidth=i.initialFrameWidth=l.offsetWidth;var s=l.style.width;if(/%$/.test(s)){i.initialFrameWidth=s}}if(i.initialFrameHeight){i.minFrameHeight=i.initialFrameHeight}else{i.initialFrameHeight=i.minFrameHeight=l.offsetHeight}for(var r=0,a;a=n[r];r++){a.style.display=o[r]}if(l.style.height){l.style.height=""}d.container.style.width=i.initialFrameWidth+(/%$/.test(i.initialFrameWidth)?"":"px");d.container.style.zIndex=i.zIndex;c.call(d,d.ui.getDom("iframeholder"));d.fireEvent("afteruiready")}})};return d};UE.getEditor=function(e,t){var i=n[e];if(!i){i=n[e]=new UE.ui.Editor(t);i.render(e)}return i};UE.delEditor=function(e){var t;if(t=n[e]){t.key&&t.destroy();delete n[e]}};UE.registerUI=function(e,t,i,n){f.each(e.split(/\s+/),function(e){baidu.editor.ui[e]={id:n,execFn:t,index:i}})}})();UE.registerUI("message",function(e){var t=baidu.editor.ui;var o=t.Message;var r;var a=[];var s=e;s.setOpt("enableMessageShow",true);if(s.getOpt("enableMessageShow")===false){return}s.addListener("ready",function(){r=document.getElementById(s.ui.id+"_message_holder");l();setTimeout(function(){l()},500)});s.addListener("showmessage",function(e,t){t=utils.isString(t)?{content:t}:t;var i=new o({timeout:t.timeout,type:t.type,content:t.content,keepshow:t.keepshow,editor:s}),n=t.id||"msg_"+(+new Date).toString(36);i.render(r);a[n]=i;i.reset(t);l();return n});s.addListener("updatemessage",function(e,t,i){i=utils.isString(i)?{content:i}:i;var n=a[t];n.render(r);n&&n.reset(i)});s.addListener("hidemessage",function(e,t){var i=a[t];i&&i.hide()});function l(){if(!r||!s.ui)return;var e=s.ui.getDom("toolbarbox");if(e){r.style.top=e.offsetHeight+3+"px"}r.style.zIndex=Math.max(s.options.zIndex,s.iframe.style.zIndex)+1}});UE.registerUI("autosave",function(e){var t=null,i=null;e.on("afterautosave",function(){clearTimeout(t);t=setTimeout(function(){if(i){e.trigger("hidemessage",i)}i=e.trigger("showmessage",{content:e.getLang("autosave.success"),timeout:2e3})},2e3)})})});