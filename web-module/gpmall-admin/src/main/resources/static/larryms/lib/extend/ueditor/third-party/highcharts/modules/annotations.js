(function(m,t){function v(t){return typeof t==="number"}function w(t){return t!==i&&t!==null}var i,j,l,e=m.Chart,k=m.extend,n=m.each;l=["path","rect","circle"];j={top:0,left:0,center:.5,middle:.5,bottom:1,right:1};var O=t.inArray,s=m.merge,r=function(){this.init.apply(this,arguments)};r.prototype={init:function(t,i){var e=i.shape&&i.shape.type;this.chart=t;var n,a;a={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}};n={circle:{params:{x:0,y:0}}};if(n[e])a.shape=s(a.shape,n[e]);this.options=s({},a,i)},render:function(t){var i=this.chart,e=this.chart.renderer,n=this.group,a=this.title,s=this.shape,r=this.options,o=r.title,h=r.shape;if(!n)n=this.group=e.g();if(!s&&h&&O(h.type,l)!==-1)s=this.shape=e[r.shape.type](h.params),s.add(n);if(!a&&o)a=this.title=e.label(o),a.add(n);n.add(i.annotations.group);this.linkObjects();t!==!1&&this.redraw()},redraw:function(){var t=this.options,i=this.chart,e=this.group,n=this.title,a=this.shape,s=this.linkedObject,r=i.xAxis[t.xAxis],o=i.yAxis[t.yAxis],h=t.width,l=t.height,p=j[t.anchorY],c=j[t.anchorX],d,u,f,y;if(s)d=s instanceof m.Point?"point":s instanceof m.Series?"series":null,d==="point"?(t.xValue=s.x,t.yValue=s.y,u=s.series):d==="series"&&(u=s),e.visibility!==u.group.visibility&&e.attr({visibility:u.group.visibility});s=w(t.xValue)?r.toPixels(t.xValue+r.minPointOffset)-r.minPixelPadding:t.x;d=w(t.yValue)?o.toPixels(t.yValue):t.y;if(!isNaN(s)&&!isNaN(d)&&v(s)&&v(d)){n&&(n.attr(t.title),n.css(t.title.style));if(a){n=k({},t.shape.params);if(t.units==="values"){for(f in n)O(f,["width","x"])>-1?n[f]=r.translate(n[f]):O(f,["height","y"])>-1&&(n[f]=o.translate(n[f]));n.width&&(n.width-=r.toPixels(0)-r.left);n.x&&(n.x+=r.minPixelPadding);if(t.shape.type==="path"){f=n.d;u=s;for(var x=d,g=f.length,b=0;b<g;)typeof f[b]==="number"&&typeof f[b+1]==="number"?(f[b]=r.toPixels(f[b])-u,f[b+1]=o.toPixels(f[b+1])-x,b+=2):b+=1}}t.shape.type==="circle"&&(n.x+=n.r,n.y+=n.r);a.attr(n)}e.bBox=null;if(!v(h))y=e.getBBox(),h=y.width;if(!v(l))y||(y=e.getBBox()),l=y.height;if(!v(c))c=j.center;if(!v(p))p=j.center;s-=h*c;d-=l*p;i.animation&&w(e.translateX)&&w(e.translateY)?e.animate({translateX:s,translateY:d}):e.translate(s,d)}},destroy:function(){var i=this,t=this.chart.annotations.allItems,e=t.indexOf(i);e>-1&&t.splice(e,1);n(["title","shape","group"],function(t){i[t]&&(i[t].destroy(),i[t]=null)});i.group=i.title=i.shape=i.chart=i.options=null},update:function(t,i){k(this.options,t);this.linkObjects();this.render(i)},linkObjects:function(){var t=this.chart,i=this.linkedObject,e=i&&(i.id||i.options.id),n=this.options.linkedTo;if(w(n)){if(!w(i)||n!==e)this.linkedObject=t.get(n)}else this.linkedObject=null}};k(e.prototype,{annotations:{add:function(t,i){var e=this.allItems,n=this.chart,a,s;Object.prototype.toString.call(t)==="[object Array]"||(t=[t]);for(s=t.length;s--;)a=new r(n,t[s]),e.push(a),a.render(i)},redraw:function(){n(this.allItems,function(t){t.redraw()})}}});e.prototype.callbacks.push(function(t){var i=t.options.annotations,e;e=t.renderer.g("annotations");e.attr({zIndex:7});e.add();t.annotations.allItems=[];t.annotations.chart=t;t.annotations.group=e;Object.prototype.toString.call(i)==="[object Array]"&&i.length>0&&t.annotations.add(t.options.annotations);m.addEvent(t,"redraw",function(){t.annotations.redraw()})})})(Highcharts,HighchartsAdapter);