(function(t){"use strict";var e=t.getOptions(),n=e.plotOptions,l=t.seriesTypes,a=t.merge,T=function(){},Y=t.each;n.funnel=a(n.pie,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:true,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:false}}});l.funnel=t.extendClass(l.pie,{type:"funnel",animate:T,translate:function(){var t=function(t,e){return/%$/.test(t)?e*parseInt(t,10)/100:parseInt(t,10)},e=0,n=this,a=n.chart,i=a.plotWidth,o=a.plotHeight,r=0,s=n.options,l=s.center,h=t(l[0],i),c=t(l[0],o),p=t(s.width,i),d,f,u=t(s.height,o),g=t(s.neckWidth,i),b=t(s.neckHeight,o),w=u-b,y=n.data,C,L,k=s.dataLabels.position==="left"?1:0,W,v,A,H,P,X,m;n.getWidthAt=f=function(t){return t>u-b||u===b?g:g+(p-g)*((u-b-t)/(u-b))};n.getX=function(t,e){return h+(e?-1:1)*(f(t)/2+s.dataLabels.distance)};n.center=[h,c,u];n.centerX=h;Y(y,function(t){e+=t.y});Y(y,function(t){m=null;L=e?t.y/e:0;v=c-u/2+r*u;P=v+L*u;d=f(v);W=h-d/2;A=W+d;d=f(P);H=h-d/2;X=H+d;if(v>w){W=H=h-g/2;A=X=h+g/2}else if(P>w){m=P;d=f(w);H=h-d/2;X=H+d;P=w}C=["M",W,v,"L",A,v,X,P];if(m){C.push(X,m,H,m)}C.push(H,P,"Z");t.shapeType="path";t.shapeArgs={d:C};t.percentage=L*100;t.plotX=h;t.plotY=(v+(m||P))/2;t.tooltipPos=[h,t.plotY];t.slice=T;t.half=k;r+=L});n.setTooltipPoints()},drawPoints:function(){var a=this,i=a.options,t=a.chart,o=t.renderer;Y(a.data,function(t){var e=t.graphic,n=t.shapeArgs;if(!e){t.graphic=o.path(n).attr({fill:t.color,stroke:i.borderColor,"stroke-width":i.borderWidth}).add(a.group)}else{e.animate(n)}})},sortByAngle:T,drawDataLabels:function(){var t=this.data,e=this.options.dataLabels.distance,n,a,i,o=t.length,r,s;this.center[2]-=2*e;while(o--){i=t[o];n=i.half;a=n?1:-1;s=i.plotY;r=this.getX(s,n);i.labelPos=[0,s,r+(e-5)*a,s,r+e*a,s,n?"right":"left",0]}l.pie.prototype.drawDataLabels.call(this)}})})(Highcharts);