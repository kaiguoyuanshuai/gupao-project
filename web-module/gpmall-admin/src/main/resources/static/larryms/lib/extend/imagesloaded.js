(function(t,i){"use strict";if(t.layui&&layui.define){layui.define("EvEmitter",function(e){e("imagesloaded",i(t,layui.EvEmitter))})}else if(typeof define=="function"&&define.amd){define(["ev-emitter/ev-emitter"],function(e){return i(t,e)})}else if(typeof module=="object"&&module.exports){module.exports=i(t,require("ev-emitter"))}else{t.imagesLoaded=i(t,t.EvEmitter)}})(typeof window!=="undefined"?window:this,function e(t,i){"use strict";var n=t.jQuery;var o=t.console;function s(e,t){for(var i in t){e[i]=t[i]}return e}var r=Array.prototype.slice;function a(e){if(Array.isArray(e)){return e}var t=typeof e=="object"&&typeof e.length=="number";if(t){return r.call(e)}return[e]}function h(e,t,i){if(!(this instanceof h)){return new h(e,t,i)}var r=e;if(typeof e=="string"){r=document.querySelectorAll(e)}if(!r){o.error("Bad element for imagesLoaded "+(r||e));return}this.elements=a(r);this.options=s({},this.options);if(typeof t=="function"){i=t}else{s(this.options,t)}if(i){this.on("always",i)}this.getImages();if(n){this.jqDeferred=new n.Deferred}setTimeout(this.check.bind(this))}h.prototype=Object.create(i.prototype);h.prototype.options={};h.prototype.getImages=function(){this.images=[];this.elements.forEach(this.addElementImages,this)};h.prototype.addElementImages=function(e){if(e.nodeName=="IMG"){this.addImage(e)}if(this.options.background===true){this.addElementBackgroundImages(e)}var t=e.nodeType;if(!t||!u[t]){return}var i=e.querySelectorAll("img");for(var r=0;r<i.length;r++){var n=i[r];this.addImage(n)}if(typeof this.options.background=="string"){var o=e.querySelectorAll(this.options.background);for(r=0;r<o.length;r++){var s=o[r];this.addElementBackgroundImages(s)}}};var u={1:true,9:true,11:true};h.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(!t){return}var i=/url\((['"])?(.*?)\1\)/gi;var r=i.exec(t.backgroundImage);while(r!==null){var n=r&&r[2];if(n){this.addBackground(n,e)}r=i.exec(t.backgroundImage)}};h.prototype.addImage=function(e){var t=new d(e);this.images.push(t)};h.prototype.addBackground=function(e,t){var i=new m(e,t);this.images.push(i)};h.prototype.check=function(){var r=this;this.progressedCount=0;this.hasAnyBroken=false;if(!this.images.length){this.complete();return}function t(e,t,i){setTimeout(function(){r.progress(e,t,i)})}this.images.forEach(function(e){e.once("progress",t);e.check()})};h.prototype.progress=function(e,t,i){this.progressedCount++;this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;this.emitEvent("progress",[this,e,t]);if(this.jqDeferred&&this.jqDeferred.notify){this.jqDeferred.notify(this,e)}if(this.progressedCount==this.images.length){this.complete()}if(this.options.debug&&o){o.log("progress: "+i,e,t)}};h.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=true;this.emitEvent(e,[this]);this.emitEvent("always",[this]);if(this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}};function d(e){this.img=e}d.prototype=Object.create(i.prototype);d.prototype.check=function(){var e=this.getIsImageComplete();if(e){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}this.proxyImage=new Image;this.proxyImage.addEventListener("load",this);this.proxyImage.addEventListener("error",this);this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.proxyImage.src=this.img.src};d.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth};d.prototype.confirm=function(e,t){this.isLoaded=e;this.emitEvent("progress",[this,this.img,t])};d.prototype.handleEvent=function(e){var t="on"+e.type;if(this[t]){this[t](e)}};d.prototype.onload=function(){this.confirm(true,"onload");this.unbindEvents()};d.prototype.onerror=function(){this.confirm(false,"onerror");this.unbindEvents()};d.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this);this.proxyImage.removeEventListener("error",this);this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)};function m(e,t){this.url=e;this.element=t;this.img=new Image}m.prototype=Object.create(d.prototype);m.prototype.check=function(){this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.img.src=this.url;var e=this.getIsImageComplete();if(e){this.confirm(this.img.naturalWidth!==0,"naturalWidth");this.unbindEvents()}};m.prototype.unbindEvents=function(){this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)};m.prototype.confirm=function(e,t){this.isLoaded=e;this.emitEvent("progress",[this,this.element,t])};h.makeJQueryPlugin=function(e){e=e||t.jQuery;if(!e){return}n=e;n.fn.imagesLoaded=function(e,t){var i=new h(this,e,t);return i.jqDeferred.promise(n(this))}};h.makeJQueryPlugin();if(!t.larrymsExtend){return false}return h});