(function(i){"use strict";if(window.layui&&layui.define){layui.define(["jquery","ztree"],function(e){var t=layui.$,r=layui.ztree;e("ztreeCheck",i(t))})}else{i(jQuery)}})(function(e){if(!window.larrymsExtend){return false}var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},r={check:{enable:false,autoCheckTrigger:false,chkStyle:t.checkbox.STYLE,nocheckInherit:false,chkDisabledInherit:false,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},i=function(e){var t=T.getRoot(e);t.radioCheckedList=[]},a=function(e){},c=function(a){var e=a.treeObj,t=p.event;e.bind(t.CHECK,function(e,t,r,i){e.srcEvent=t;b.apply(a.callback.onCheck,[e,r,i])})},n=function(e){var t=e.treeObj,r=p.event;t.unbind(r.CHECK)},h=function(e){var t=e.target,r=T.getSetting(e.data.treeId),i="",a=null,c="",n="",h=null,s=null;if(b.eqs(e.type,"mouseover")){if(r.check.enable&&b.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+p.id.CHECK)!==null){i=b.getNodeMainDom(t).id;c="mouseoverCheck"}}else if(b.eqs(e.type,"mouseout")){if(r.check.enable&&b.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+p.id.CHECK)!==null){i=b.getNodeMainDom(t).id;c="mouseoutCheck"}}else if(b.eqs(e.type,"click")){if(r.check.enable&&b.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+p.id.CHECK)!==null){i=b.getNodeMainDom(t).id;c="checkNode"}}if(i.length>0){a=T.getNodeCache(r,i);switch(c){case"checkNode":h=C.onCheckNode;break;case"mouseoverCheck":h=C.onMouseoverCheck;break;case"mouseoutCheck":h=C.onMouseoutCheck;break}}var d={stop:c==="checkNode",node:a,nodeEventType:c,nodeEventCallback:h,treeEventType:n,treeEventCallback:s};return d},s=function(e,t,r,i,a,c,n){if(!r)return;var h=T.nodeChecked(e,r);h=T.nodeChecked(e,r,h);r.checkedOld=h;if(typeof r.nocheck=="string")r.nocheck=b.eqs(r.nocheck,"true");r.nocheck=!!r.nocheck||e.check.nocheckInherit&&i&&!!i.nocheck;if(typeof r.chkDisabled=="string")r.chkDisabled=b.eqs(r.chkDisabled,"true");r.chkDisabled=!!r.chkDisabled||e.check.chkDisabledInherit&&i&&!!i.chkDisabled;if(typeof r.halfCheck=="string")r.halfCheck=b.eqs(r.halfCheck,"true");r.halfCheck=!!r.halfCheck;r.check_Child_State=-1;r.check_Focus=false;r.getCheckStatus=function(){return T.getCheckStatus(e,r)};if(e.check.chkStyle==p.radio.STYLE&&e.check.radioType==p.radio.TYPE_ALL&&h){var s=T.getRoot(e);s.radioCheckedList.push(r)}},d=function(e,t,r){if(e.check.enable){T.makeChkFlag(e,t);r.push("<span ID='",t.tId,p.id.CHECK,"' class='",S.makeChkClass(e,t),"' treeNode",p.id.CHECK,t.nocheck===true?" style='display:none;'":"","></span>")}},o=function(n,a){a.checkNode=function(e,t,r,i){var a=T.nodeChecked(n,e);if(e.chkDisabled===true)return;if(t!==true&&t!==false){t=!a}i=!!i;if(a===t&&!r){return}else if(i&&b.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],true)==false){return}if(b.uCanDo(this.setting)&&this.setting.check.enable&&e.nocheck!==true){T.nodeChecked(n,e,t);var c=N(e,p.id.CHECK,this.setting);if(r||this.setting.check.chkStyle===p.radio.STYLE)S.checkNodeRelation(this.setting,e);S.setChkClass(this.setting,c,e);S.repairParentChkClassWithSelf(this.setting,e);if(i){this.setting.treeObj.trigger(p.event.CHECK,[null,this.setting.treeId,e])}}};a.checkAllNodes=function(e){S.repairAllChk(this.setting,!!e)};a.getCheckedNodes=function(e){var e=e!==false;var t=T.nodeChildren(n,T.getRoot(this.setting));return T.getTreeCheckedNodes(this.setting,t,e)};a.getChangeCheckedNodes=function(){var e=T.nodeChildren(n,T.getRoot(this.setting));return T.getTreeChangeCheckedNodes(this.setting,e)};a.setChkDisabled=function(e,t,r,i){t=!!t;r=!!r;i=!!i;S.repairSonChkDisabled(this.setting,e,t,i);S.repairParentChkDisabled(this.setting,e.getParentNode(),t,r)};var c=a.updateNode;a.updateNode=function(e,t){if(c)c.apply(a,arguments);if(!e||!this.setting.check.enable)return;var r=N(e,this.setting);if(r.get(0)&&b.uCanDo(this.setting)){var i=N(e,p.id.CHECK,this.setting);if(t==true||this.setting.check.chkStyle===p.radio.STYLE)S.checkNodeRelation(this.setting,e);S.setChkClass(this.setting,i,e);S.repairParentChkClassWithSelf(this.setting,e)}}},k={getRadioCheckedList:function(e){var t=T.getRoot(e).radioCheckedList;for(var r=0,i=t.length;r<i;r++){if(!T.getNodeCache(e,t[r].tId)){t.splice(r,1);r--;i--}}return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var r=T.nodeChecked(e,t),i={checked:r,half:t.halfCheck?t.halfCheck:e.check.chkStyle==p.radio.STYLE?t.check_Child_State===2:r?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0};return i},getTreeCheckedNodes:function(e,t,r,i){if(!t)return[];var a=r&&e.check.chkStyle==p.radio.STYLE&&e.check.radioType==p.radio.TYPE_ALL;i=!i?[]:i;for(var c=0,n=t.length;c<n;c++){var h=t[c];var s=T.nodeChildren(e,h);var d=T.nodeChecked(e,h);if(h.nocheck!==true&&h.chkDisabled!==true&&d==r){i.push(h);if(a){break}}T.getTreeCheckedNodes(e,s,r,i);if(a&&i.length>0){break}}return i},getTreeChangeCheckedNodes:function(e,t,r){if(!t)return[];r=!r?[]:r;for(var i=0,a=t.length;i<a;i++){var c=t[i];var n=T.nodeChildren(e,c);var h=T.nodeChecked(e,c);if(c.nocheck!==true&&c.chkDisabled!==true&&h!=c.checkedOld){r.push(c)}T.getTreeChangeCheckedNodes(e,n,r)}return r},makeChkFlag:function(e,t){if(!t)return;var r=-1;var i=T.nodeChildren(e,t);if(i){for(var a=0,c=i.length;a<c;a++){var n=i[a];var h=T.nodeChecked(e,n);var s=-1;if(e.check.chkStyle==p.radio.STYLE){if(n.nocheck===true||n.chkDisabled===true){s=n.check_Child_State}else if(n.halfCheck===true){s=2}else if(h){s=2}else{s=n.check_Child_State>0?2:0}if(s==2){r=2;break}else if(s==0){r=0}}else if(e.check.chkStyle==p.checkbox.STYLE){if(n.nocheck===true||n.chkDisabled===true){s=n.check_Child_State}else if(n.halfCheck===true){s=1}else if(h){s=n.check_Child_State===-1||n.check_Child_State===2?2:1}else{s=n.check_Child_State>0?1:0}if(s===1){r=1;break}else if(s===2&&r>-1&&a>0&&s!==r){r=1;break}else if(r===2&&s>-1&&s<2){r=1;break}else if(s>-1){r=s}}}}t.check_Child_State=r}},l={},C={onCheckNode:function(e,t){if(t.chkDisabled===true)return false;var r=T.getSetting(e.data.treeId);if(b.apply(r.callback.beforeCheck,[r.treeId,t],true)==false)return true;var i=T.nodeChecked(r,t);T.nodeChecked(r,t,!i);S.checkNodeRelation(r,t);var a=N(t,p.id.CHECK,r);S.setChkClass(r,a,t);S.repairParentChkClassWithSelf(r,t);r.treeObj.trigger(p.event.CHECK,[e,r.treeId,t]);return true},onMouseoverCheck:function(e,t){if(t.chkDisabled===true)return false;var r=T.getSetting(e.data.treeId),i=N(t,p.id.CHECK,r);t.check_Focus=true;S.setChkClass(r,i,t);return true},onMouseoutCheck:function(e,t){if(t.chkDisabled===true)return false;var r=T.getSetting(e.data.treeId),i=N(t,p.id.CHECK,r);t.check_Focus=false;S.setChkClass(r,i,t);return true}},f={},u={checkNodeRelation:function(e,t){var r,i,a,c=p.radio;var n=T.nodeChecked(e,t);if(e.check.chkStyle==c.STYLE){var h=T.getRadioCheckedList(e);if(n){if(e.check.radioType==c.TYPE_ALL){for(i=h.length-1;i>=0;i--){r=h[i];var s=T.nodeChecked(e,r);if(s&&r!=t){T.nodeChecked(e,r,false);h.splice(i,1);S.setChkClass(e,N(r,p.id.CHECK,e),r);if(r.parentTId!=t.parentTId){S.repairParentChkClassWithSelf(e,r)}}}h.push(t)}else{var d=t.parentTId?t.getParentNode():T.getRoot(e);var o=T.nodeChildren(e,d);for(i=0,a=o.length;i<a;i++){r=o[i];var s=T.nodeChecked(e,r);if(s&&r!=t){T.nodeChecked(e,r,false);S.setChkClass(e,N(r,p.id.CHECK,e),r)}}}}else if(e.check.radioType==c.TYPE_ALL){for(i=0,a=h.length;i<a;i++){if(t==h[i]){h.splice(i,1);break}}}}else{var o=T.nodeChildren(e,t);if(n&&(!o||o.length==0||e.check.chkboxType.Y.indexOf("s")>-1)){S.setSonNodeCheckBox(e,t,true)}if(!n&&(!o||o.length==0||e.check.chkboxType.N.indexOf("s")>-1)){S.setSonNodeCheckBox(e,t,false)}if(n&&e.check.chkboxType.Y.indexOf("p")>-1){S.setParentNodeCheckBox(e,t,true)}if(!n&&e.check.chkboxType.N.indexOf("p")>-1){S.setParentNodeCheckBox(e,t,false)}}},makeChkClass:function(e,t){var r=p.checkbox,i=p.radio,a="";var c=T.nodeChecked(e,t);if(t.chkDisabled===true){a=r.DISABLED}else if(t.halfCheck){a=r.PART}else if(e.check.chkStyle==i.STYLE){a=t.check_Child_State<1?r.FULL:r.PART}else{a=c?t.check_Child_State===2||t.check_Child_State===-1?r.FULL:r.PART:t.check_Child_State<1?r.FULL:r.PART}var n=e.check.chkStyle+"_"+(c?r.TRUE:r.FALSE)+"_"+a;n=t.check_Focus&&t.chkDisabled!==true?n+"_"+r.FOCUS:n;return p.className.BUTTON+" "+r.DEFAULT+" "+n},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===p.checkbox.STYLE){var r=T.getRoot(e);var i=T.nodeChildren(e,r);for(var a=0,c=i.length;a<c;a++){var n=i[a];if(n.nocheck!==true&&n.chkDisabled!==true){T.nodeChecked(e,n,t)}S.setSonNodeCheckBox(e,n,t)}}},repairChkClass:function(e,t){if(!t)return;T.makeChkFlag(e,t);if(t.nocheck!==true){var r=N(t,p.id.CHECK,e);S.setChkClass(e,r,t)}},repairParentChkClass:function(e,t){if(!t||!t.parentTId)return;var r=t.getParentNode();S.repairChkClass(e,r);S.repairParentChkClass(e,r)},repairParentChkClassWithSelf:function(e,t){if(!t)return;var r=T.nodeChildren(e,t);if(r&&r.length>0){S.repairParentChkClass(e,r[0])}else{S.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,r,i){if(!t)return;if(t.chkDisabled!=r){t.chkDisabled=r}S.repairChkClass(e,t);var a=T.nodeChildren(e,t);if(a&&i){for(var c=0,n=a.length;c<n;c++){var h=a[c];S.repairSonChkDisabled(e,h,r,i)}}},repairParentChkDisabled:function(e,t,r,i){if(!t)return;if(t.chkDisabled!=r&&i){t.chkDisabled=r}S.repairChkClass(e,t);S.repairParentChkDisabled(e,t.getParentNode(),r,i)},setChkClass:function(e,t,r){if(!t)return;if(r.nocheck===true){t.hide()}else{t.show()}t.attr("class",S.makeChkClass(e,r))},setParentNodeCheckBox:function(e,t,r,i){var a=N(t,p.id.CHECK,e);if(!i)i=t;T.makeChkFlag(e,t);if(t.nocheck!==true&&t.chkDisabled!==true){T.nodeChecked(e,t,r);S.setChkClass(e,a,t);if(e.check.autoCheckTrigger&&t!=i){e.treeObj.trigger(p.event.CHECK,[null,e.treeId,t])}}if(t.parentTId){var c=true;if(!r){var n=T.nodeChildren(e,t.getParentNode());for(var h=0,s=n.length;h<s;h++){var d=n[h];var o=T.nodeChecked(e,d);if(d.nocheck!==true&&d.chkDisabled!==true&&o||(d.nocheck===true||d.chkDisabled===true)&&d.check_Child_State>0){c=false;break}}}if(c){S.setParentNodeCheckBox(e,t.getParentNode(),r,i)}}},setSonNodeCheckBox:function(e,t,r,i){if(!t)return;var a=N(t,p.id.CHECK,e);if(!i)i=t;var c=false;var n=T.nodeChildren(e,t);if(n){for(var h=0,s=n.length;h<s;h++){var d=n[h];S.setSonNodeCheckBox(e,d,r,i);if(d.chkDisabled===true)c=true}}if(t!=T.getRoot(e)&&t.chkDisabled!==true){if(c&&t.nocheck!==true){T.makeChkFlag(e,t)}if(t.nocheck!==true&&t.chkDisabled!==true){T.nodeChecked(e,t,r);if(!c)t.check_Child_State=n&&n.length>0?r?2:0:-1}else{t.check_Child_State=-1}S.setChkClass(e,a,t);if(e.check.autoCheckTrigger&&t!=i&&t.nocheck!==true&&t.chkDisabled!==true){e.treeObj.trigger(p.event.CHECK,[null,e.treeId,t])}}}},g={tools:f,view:u,event:l,data:k};e.extend(true,e.fn.zTree.consts,t);e.extend(true,e.fn.zTree._z,g);var v=e.fn.zTree,b=v._z.tools,p=v.consts,S=v._z.view,T=v._z.data,E=v._z.event,N=b.$;T.nodeChecked=function(e,t,r){if(!t){return false}var i=e.data.key.checked;if(typeof r!=="undefined"){if(typeof r==="string"){r=b.eqs(r,"true")}r=!!r;t[i]=r}return t[i]};T.exSetting(r);T.addInitBind(c);T.addInitUnBind(n);T.addInitCache(a);T.addInitNode(s);T.addInitProxy(h,true);T.addInitRoot(i);T.addBeforeA(d);T.addZTreeTools(o);var _=S.createNodes;S.createNodes=function(e,t,r,i,a){if(_)_.apply(S,arguments);if(!r)return;S.repairParentChkClassWithSelf(e,i)};var y=S.removeNode;S.removeNode=function(e,t){var r=t.getParentNode();if(y)y.apply(S,arguments);if(!t||!r)return;S.repairChkClass(e,r);S.repairParentChkClass(e,r)};var D=S.appendNodes;S.appendNodes=function(e,t,r,i,a,c,n){var h="";if(D){h=D.apply(S,arguments)}if(i){T.makeChkFlag(e,i)}return h}});